import{a as Yt}from"./chunk-D2MA54BH.js";import{c as kt}from"./chunk-JLMBGAO7.js";import{d as pt}from"./chunk-UXQIAC4B.js";import{i as $t,k as Se,o as mt,q as st}from"./chunk-OBTIJDM2.js";import{D as dt,H as Gt,I as U,J as Ft,K as qt,M as be,N as we,Z as K,aa as Xt,h as v,ia as J,j as Z,v as xe}from"./chunk-E5USLX4Q.js";import{a as et,b as it,h as R}from"./chunk-3XFQOAE3.js";function Vt(l,t,r){if(l&&l.length){let[s,e]=t,i=Math.PI/180*r,h=Math.cos(i),a=Math.sin(i);for(let o of l){let[n,c]=o;o[0]=(n-s)*h-(c-e)*a+s,o[1]=(n-s)*a+(c-e)*h+e}}}function ta(l,t){return l[0]===t[0]&&l[1]===t[1]}function ea(l,t,r,s=1){let e=r,i=Math.max(t,.1),h=l[0]&&l[0][0]&&typeof l[0][0]=="number"?[l]:l,a=[0,0];if(e)for(let n of h)Vt(n,a,e);let o=function(n,c,p){let f=[];for(let x of n){let b=[...x];ta(b[0],b[b.length-1])||b.push([b[0][0],b[0][1]]),b.length>2&&f.push(b)}let g=[];c=Math.max(c,.1);let u=[];for(let x of f)for(let b=0;b<x.length-1;b++){let w=x[b],k=x[b+1];if(w[1]!==k[1]){let S=Math.min(w[1],k[1]);u.push({ymin:S,ymax:Math.max(w[1],k[1]),x:S===w[1]?w[0]:k[0],islope:(k[0]-w[0])/(k[1]-w[1])})}}if(u.sort((x,b)=>x.ymin<b.ymin?-1:x.ymin>b.ymin?1:x.x<b.x?-1:x.x>b.x?1:x.ymax===b.ymax?0:(x.ymax-b.ymax)/Math.abs(x.ymax-b.ymax)),!u.length)return g;let y=[],m=u[0].ymin,d=0;for(;y.length||u.length;){if(u.length){let x=-1;for(let b=0;b<u.length&&!(u[b].ymin>m);b++)x=b;u.splice(0,x+1).forEach(b=>{y.push({s:m,edge:b})})}if(y=y.filter(x=>!(x.edge.ymax<=m)),y.sort((x,b)=>x.edge.x===b.edge.x?0:(x.edge.x-b.edge.x)/Math.abs(x.edge.x-b.edge.x)),(p!==1||d%c==0)&&y.length>1)for(let x=0;x<y.length;x+=2){let b=x+1;if(b>=y.length)break;let w=y[x].edge,k=y[b].edge;g.push([[Math.round(w.x),m],[Math.round(k.x),m]])}m+=p,y.forEach(x=>{x.edge.x=x.edge.x+p*x.edge.islope}),d++}return g}(h,i,s);if(e){for(let n of h)Vt(n,a,-e);(function(n,c,p){let f=[];n.forEach(g=>f.push(...g)),Vt(f,c,p)})(o,a,-e)}return o}function Ct(l,t){var r;let s=t.hachureAngle+90,e=t.hachureGap;e<0&&(e=4*t.strokeWidth),e=Math.round(Math.max(e,.1));let i=1;return t.roughness>=1&&(((r=t.randomizer)===null||r===void 0?void 0:r.next())||Math.random())>.7&&(i=e),ea(l,e,s,i||1)}var Bt=class{constructor(t){this.helper=t}fillPolygons(t,r){return this._fillPolygons(t,r)}_fillPolygons(t,r){let s=Ct(t,r);return{type:"fillSketch",ops:this.renderLines(s,r)}}renderLines(t,r){let s=[];for(let e of t)s.push(...this.helper.doubleLineOps(e[0][0],e[0][1],e[1][0],e[1][1],r));return s}};function _t(l){let t=l[0],r=l[1];return Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2))}var Ut=class extends Bt{fillPolygons(t,r){let s=r.hachureGap;s<0&&(s=4*r.strokeWidth),s=Math.max(s,.1);let e=Ct(t,Object.assign({},r,{hachureGap:s})),i=Math.PI/180*r.hachureAngle,h=[],a=.5*s*Math.cos(i),o=.5*s*Math.sin(i);for(let[n,c]of e)_t([n,c])&&h.push([[n[0]-a,n[1]+o],[...c]],[[n[0]+a,n[1]-o],[...c]]);return{type:"fillSketch",ops:this.renderLines(h,r)}}},te=class extends Bt{fillPolygons(t,r){let s=this._fillPolygons(t,r),e=Object.assign({},r,{hachureAngle:r.hachureAngle+90}),i=this._fillPolygons(t,e);return s.ops=s.ops.concat(i.ops),s}},ee=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=Ct(t,r=Object.assign({},r,{hachureAngle:0}));return this.dotsOnLines(s,r)}dotsOnLines(t,r){let s=[],e=r.hachureGap;e<0&&(e=4*r.strokeWidth),e=Math.max(e,.1);let i=r.fillWeight;i<0&&(i=r.strokeWidth/2);let h=e/4;for(let a of t){let o=_t(a),n=o/e,c=Math.ceil(n)-1,p=o-c*e,f=(a[0][0]+a[1][0])/2-e/4,g=Math.min(a[0][1],a[1][1]);for(let u=0;u<c;u++){let y=g+p+u*e,m=f-h+2*Math.random()*h,d=y-h+2*Math.random()*h,x=this.helper.ellipse(m,d,i,i,r);s.push(...x.ops)}}return{type:"fillSketch",ops:s}}},se=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=Ct(t,r);return{type:"fillSketch",ops:this.dashedLine(s,r)}}dashedLine(t,r){let s=r.dashOffset<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashOffset,e=r.dashGap<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashGap,i=[];return t.forEach(h=>{let a=_t(h),o=Math.floor(a/(s+e)),n=(a+e-o*(s+e))/2,c=h[0],p=h[1];c[0]>p[0]&&(c=h[1],p=h[0]);let f=Math.atan((p[1]-c[1])/(p[0]-c[0]));for(let g=0;g<o;g++){let u=g*(s+e),y=u+s,m=[c[0]+u*Math.cos(f)+n*Math.cos(f),c[1]+u*Math.sin(f)+n*Math.sin(f)],d=[c[0]+y*Math.cos(f)+n*Math.cos(f),c[1]+y*Math.sin(f)+n*Math.sin(f)];i.push(...this.helper.doubleLineOps(m[0],m[1],d[0],d[1],r))}}),i}},ae=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=r.hachureGap<0?4*r.strokeWidth:r.hachureGap,e=r.zigzagOffset<0?s:r.zigzagOffset,i=Ct(t,r=Object.assign({},r,{hachureGap:s+e}));return{type:"fillSketch",ops:this.zigzagLines(i,e,r)}}zigzagLines(t,r,s){let e=[];return t.forEach(i=>{let h=_t(i),a=Math.round(h/(2*r)),o=i[0],n=i[1];o[0]>n[0]&&(o=i[1],n=i[0]);let c=Math.atan((n[1]-o[1])/(n[0]-o[0]));for(let p=0;p<a;p++){let f=2*p*r,g=2*(p+1)*r,u=Math.sqrt(2*Math.pow(r,2)),y=[o[0]+f*Math.cos(c),o[1]+f*Math.sin(c)],m=[o[0]+g*Math.cos(c),o[1]+g*Math.sin(c)],d=[y[0]+u*Math.cos(c+Math.PI/4),y[1]+u*Math.sin(c+Math.PI/4)];e.push(...this.helper.doubleLineOps(y[0],y[1],d[0],d[1],s),...this.helper.doubleLineOps(d[0],d[1],m[0],m[1],s))}}),e}},at={},re=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},sa=0,Zt=1,ve=2,Nt={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Qt(l,t){return l.type===t}function he(l){let t=[],r=function(h){let a=new Array;for(;h!=="";)if(h.match(/^([ \t\r\n,]+)/))h=h.substr(RegExp.$1.length);else if(h.match(/^([aAcChHlLmMqQsStTvVzZ])/))a[a.length]={type:sa,text:RegExp.$1},h=h.substr(RegExp.$1.length);else{if(!h.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];a[a.length]={type:Zt,text:`${parseFloat(RegExp.$1)}`},h=h.substr(RegExp.$1.length)}return a[a.length]={type:ve,text:""},a}(l),s="BOD",e=0,i=r[e];for(;!Qt(i,ve);){let h=0,a=[];if(s==="BOD"){if(i.text!=="M"&&i.text!=="m")return he("M0,0"+l);e++,h=Nt[i.text],s=i.text}else Qt(i,Zt)?h=Nt[s]:(e++,h=Nt[i.text],s=i.text);if(!(e+h<r.length))throw new Error("Path data ended short");for(let o=e;o<e+h;o++){let n=r[o];if(!Qt(n,Zt))throw new Error("Param not a number: "+s+","+n.text);a[a.length]=+n.text}if(typeof Nt[s]!="number")throw new Error("Bad segment: "+s);{let o={key:s,data:a};t.push(o),e+=h,i=r[e],s==="M"&&(s="L"),s==="m"&&(s="l")}}return t}function Le(l){let t=0,r=0,s=0,e=0,i=[];for(let{key:h,data:a}of l)switch(h){case"M":i.push({key:"M",data:[...a]}),[t,r]=a,[s,e]=a;break;case"m":t+=a[0],r+=a[1],i.push({key:"M",data:[t,r]}),s=t,e=r;break;case"L":i.push({key:"L",data:[...a]}),[t,r]=a;break;case"l":t+=a[0],r+=a[1],i.push({key:"L",data:[t,r]});break;case"C":i.push({key:"C",data:[...a]}),t=a[4],r=a[5];break;case"c":{let o=a.map((n,c)=>c%2?n+r:n+t);i.push({key:"C",data:o}),t=o[4],r=o[5];break}case"Q":i.push({key:"Q",data:[...a]}),t=a[2],r=a[3];break;case"q":{let o=a.map((n,c)=>c%2?n+r:n+t);i.push({key:"Q",data:o}),t=o[2],r=o[3];break}case"A":i.push({key:"A",data:[...a]}),t=a[5],r=a[6];break;case"a":t+=a[5],r+=a[6],i.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,r]});break;case"H":i.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...a]}),r=a[0];break;case"v":r+=a[0],i.push({key:"V",data:[r]});break;case"S":i.push({key:"S",data:[...a]}),t=a[2],r=a[3];break;case"s":{let o=a.map((n,c)=>c%2?n+r:n+t);i.push({key:"S",data:o}),t=o[2],r=o[3];break}case"T":i.push({key:"T",data:[...a]}),t=a[0],r=a[1];break;case"t":t+=a[0],r+=a[1],i.push({key:"T",data:[t,r]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=s,r=e}return i}function Re(l){let t=[],r="",s=0,e=0,i=0,h=0,a=0,o=0;for(let{key:n,data:c}of l){switch(n){case"M":t.push({key:"M",data:[...c]}),[s,e]=c,[i,h]=c;break;case"C":t.push({key:"C",data:[...c]}),s=c[4],e=c[5],a=c[2],o=c[3];break;case"L":t.push({key:"L",data:[...c]}),[s,e]=c;break;case"H":s=c[0],t.push({key:"L",data:[s,e]});break;case"V":e=c[0],t.push({key:"L",data:[s,e]});break;case"S":{let p=0,f=0;r==="C"||r==="S"?(p=s+(s-a),f=e+(e-o)):(p=s,f=e),t.push({key:"C",data:[p,f,...c]}),a=c[0],o=c[1],s=c[2],e=c[3];break}case"T":{let[p,f]=c,g=0,u=0;r==="Q"||r==="T"?(g=s+(s-a),u=e+(e-o)):(g=s,u=e);let y=s+2*(g-s)/3,m=e+2*(u-e)/3,d=p+2*(g-p)/3,x=f+2*(u-f)/3;t.push({key:"C",data:[y,m,d,x,p,f]}),a=g,o=u,s=p,e=f;break}case"Q":{let[p,f,g,u]=c,y=s+2*(p-s)/3,m=e+2*(f-e)/3,d=g+2*(p-g)/3,x=u+2*(f-u)/3;t.push({key:"C",data:[y,m,d,x,g,u]}),a=p,o=f,s=g,e=u;break}case"A":{let p=Math.abs(c[0]),f=Math.abs(c[1]),g=c[2],u=c[3],y=c[4],m=c[5],d=c[6];p===0||f===0?(t.push({key:"C",data:[s,e,m,d,m,d]}),s=m,e=d):(s!==m||e!==d)&&(Ne(s,e,m,d,p,f,g,u,y).forEach(function(x){t.push({key:"C",data:x})}),s=m,e=d);break}case"Z":t.push({key:"Z",data:[]}),s=i,e=h}r=n}return t}function Dt(l,t,r){return[l*Math.cos(r)-t*Math.sin(r),l*Math.sin(r)+t*Math.cos(r)]}function Ne(l,t,r,s,e,i,h,a,o,n){let c=(p=h,Math.PI*p/180);var p;let f=[],g=0,u=0,y=0,m=0;if(n)[g,u,y,m]=n;else{[l,t]=Dt(l,t,-c),[r,s]=Dt(r,s,-c);let X=(l-r)/2,A=(t-s)/2,_=X*X/(e*e)+A*A/(i*i);_>1&&(_=Math.sqrt(_),e*=_,i*=_);let L=e*e,F=i*i,H=L*F-L*A*A-F*X*X,P=L*A*A+F*X*X,E=(a===o?-1:1)*Math.sqrt(Math.abs(H/P));y=E*e*A/i+(l+r)/2,m=E*-i*X/e+(t+s)/2,g=Math.asin(parseFloat(((t-m)/i).toFixed(9))),u=Math.asin(parseFloat(((s-m)/i).toFixed(9))),l<y&&(g=Math.PI-g),r<y&&(u=Math.PI-u),g<0&&(g=2*Math.PI+g),u<0&&(u=2*Math.PI+u),o&&g>u&&(g-=2*Math.PI),!o&&u>g&&(u-=2*Math.PI)}let d=u-g;if(Math.abs(d)>120*Math.PI/180){let X=u,A=r,_=s;u=o&&u>g?g+120*Math.PI/180*1:g+120*Math.PI/180*-1,f=Ne(r=y+e*Math.cos(u),s=m+i*Math.sin(u),A,_,e,i,h,0,o,[u,X,y,m])}d=u-g;let x=Math.cos(g),b=Math.sin(g),w=Math.cos(u),k=Math.sin(u),S=Math.tan(d/4),D=4/3*e*S,$=4/3*i*S,B=[l,t],C=[l+D*b,t-$*x],W=[r+D*k,s-$*w],V=[r,s];if(C[0]=2*B[0]-C[0],C[1]=2*B[1]-C[1],n)return[C,W,V].concat(f);{f=[C,W,V].concat(f);let X=[];for(let A=0;A<f.length;A+=3){let _=Dt(f[A][0],f[A][1],c),L=Dt(f[A+1][0],f[A+1][1],c),F=Dt(f[A+2][0],f[A+2][1],c);X.push([_[0],_[1],L[0],L[1],F[0],F[1]])}return X}}var aa={randOffset:function(l,t){return j(l,t)},randOffsetWithRange:function(l,t,r){return Et(l,t,r)},ellipse:function(l,t,r,s,e){let i=We(r,s,e);return ie(l,t,e,i).opset},doubleLineOps:function(l,t,r,s,e){return ft(l,t,r,s,e,!0)}};function Ae(l,t,r,s,e){return{type:"path",ops:ft(l,t,r,s,e)}}function Tt(l,t,r){let s=(l||[]).length;if(s>2){let e=[];for(let i=0;i<s-1;i++)e.push(...ft(l[i][0],l[i][1],l[i+1][0],l[i+1][1],r));return t&&e.push(...ft(l[s-1][0],l[s-1][1],l[0][0],l[0][1],r)),{type:"path",ops:e}}return s===2?Ae(l[0][0],l[0][1],l[1][0],l[1][1],r):{type:"path",ops:[]}}function ra(l,t,r,s,e){return function(i,h){return Tt(i,!0,h)}([[l,t],[l+r,t],[l+r,t+s],[l,t+s]],e)}function Me(l,t){if(l.length){let r=typeof l[0][0]=="number"?[l]:l,s=At(r[0],1*(1+.2*t.roughness),t),e=t.disableMultiStroke?[]:At(r[0],1.5*(1+.22*t.roughness),De(t));for(let i=1;i<r.length;i++){let h=r[i];if(h.length){let a=At(h,1*(1+.2*t.roughness),t),o=t.disableMultiStroke?[]:At(h,1.5*(1+.22*t.roughness),De(t));for(let n of a)n.op!=="move"&&s.push(n);for(let n of o)n.op!=="move"&&e.push(n)}}return{type:"path",ops:s.concat(e)}}return{type:"path",ops:[]}}function We(l,t,r){let s=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(l/2,2)+Math.pow(t/2,2))/2)),e=Math.ceil(Math.max(r.curveStepCount,r.curveStepCount/Math.sqrt(200)*s)),i=2*Math.PI/e,h=Math.abs(l/2),a=Math.abs(t/2),o=1-r.curveFitting;return h+=j(h*o,r),a+=j(a*o,r),{increment:i,rx:h,ry:a}}function ie(l,t,r,s){let[e,i]=Pe(s.increment,l,t,s.rx,s.ry,1,s.increment*Et(.1,Et(.4,1,r),r),r),h=It(e,null,r);if(!r.disableMultiStroke&&r.roughness!==0){let[a]=Pe(s.increment,l,t,s.rx,s.ry,1.5,0,r),o=It(a,null,r);h=h.concat(o)}return{estimatedPoints:i,opset:{type:"path",ops:h}}}function ke(l,t,r,s,e,i,h,a,o){let n=l,c=t,p=Math.abs(r/2),f=Math.abs(s/2);p+=j(.01*p,o),f+=j(.01*f,o);let g=e,u=i;for(;g<0;)g+=2*Math.PI,u+=2*Math.PI;u-g>2*Math.PI&&(g=0,u=2*Math.PI);let y=2*Math.PI/o.curveStepCount,m=Math.min(y/2,(u-g)/2),d=Be(m,n,c,p,f,g,u,1,o);if(!o.disableMultiStroke){let x=Be(m,n,c,p,f,g,u,1.5,o);d.push(...x)}return h&&(a?d.push(...ft(n,c,n+p*Math.cos(g),c+f*Math.sin(g),o),...ft(n,c,n+p*Math.cos(u),c+f*Math.sin(u),o)):d.push({op:"lineTo",data:[n,c]},{op:"lineTo",data:[n+p*Math.cos(g),c+f*Math.sin(g)]})),{type:"path",ops:d}}function $e(l,t){let r=Re(Le(he(l))),s=[],e=[0,0],i=[0,0];for(let{key:h,data:a}of r)switch(h){case"M":i=[a[0],a[1]],e=[a[0],a[1]];break;case"L":s.push(...ft(i[0],i[1],a[0],a[1],t)),i=[a[0],a[1]];break;case"C":{let[o,n,c,p,f,g]=a;s.push(...ia(o,n,c,p,f,g,i,t)),i=[f,g];break}case"Z":s.push(...ft(i[0],i[1],e[0],e[1],t)),i=[e[0],e[1]]}return{type:"path",ops:s}}function Jt(l,t){let r=[];for(let s of l)if(s.length){let e=t.maxRandomnessOffset||0,i=s.length;if(i>2){r.push({op:"move",data:[s[0][0]+j(e,t),s[0][1]+j(e,t)]});for(let h=1;h<i;h++)r.push({op:"lineTo",data:[s[h][0]+j(e,t),s[h][1]+j(e,t)]})}}return{type:"fillPath",ops:r}}function xt(l,t){return function(r,s){let e=r.fillStyle||"hachure";if(!at[e])switch(e){case"zigzag":at[e]||(at[e]=new Ut(s));break;case"cross-hatch":at[e]||(at[e]=new te(s));break;case"dots":at[e]||(at[e]=new ee(s));break;case"dashed":at[e]||(at[e]=new se(s));break;case"zigzag-line":at[e]||(at[e]=new ae(s));break;default:e="hachure",at[e]||(at[e]=new Bt(s))}return at[e]}(t,aa).fillPolygons(l,t)}function De(l){let t=Object.assign({},l);return t.randomizer=void 0,l.seed&&(t.seed=l.seed+1),t}function Te(l){return l.randomizer||(l.randomizer=new re(l.seed||0)),l.randomizer.next()}function Et(l,t,r,s=1){return r.roughness*s*(Te(r)*(t-l)+l)}function j(l,t,r=1){return Et(-l,l,t,r)}function ft(l,t,r,s,e,i=!1){let h=i?e.disableMultiStrokeFill:e.disableMultiStroke,a=ne(l,t,r,s,e,!0,!1);if(h)return a;let o=ne(l,t,r,s,e,!0,!0);return a.concat(o)}function ne(l,t,r,s,e,i,h){let a=Math.pow(l-r,2)+Math.pow(t-s,2),o=Math.sqrt(a),n=1;n=o<200?1:o>500?.4:-.0016668*o+1.233334;let c=e.maxRandomnessOffset||0;c*c*100>a&&(c=o/10);let p=c/2,f=.2+.2*Te(e),g=e.bowing*e.maxRandomnessOffset*(s-t)/200,u=e.bowing*e.maxRandomnessOffset*(l-r)/200;g=j(g,e,n),u=j(u,e,n);let y=[],m=()=>j(p,e,n),d=()=>j(c,e,n),x=e.preserveVertices;return i&&(h?y.push({op:"move",data:[l+(x?0:m()),t+(x?0:m())]}):y.push({op:"move",data:[l+(x?0:j(c,e,n)),t+(x?0:j(c,e,n))]})),h?y.push({op:"bcurveTo",data:[g+l+(r-l)*f+m(),u+t+(s-t)*f+m(),g+l+2*(r-l)*f+m(),u+t+2*(s-t)*f+m(),r+(x?0:m()),s+(x?0:m())]}):y.push({op:"bcurveTo",data:[g+l+(r-l)*f+d(),u+t+(s-t)*f+d(),g+l+2*(r-l)*f+d(),u+t+2*(s-t)*f+d(),r+(x?0:d()),s+(x?0:d())]}),y}function At(l,t,r){if(!l.length)return[];let s=[];s.push([l[0][0]+j(t,r),l[0][1]+j(t,r)]),s.push([l[0][0]+j(t,r),l[0][1]+j(t,r)]);for(let e=1;e<l.length;e++)s.push([l[e][0]+j(t,r),l[e][1]+j(t,r)]),e===l.length-1&&s.push([l[e][0]+j(t,r),l[e][1]+j(t,r)]);return It(s,null,r)}function It(l,t,r){let s=l.length,e=[];if(s>3){let i=[],h=1-r.curveTightness;e.push({op:"move",data:[l[1][0],l[1][1]]});for(let a=1;a+2<s;a++){let o=l[a];i[0]=[o[0],o[1]],i[1]=[o[0]+(h*l[a+1][0]-h*l[a-1][0])/6,o[1]+(h*l[a+1][1]-h*l[a-1][1])/6],i[2]=[l[a+1][0]+(h*l[a][0]-h*l[a+2][0])/6,l[a+1][1]+(h*l[a][1]-h*l[a+2][1])/6],i[3]=[l[a+1][0],l[a+1][1]],e.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}if(t&&t.length===2){let a=r.maxRandomnessOffset;e.push({op:"lineTo",data:[t[0]+j(a,r),t[1]+j(a,r)]})}}else s===3?(e.push({op:"move",data:[l[1][0],l[1][1]]}),e.push({op:"bcurveTo",data:[l[1][0],l[1][1],l[2][0],l[2][1],l[2][0],l[2][1]]})):s===2&&e.push(...ne(l[0][0],l[0][1],l[1][0],l[1][1],r,!0,!0));return e}function Pe(l,t,r,s,e,i,h,a){let o=[],n=[];if(a.roughness===0){l/=4,n.push([t+s*Math.cos(-l),r+e*Math.sin(-l)]);for(let c=0;c<=2*Math.PI;c+=l){let p=[t+s*Math.cos(c),r+e*Math.sin(c)];o.push(p),n.push(p)}n.push([t+s*Math.cos(0),r+e*Math.sin(0)]),n.push([t+s*Math.cos(l),r+e*Math.sin(l)])}else{let c=j(.5,a)-Math.PI/2;n.push([j(i,a)+t+.9*s*Math.cos(c-l),j(i,a)+r+.9*e*Math.sin(c-l)]);let p=2*Math.PI+c-.01;for(let f=c;f<p;f+=l){let g=[j(i,a)+t+s*Math.cos(f),j(i,a)+r+e*Math.sin(f)];o.push(g),n.push(g)}n.push([j(i,a)+t+s*Math.cos(c+2*Math.PI+.5*h),j(i,a)+r+e*Math.sin(c+2*Math.PI+.5*h)]),n.push([j(i,a)+t+.98*s*Math.cos(c+h),j(i,a)+r+.98*e*Math.sin(c+h)]),n.push([j(i,a)+t+.9*s*Math.cos(c+.5*h),j(i,a)+r+.9*e*Math.sin(c+.5*h)])}return[n,o]}function Be(l,t,r,s,e,i,h,a,o){let n=i+j(.1,o),c=[];c.push([j(a,o)+t+.9*s*Math.cos(n-l),j(a,o)+r+.9*e*Math.sin(n-l)]);for(let p=n;p<=h;p+=l)c.push([j(a,o)+t+s*Math.cos(p),j(a,o)+r+e*Math.sin(p)]);return c.push([t+s*Math.cos(h),r+e*Math.sin(h)]),c.push([t+s*Math.cos(h),r+e*Math.sin(h)]),It(c,null,o)}function ia(l,t,r,s,e,i,h,a){let o=[],n=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3],c=[0,0],p=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let g=0;g<p;g++)g===0?o.push({op:"move",data:[h[0],h[1]]}):o.push({op:"move",data:[h[0]+(f?0:j(n[0],a)),h[1]+(f?0:j(n[0],a))]}),c=f?[e,i]:[e+j(n[g],a),i+j(n[g],a)],o.push({op:"bcurveTo",data:[l+j(n[g],a),t+j(n[g],a),r+j(n[g],a),s+j(n[g],a),c[0],c[1]]});return o}function Pt(l){return[...l]}function Ce(l,t=0){let r=l.length;if(r<3)throw new Error("A curve must have at least three points.");let s=[];if(r===3)s.push(Pt(l[0]),Pt(l[1]),Pt(l[2]),Pt(l[2]));else{let e=[];e.push(l[0],l[0]);for(let a=1;a<l.length;a++)e.push(l[a]),a===l.length-1&&e.push(l[a]);let i=[],h=1-t;s.push(Pt(e[0]));for(let a=1;a+2<e.length;a++){let o=e[a];i[0]=[o[0],o[1]],i[1]=[o[0]+(h*e[a+1][0]-h*e[a-1][0])/6,o[1]+(h*e[a+1][1]-h*e[a-1][1])/6],i[2]=[e[a+1][0]+(h*e[a][0]-h*e[a+2][0])/6,e[a+1][1]+(h*e[a][1]-h*e[a+2][1])/6],i[3]=[e[a+1][0],e[a+1][1]],s.push(i[1],i[2],i[3])}}return s}function Ht(l,t){return Math.pow(l[0]-t[0],2)+Math.pow(l[1]-t[1],2)}function na(l,t,r){let s=Ht(t,r);if(s===0)return Ht(l,t);let e=((l[0]-t[0])*(r[0]-t[0])+(l[1]-t[1])*(r[1]-t[1]))/s;return e=Math.max(0,Math.min(1,e)),Ht(l,yt(t,r,e))}function yt(l,t,r){return[l[0]+(t[0]-l[0])*r,l[1]+(t[1]-l[1])*r]}function le(l,t,r,s){let e=s||[];if(function(a,o){let n=a[o+0],c=a[o+1],p=a[o+2],f=a[o+3],g=3*c[0]-2*n[0]-f[0];g*=g;let u=3*c[1]-2*n[1]-f[1];u*=u;let y=3*p[0]-2*f[0]-n[0];y*=y;let m=3*p[1]-2*f[1]-n[1];return m*=m,g<y&&(g=y),u<m&&(u=m),g+u}(l,t)<r){let a=l[t+0];e.length?(i=e[e.length-1],h=a,Math.sqrt(Ht(i,h))>1&&e.push(a)):e.push(a),e.push(l[t+3])}else{let o=l[t+0],n=l[t+1],c=l[t+2],p=l[t+3],f=yt(o,n,.5),g=yt(n,c,.5),u=yt(c,p,.5),y=yt(f,g,.5),m=yt(g,u,.5),d=yt(y,m,.5);le([o,f,y,d],0,r,e),le([d,m,u,p],0,r,e)}var i,h;return e}function la(l,t){return Ot(l,0,l.length,t)}function Ot(l,t,r,s,e){let i=e||[],h=l[t],a=l[r-1],o=0,n=1;for(let c=t+1;c<r-1;++c){let p=na(l[c],h,a);p>o&&(o=p,n=c)}return Math.sqrt(o)>s?(Ot(l,t,n+1,s,i),Ot(l,n,r,s,i)):(i.length||i.push(h),i.push(a)),i}function Kt(l,t=.15,r){let s=[],e=(l.length-1)/3;for(let i=0;i<e;i++)le(l,3*i,t,s);return r&&r>0?Ot(s,0,s.length,r):s}var nt="none",bt=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,r,s){return{shape:t,sets:r||[],options:s||this.defaultOptions}}line(t,r,s,e,i){let h=this._o(i);return this._d("line",[Ae(t,r,s,e,h)],h)}rectangle(t,r,s,e,i){let h=this._o(i),a=[],o=ra(t,r,s,e,h);if(h.fill){let n=[[t,r],[t+s,r],[t+s,r+e],[t,r+e]];h.fillStyle==="solid"?a.push(Jt([n],h)):a.push(xt([n],h))}return h.stroke!==nt&&a.push(o),this._d("rectangle",a,h)}ellipse(t,r,s,e,i){let h=this._o(i),a=[],o=We(s,e,h),n=ie(t,r,h,o);if(h.fill)if(h.fillStyle==="solid"){let c=ie(t,r,h,o).opset;c.type="fillPath",a.push(c)}else a.push(xt([n.estimatedPoints],h));return h.stroke!==nt&&a.push(n.opset),this._d("ellipse",a,h)}circle(t,r,s,e){let i=this.ellipse(t,r,s,s,e);return i.shape="circle",i}linearPath(t,r){let s=this._o(r);return this._d("linearPath",[Tt(t,!1,s)],s)}arc(t,r,s,e,i,h,a=!1,o){let n=this._o(o),c=[],p=ke(t,r,s,e,i,h,a,!0,n);if(a&&n.fill)if(n.fillStyle==="solid"){let f=Object.assign({},n);f.disableMultiStroke=!0;let g=ke(t,r,s,e,i,h,!0,!1,f);g.type="fillPath",c.push(g)}else c.push(function(f,g,u,y,m,d,x){let b=f,w=g,k=Math.abs(u/2),S=Math.abs(y/2);k+=j(.01*k,x),S+=j(.01*S,x);let D=m,$=d;for(;D<0;)D+=2*Math.PI,$+=2*Math.PI;$-D>2*Math.PI&&(D=0,$=2*Math.PI);let B=($-D)/x.curveStepCount,C=[];for(let W=D;W<=$;W+=B)C.push([b+k*Math.cos(W),w+S*Math.sin(W)]);return C.push([b+k*Math.cos($),w+S*Math.sin($)]),C.push([b,w]),xt([C],x)}(t,r,s,e,i,h,n));return n.stroke!==nt&&c.push(p),this._d("arc",c,n)}curve(t,r){let s=this._o(r),e=[],i=Me(t,s);if(s.fill&&s.fill!==nt)if(s.fillStyle==="solid"){let h=Me(t,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));e.push({type:"fillPath",ops:this._mergedShape(h.ops)})}else{let h=[],a=t;if(a.length){let o=typeof a[0][0]=="number"?[a]:a;for(let n of o)n.length<3?h.push(...n):n.length===3?h.push(...Kt(Ce([n[0],n[0],n[1],n[2]]),10,(1+s.roughness)/2)):h.push(...Kt(Ce(n),10,(1+s.roughness)/2))}h.length&&e.push(xt([h],s))}return s.stroke!==nt&&e.push(i),this._d("curve",e,s)}polygon(t,r){let s=this._o(r),e=[],i=Tt(t,!0,s);return s.fill&&(s.fillStyle==="solid"?e.push(Jt([t],s)):e.push(xt([t],s))),s.stroke!==nt&&e.push(i),this._d("polygon",e,s)}path(t,r){let s=this._o(r),e=[];if(!t)return this._d("path",e,s);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let i=s.fill&&s.fill!=="transparent"&&s.fill!==nt,h=s.stroke!==nt,a=!!(s.simplification&&s.simplification<1),o=function(c,p,f){let g=Re(Le(he(c))),u=[],y=[],m=[0,0],d=[],x=()=>{d.length>=4&&y.push(...Kt(d,p)),d=[]},b=()=>{x(),y.length&&(u.push(y),y=[])};for(let{key:k,data:S}of g)switch(k){case"M":b(),m=[S[0],S[1]],y.push(m);break;case"L":x(),y.push([S[0],S[1]]);break;case"C":if(!d.length){let D=y.length?y[y.length-1]:m;d.push([D[0],D[1]])}d.push([S[0],S[1]]),d.push([S[2],S[3]]),d.push([S[4],S[5]]);break;case"Z":x(),y.push([m[0],m[1]])}if(b(),!f)return u;let w=[];for(let k of u){let S=la(k,f);S.length&&w.push(S)}return w}(t,1,a?4-4*(s.simplification||1):(1+s.roughness)/2),n=$e(t,s);if(i)if(s.fillStyle==="solid")if(o.length===1){let c=$e(t,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));e.push({type:"fillPath",ops:this._mergedShape(c.ops)})}else e.push(Jt(o,s));else e.push(xt(o,s));return h&&(a?o.forEach(c=>{e.push(Tt(c,!1,s))}):e.push(n)),this._d("path",e,s)}opsToPath(t,r){let s="";for(let e of t.ops){let i=typeof r=="number"&&r>=0?e.data.map(h=>+h.toFixed(r)):e.data;switch(e.op){case"move":s+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":s+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":s+=`L${i[0]} ${i[1]} `}}return s.trim()}toPaths(t){let r=t.sets||[],s=t.options||this.defaultOptions,e=[];for(let i of r){let h=null;switch(i.type){case"path":h={d:this.opsToPath(i),stroke:s.stroke,strokeWidth:s.strokeWidth,fill:nt};break;case"fillPath":h={d:this.opsToPath(i),stroke:nt,strokeWidth:0,fill:s.fill||nt};break;case"fillSketch":h=this.fillSketch(i,s)}h&&e.push(h)}return e}fillSketch(t,r){let s=r.fillWeight;return s<0&&(s=r.strokeWidth/2),{d:this.opsToPath(t),stroke:r.fill||nt,strokeWidth:s,fill:nt}}_mergedShape(t){return t.filter((r,s)=>s===0||r.op!=="move")}},ce=class{constructor(t,r){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new bt(r)}draw(t){let r=t.sets||[],s=t.options||this.getDefaultOptions(),e=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(let h of r)switch(h.type){case"path":e.save(),e.strokeStyle=s.stroke==="none"?"transparent":s.stroke,e.lineWidth=s.strokeWidth,s.strokeLineDash&&e.setLineDash(s.strokeLineDash),s.strokeLineDashOffset&&(e.lineDashOffset=s.strokeLineDashOffset),this._drawToContext(e,h,i),e.restore();break;case"fillPath":{e.save(),e.fillStyle=s.fill||"";let a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(e,h,i,a),e.restore();break}case"fillSketch":this.fillSketch(e,h,s)}}fillSketch(t,r,s){let e=s.fillWeight;e<0&&(e=s.strokeWidth/2),t.save(),s.fillLineDash&&t.setLineDash(s.fillLineDash),s.fillLineDashOffset&&(t.lineDashOffset=s.fillLineDashOffset),t.strokeStyle=s.fill||"",t.lineWidth=e,this._drawToContext(t,r,s.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,r,s,e="nonzero"){t.beginPath();for(let i of r.ops){let h=typeof s=="number"&&s>=0?i.data.map(a=>+a.toFixed(s)):i.data;switch(i.op){case"move":t.moveTo(h[0],h[1]);break;case"bcurveTo":t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"lineTo":t.lineTo(h[0],h[1])}}r.type==="fillPath"?t.fill(e):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,r,s,e,i){let h=this.gen.line(t,r,s,e,i);return this.draw(h),h}rectangle(t,r,s,e,i){let h=this.gen.rectangle(t,r,s,e,i);return this.draw(h),h}ellipse(t,r,s,e,i){let h=this.gen.ellipse(t,r,s,e,i);return this.draw(h),h}circle(t,r,s,e){let i=this.gen.circle(t,r,s,e);return this.draw(i),i}linearPath(t,r){let s=this.gen.linearPath(t,r);return this.draw(s),s}polygon(t,r){let s=this.gen.polygon(t,r);return this.draw(s),s}arc(t,r,s,e,i,h,a=!1,o){let n=this.gen.arc(t,r,s,e,i,h,a,o);return this.draw(n),n}curve(t,r){let s=this.gen.curve(t,r);return this.draw(s),s}path(t,r){let s=this.gen.path(t,r);return this.draw(s),s}},Wt="http://www.w3.org/2000/svg",oe=class{constructor(t,r){this.svg=t,this.gen=new bt(r)}draw(t){let r=t.sets||[],s=t.options||this.getDefaultOptions(),e=this.svg.ownerDocument||window.document,i=e.createElementNS(Wt,"g"),h=t.options.fixedDecimalPlaceDigits;for(let a of r){let o=null;switch(a.type){case"path":o=e.createElementNS(Wt,"path"),o.setAttribute("d",this.opsToPath(a,h)),o.setAttribute("stroke",s.stroke),o.setAttribute("stroke-width",s.strokeWidth+""),o.setAttribute("fill","none"),s.strokeLineDash&&o.setAttribute("stroke-dasharray",s.strokeLineDash.join(" ").trim()),s.strokeLineDashOffset&&o.setAttribute("stroke-dashoffset",`${s.strokeLineDashOffset}`);break;case"fillPath":o=e.createElementNS(Wt,"path"),o.setAttribute("d",this.opsToPath(a,h)),o.setAttribute("stroke","none"),o.setAttribute("stroke-width","0"),o.setAttribute("fill",s.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||o.setAttribute("fill-rule","evenodd");break;case"fillSketch":o=this.fillSketch(e,a,s)}o&&i.appendChild(o)}return i}fillSketch(t,r,s){let e=s.fillWeight;e<0&&(e=s.strokeWidth/2);let i=t.createElementNS(Wt,"path");return i.setAttribute("d",this.opsToPath(r,s.fixedDecimalPlaceDigits)),i.setAttribute("stroke",s.fill||""),i.setAttribute("stroke-width",e+""),i.setAttribute("fill","none"),s.fillLineDash&&i.setAttribute("stroke-dasharray",s.fillLineDash.join(" ").trim()),s.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${s.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,r){return this.gen.opsToPath(t,r)}line(t,r,s,e,i){let h=this.gen.line(t,r,s,e,i);return this.draw(h)}rectangle(t,r,s,e,i){let h=this.gen.rectangle(t,r,s,e,i);return this.draw(h)}ellipse(t,r,s,e,i){let h=this.gen.ellipse(t,r,s,e,i);return this.draw(h)}circle(t,r,s,e){let i=this.gen.circle(t,r,s,e);return this.draw(i)}linearPath(t,r){let s=this.gen.linearPath(t,r);return this.draw(s)}polygon(t,r){let s=this.gen.polygon(t,r);return this.draw(s)}arc(t,r,s,e,i,h,a=!1,o){let n=this.gen.arc(t,r,s,e,i,h,a,o);return this.draw(n)}curve(t,r){let s=this.gen.curve(t,r);return this.draw(s)}path(t,r){let s=this.gen.path(t,r);return this.draw(s)}},M={canvas:(l,t)=>new ce(l,t),svg:(l,t)=>new oe(l,t),generator:l=>new bt(l),newSeed:()=>bt.newSeed()};var q=v((l,t,r)=>R(null,null,function*(){let s,e=t.useHtmlLabels||U(K()?.htmlLabels);r?s=r:s="node default";let i=l.insert("g").attr("class",s).attr("id",t.domId||t.id),h=i.insert("g").attr("class","label").attr("style",st(t.labelStyle)),a;t.label===void 0?a="":a=typeof t.label=="string"?t.label:t.label[0];let o=yield pt(h,Gt(mt(a),K()),{useHtmlLabels:e,width:t.width||K().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img}),n=o.getBBox(),c=(t?.padding??0)/2;if(e){let p=o.children[0],f=J(o),g=p.getElementsByTagName("img");if(g){let u=a.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...g].map(y=>new Promise(m=>{function d(){if(y.style.display="flex",y.style.flexDirection="column",u){let x=K().fontSize?K().fontSize:window.getComputedStyle(document.body).fontSize,b=5,[w=xe.fontSize]=Se(x),k=w*b+"px";y.style.minWidth=k,y.style.maxWidth=k}else y.style.width="100%";m(y)}v(d,"setupImage"),setTimeout(()=>{y.complete&&d()}),y.addEventListener("error",d),y.addEventListener("load",d)})))}n=p.getBoundingClientRect(),f.attr("width",n.width),f.attr("height",n.height)}return e?h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"):h.attr("transform","translate(0, "+-n.height/2+")"),t.centerLabel&&h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),h.insert("rect",":first-child"),{shapeSvg:i,bbox:n,halfPadding:c,label:h}}),"labelHelper"),ge=v((l,t,r)=>R(null,null,function*(){let s=r.useHtmlLabels||U(K()?.flowchart?.htmlLabels),e=l.insert("g").attr("class","label").attr("style",r.labelStyle||""),i=yield pt(e,Gt(mt(t),K()),{useHtmlLabels:s,width:r.width||K()?.flowchart?.wrappingWidth,style:r.labelStyle,addSvgBackground:!!r.icon||!!r.img}),h=i.getBBox(),a=r.padding/2;if(U(K()?.flowchart?.htmlLabels)){let o=i.children[0],n=J(i);h=o.getBoundingClientRect(),n.attr("width",h.width),n.attr("height",h.height)}return s?e.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"):e.attr("transform","translate(0, "+-h.height/2+")"),r.centerLabel&&e.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),e.insert("rect",":first-child"),{shapeSvg:l,bbox:h,halfPadding:a,label:e}}),"insertLabel"),I=v((l,t)=>{let r=t.node().getBBox();l.width=r.width,l.height=r.height},"updateNodeBounds"),G=v((l,t)=>(l.look==="handDrawn"?"rough-node":"node")+" "+l.cssClasses+" "+(t||""),"getNodeClasses");function Y(l){let t=l.map((r,s)=>`${s===0?"M":"L"}${r.x},${r.y}`);return t.push("Z"),t.join(" ")}v(Y,"createPathFromPoints");function ut(l,t,r,s,e,i){let h=[],o=r-l,n=s-t,c=o/i,p=2*Math.PI/c,f=t+n/2;for(let g=0;g<=50;g++){let u=g/50,y=l+u*o,m=f+e*Math.sin(p*(y-l));h.push({x:y,y:m})}return h}v(ut,"generateFullSineWavePoints");function ye(l,t,r,s,e,i){let h=[],a=e*Math.PI/180,c=(i*Math.PI/180-a)/(s-1);for(let p=0;p<s;p++){let f=a+p*c,g=l+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-g,y:-u})}return h}v(ye,"generateCirclePoints");var ca=v((l,t)=>{var r=l.x,s=l.y,e=t.x-r,i=t.y-s,h=l.width/2,a=l.height/2,o,n;return Math.abs(i)*h>Math.abs(e)*a?(i<0&&(a=-a),o=i===0?0:a*e/i,n=a):(e<0&&(h=-h),o=h,n=e===0?0:h*i/e),{x:r+o,y:s+n}},"intersectRect"),St=ca;function He(l,t){t&&l.attr("style",t)}v(He,"applyStyle");function Ee(l){return R(this,null,function*(){let t=J(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),r=t.append("xhtml:div"),s=l.label;l.label&&qt(l.label)&&(s=yield be(l.label.replace(we.lineBreakRegex,`
`),K()));let e=l.isNode?"nodeLabel":"edgeLabel";return r.html('<span class="'+e+'" '+(l.labelStyle?'style="'+l.labelStyle+'"':"")+">"+s+"</span>"),He(r,l.labelStyle),r.style("display","inline-block"),r.style("padding-right","1px"),r.style("white-space","nowrap"),r.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()})}v(Ee,"addHtmlLabel");var oa=v((l,t,r,s)=>R(null,null,function*(){let e=l||"";if(typeof e=="object"&&(e=e[0]),U(K().flowchart.htmlLabels)){e=e.replace(/\\n|\n/g,"<br />"),Z.info("vertexText"+e);let i={isNode:s,label:mt(e).replace(/fa[blrs]?:fa-[\w-]+/g,a=>`<i class='${a.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return yield Ee(i)}else{let i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let h=[];typeof e=="string"?h=e.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(e)?h=e:h=[];for(let a of h){let o=document.createElementNS("http://www.w3.org/2000/svg","tspan");o.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),o.setAttribute("dy","1em"),o.setAttribute("x","0"),r?o.setAttribute("class","title-row"):o.setAttribute("class","row"),o.textContent=a.trim(),i.appendChild(o)}return i}}),"createLabel"),pe=oa,ht=v((l,t,r,s,e)=>["M",l+e,t,"H",l+r-e,"A",e,e,0,0,1,l+r,t+e,"V",t+s-e,"A",e,e,0,0,1,l+r-e,t+s,"H",l+e,"A",e,e,0,0,1,l,t+s-e,"V",t+e,"A",e,e,0,0,1,l+e,t,"Z"].join(" "),"createRoundedRectPathD"),ha=v(l=>{let{handDrawnSeed:t}=K();return{fill:l,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:l,seed:t}},"solidStateFill"),vt=v(l=>{let t=ga([...l.cssCompiledStyles||[],...l.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),ga=v(l=>{let t=new Map;return l.forEach(r=>{let[s,e]=r.split(":");t.set(s.trim(),e?.trim())}),t},"styles2Map"),pa=v(l=>l==="color"||l==="font-size"||l==="font-family"||l==="font-weight"||l==="font-style"||l==="text-decoration"||l==="text-align"||l==="text-transform"||l==="line-height"||l==="letter-spacing"||l==="word-spacing"||l==="text-shadow"||l==="text-overflow"||l==="white-space"||l==="word-wrap"||l==="word-break"||l==="overflow-wrap"||l==="hyphens","isLabelStyle"),O=v(l=>{let{stylesArray:t}=vt(l),r=[],s=[],e=[],i=[];return t.forEach(h=>{let a=h[0];pa(a)?r.push(h.join(":")+" !important"):(s.push(h.join(":")+" !important"),a.includes("stroke")&&e.push(h.join(":")+" !important"),a==="fill"&&i.push(h.join(":")+" !important"))}),{labelStyles:r.join(";"),nodeStyles:s.join(";"),stylesArray:t,borderStyles:e,backgroundStyles:i}},"styles2String"),T=v((l,t)=>{let{themeVariables:r,handDrawnSeed:s}=K(),{nodeBorder:e,mainBkg:i}=r,{stylesMap:h}=vt(l);return Object.assign({roughness:.7,fill:h.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:h.get("stroke")||e,seed:s,strokeWidth:h.get("stroke-width")?.replace("px","")||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),Ie=v((l,t)=>R(null,null,function*(){Z.info("Creating subgraph rect for ",t.id,t);let r=K(),{themeVariables:s,handDrawnSeed:e}=r,{clusterBkg:i,clusterBorder:h}=s,{labelStyles:a,nodeStyles:o,borderStyles:n,backgroundStyles:c}=O(t),p=l.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=U(r.flowchart.htmlLabels),g=p.insert("g").attr("class","cluster-label "),u=yield pt(g,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0}),y=u.getBBox();if(U(r.flowchart.htmlLabels)){let D=u.children[0],$=J(u);y=D.getBoundingClientRect(),$.attr("width",y.width),$.attr("height",y.height)}let m=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(m-t.width)/2-t.padding:t.diff=-t.padding;let d=t.height,x=t.x-m/2,b=t.y-d/2;Z.trace("Data ",t,JSON.stringify(t));let w;if(t.look==="handDrawn"){let D=M.svg(p),$=T(t,{roughness:.7,fill:i,stroke:h,fillWeight:3,seed:e}),B=D.path(ht(x,b,m,d,0),$);w=p.insert(()=>(Z.debug("Rough node insert CXC",B),B),":first-child"),w.select("path:nth-child(2)").attr("style",n.join(";")),w.select("path").attr("style",c.join(";").replace("fill","stroke"))}else w=p.insert("rect",":first-child"),w.attr("style",o).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",b).attr("width",m).attr("height",d);let{subGraphTitleTopMargin:k}=Yt(r);if(g.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+k})`),a){let D=g.select("span");D&&D.attr("style",a)}let S=w.node().getBBox();return t.offsetX=0,t.width=S.width,t.height=S.height,t.offsetY=y.height-t.padding/2,t.intersect=function(D){return St(t,D)},{cluster:p,labelBBox:y}}),"rect"),fa=v((l,t)=>{let r=l.insert("g").attr("class","note-cluster").attr("id",t.id),s=r.insert("rect",":first-child"),e=0*t.padding,i=e/2;s.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+e).attr("height",t.height+e).attr("fill","none");let h=s.node().getBBox();return t.width=h.width,t.height=h.height,t.intersect=function(a){return St(t,a)},{cluster:r,labelBBox:{width:0,height:0}}},"noteGroup"),ua=v((l,t)=>R(null,null,function*(){let r=K(),{themeVariables:s,handDrawnSeed:e}=r,{altBackground:i,compositeBackground:h,compositeTitleBackground:a,nodeBorder:o}=s,n=l.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),c=n.insert("g",":first-child"),p=n.insert("g").attr("class","cluster-label"),f=n.append("rect"),g=p.node().appendChild(yield pe(t.label,t.labelStyle,void 0,!0)),u=g.getBBox();if(U(r.flowchart.htmlLabels)){let B=g.children[0],C=J(g);u=B.getBoundingClientRect(),C.attr("width",u.width),C.attr("height",u.height)}let y=0*t.padding,m=y/2,d=(t.width<=u.width+t.padding?u.width+t.padding:t.width)+y;t.width<=u.width+t.padding?t.diff=(d-t.width)/2-t.padding:t.diff=-t.padding;let x=t.height+y,b=t.height+y-u.height-6,w=t.x-d/2,k=t.y-x/2;t.width=d;let S=t.y-t.height/2-m+u.height+2,D;if(t.look==="handDrawn"){let B=t.cssClasses.includes("statediagram-cluster-alt"),C=M.svg(n),W=t.rx||t.ry?C.path(ht(w,k,d,x,10),{roughness:.7,fill:a,fillStyle:"solid",stroke:o,seed:e}):C.rectangle(w,k,d,x,{seed:e});D=n.insert(()=>W,":first-child");let V=C.rectangle(w,S,d,b,{fill:B?i:h,fillStyle:B?"hachure":"solid",stroke:o,seed:e});D=n.insert(()=>W,":first-child"),f=n.insert(()=>V)}else D=c.insert("rect",":first-child"),D.attr("class","outer").attr("x",w).attr("y",k).attr("width",d).attr("height",x).attr("data-look",t.look),f.attr("class","inner").attr("x",w).attr("y",S).attr("width",d).attr("height",b);p.attr("transform",`translate(${t.x-u.width/2}, ${k+1-(U(r.flowchart.htmlLabels)?0:3)})`);let $=D.node().getBBox();return t.height=$.height,t.offsetX=0,t.offsetY=u.height-t.padding/2,t.labelBBox=u,t.intersect=function(B){return St(t,B)},{cluster:n,labelBBox:u}}),"roundedWithTitle"),ya=v((l,t)=>R(null,null,function*(){Z.info("Creating subgraph rect for ",t.id,t);let r=K(),{themeVariables:s,handDrawnSeed:e}=r,{clusterBkg:i,clusterBorder:h}=s,{labelStyles:a,nodeStyles:o,borderStyles:n,backgroundStyles:c}=O(t),p=l.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=U(r.flowchart.htmlLabels),g=p.insert("g").attr("class","cluster-label "),u=yield pt(g,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0,width:t.width}),y=u.getBBox();if(U(r.flowchart.htmlLabels)){let D=u.children[0],$=J(u);y=D.getBoundingClientRect(),$.attr("width",y.width),$.attr("height",y.height)}let m=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(m-t.width)/2-t.padding:t.diff=-t.padding;let d=t.height,x=t.x-m/2,b=t.y-d/2;Z.trace("Data ",t,JSON.stringify(t));let w;if(t.look==="handDrawn"){let D=M.svg(p),$=T(t,{roughness:.7,fill:i,stroke:h,fillWeight:4,seed:e}),B=D.path(ht(x,b,m,d,t.rx),$);w=p.insert(()=>(Z.debug("Rough node insert CXC",B),B),":first-child"),w.select("path:nth-child(2)").attr("style",n.join(";")),w.select("path").attr("style",c.join(";").replace("fill","stroke"))}else w=p.insert("rect",":first-child"),w.attr("style",o).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",b).attr("width",m).attr("height",d);let{subGraphTitleTopMargin:k}=Yt(r);if(g.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+k})`),a){let D=g.select("span");D&&D.attr("style",a)}let S=w.node().getBBox();return t.offsetX=0,t.width=S.width,t.height=S.height,t.offsetY=y.height-t.padding/2,t.intersect=function(D){return St(t,D)},{cluster:p,labelBBox:y}}),"kanbanSection"),da=v((l,t)=>{let r=K(),{themeVariables:s,handDrawnSeed:e}=r,{nodeBorder:i}=s,h=l.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),a=h.insert("g",":first-child"),o=0*t.padding,n=t.width+o;t.diff=-t.padding;let c=t.height+o,p=t.x-n/2,f=t.y-c/2;t.width=n;let g;if(t.look==="handDrawn"){let m=M.svg(h).rectangle(p,f,n,c,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:e});g=h.insert(()=>m,":first-child")}else g=a.insert("rect",":first-child"),g.attr("class","divider").attr("x",p).attr("y",f).attr("width",n).attr("height",c).attr("data-look",t.look);let u=g.node().getBBox();return t.height=u.height,t.offsetX=0,t.offsetY=0,t.intersect=function(y){return St(t,y)},{cluster:h,labelBBox:{}}},"divider"),ma=Ie,xa={rect:Ie,squareRect:ma,roundedWithTitle:ua,noteGroup:fa,divider:da,kanbanSection:ya},Oe=new Map,Qa=v((l,t)=>R(null,null,function*(){let r=t.shape||"rect",s=yield xa[r](l,t);return Oe.set(t.id,s),s}),"insertCluster"),Ja=v(()=>{Oe=new Map},"clear");function _e(l,t){return l.intersect(t)}v(_e,"intersectNode");var ba=_e;function ze(l,t,r,s){var e=l.x,i=l.y,h=e-s.x,a=i-s.y,o=Math.sqrt(t*t*a*a+r*r*h*h),n=Math.abs(t*r*h/o);s.x<e&&(n=-n);var c=Math.abs(t*r*a/o);return s.y<i&&(c=-c),{x:e+n,y:i+c}}v(ze,"intersectEllipse");var je=ze;function Ge(l,t,r){return je(l,t,t,r)}v(Ge,"intersectCircle");var wa=Ge;function Fe(l,t,r,s){var e,i,h,a,o,n,c,p,f,g,u,y,m,d,x;if(e=t.y-l.y,h=l.x-t.x,o=t.x*l.y-l.x*t.y,f=e*r.x+h*r.y+o,g=e*s.x+h*s.y+o,!(f!==0&&g!==0&&fe(f,g))&&(i=s.y-r.y,a=r.x-s.x,n=s.x*r.y-r.x*s.y,c=i*l.x+a*l.y+n,p=i*t.x+a*t.y+n,!(c!==0&&p!==0&&fe(c,p))&&(u=e*a-i*h,u!==0)))return y=Math.abs(u/2),m=h*n-a*o,d=m<0?(m-y)/u:(m+y)/u,m=i*o-e*n,x=m<0?(m-y)/u:(m+y)/u,{x:d,y:x}}v(Fe,"intersectLine");function fe(l,t){return l*t>0}v(fe,"sameSign");var Sa=Fe;function qe(l,t,r){let s=l.x,e=l.y,i=[],h=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(c){h=Math.min(h,c.x),a=Math.min(a,c.y)}):(h=Math.min(h,t.x),a=Math.min(a,t.y));let o=s-l.width/2-h,n=e-l.height/2-a;for(let c=0;c<t.length;c++){let p=t[c],f=t[c<t.length-1?c+1:0],g=Sa(l,r,{x:o+p.x,y:n+p.y},{x:o+f.x,y:n+f.y});g&&i.push(g)}return i.length?(i.length>1&&i.sort(function(c,p){let f=c.x-r.x,g=c.y-r.y,u=Math.sqrt(f*f+g*g),y=p.x-r.x,m=p.y-r.y,d=Math.sqrt(y*y+m*m);return u<d?-1:u===d?0:1}),i[0]):l}v(qe,"intersectPolygon");var va=qe,N={node:ba,circle:wa,ellipse:je,polygon:va,rect:St};function Xe(l,t){let{labelStyles:r}=O(t);t.labelStyle=r;let s=G(t),e=s;s||(e="anchor");let i=l.insert("g").attr("class",e).attr("id",t.domId||t.id),h=1,{cssStyles:a}=t,o=M.svg(i),n=T(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(n.roughness=0);let c=o.circle(0,0,h*2,n),p=i.insert(()=>c,":first-child");return p.attr("class","anchor").attr("style",st(a)),I(t,p),t.intersect=function(f){return Z.info("Circle intersect",t,h,f),N.circle(t,h,f)},i}v(Xe,"anchor");function ue(l,t,r,s,e,i,h){let o=(l+r)/2,n=(t+s)/2,c=Math.atan2(s-t,r-l),p=(r-l)/2,f=(s-t)/2,g=p/e,u=f/i,y=Math.sqrt(g**2+u**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");let m=Math.sqrt(1-y**2),d=o+m*i*Math.sin(c)*(h?-1:1),x=n-m*e*Math.cos(c)*(h?-1:1),b=Math.atan2((t-x)/i,(l-d)/e),k=Math.atan2((s-x)/i,(r-d)/e)-b;h&&k<0&&(k+=2*Math.PI),!h&&k>0&&(k-=2*Math.PI);let S=[];for(let D=0;D<20;D++){let $=D/19,B=b+$*k,C=d+e*Math.cos(B),W=x+i*Math.sin(B);S.push({x:C,y:W})}return S}v(ue,"generateArcPoints");function Ye(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=i.width+t.padding+20,a=i.height+t.padding,o=a/2,n=o/(2.5+a/50),{cssStyles:c}=t,p=[{x:h/2,y:-a/2},{x:-h/2,y:-a/2},...ue(-h/2,-a/2,-h/2,a/2,n,o,!1),{x:h/2,y:a/2},...ue(h/2,a/2,h/2,-a/2,n,o,!0)],f=M.svg(e),g=T(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=Y(p),y=f.path(u,g),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),c&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",c),s&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",s),m.attr("transform",`translate(${n/2}, 0)`),I(t,m),t.intersect=function(d){return N.polygon(t,p,d)},e})}v(Ye,"bowTieRect");function gt(l,t,r,s){return l.insert("polygon",":first-child").attr("points",s.map(function(e){return e.x+","+e.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+r/2+")")}v(gt,"insertPolygonShape");function Ve(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=i.height+t.padding,a=12,o=i.width+t.padding+a,n=0,c=o,p=-h,f=0,g=[{x:n+a,y:p},{x:c,y:p},{x:c,y:f},{x:n,y:f},{x:n,y:p+a},{x:n+a,y:p}],u,{cssStyles:y}=t;if(t.look==="handDrawn"){let m=M.svg(e),d=T(t,{}),x=Y(g),b=m.path(x,d);u=e.insert(()=>b,":first-child").attr("transform",`translate(${-o/2}, ${h/2})`),y&&u.attr("style",y)}else u=gt(e,o,h,g);return s&&u.attr("style",s),I(t,u),t.intersect=function(m){return N.polygon(t,g,m)},e})}v(Ve,"card");function Ze(l,t){let{nodeStyles:r}=O(t);t.label="";let s=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),{cssStyles:e}=t,i=Math.max(28,t.width??0),h=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],a=M.svg(s),o=T(t,{});t.look!=="handDrawn"&&(o.roughness=0,o.fillStyle="solid");let n=Y(h),c=a.path(n,o),p=s.insert(()=>c,":first-child");return e&&t.look!=="handDrawn"&&p.selectAll("path").attr("style",e),r&&t.look!=="handDrawn"&&p.selectAll("path").attr("style",r),t.width=28,t.height=28,t.intersect=function(f){return N.polygon(t,h,f)},s}v(Ze,"choice");function Qe(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,halfPadding:h}=yield q(l,t,G(t)),a=i.width/2+h,o,{cssStyles:n}=t;if(t.look==="handDrawn"){let c=M.svg(e),p=T(t,{}),f=c.circle(0,0,a*2,p);o=e.insert(()=>f,":first-child"),o.attr("class","basic label-container").attr("style",st(n))}else o=e.insert("circle",":first-child").attr("class","basic label-container").attr("style",s).attr("r",a).attr("cx",0).attr("cy",0);return I(t,o),t.intersect=function(c){return Z.info("Circle intersect",t,a,c),N.circle(t,a,c)},e})}v(Qe,"circle");function Je(l){let t=Math.cos(Math.PI/4),r=Math.sin(Math.PI/4),s=l*2,e={x:s/2*t,y:s/2*r},i={x:-(s/2)*t,y:s/2*r},h={x:-(s/2)*t,y:-(s/2)*r},a={x:s/2*t,y:-(s/2)*r};return`M ${i.x},${i.y} L ${a.x},${a.y}
                   M ${e.x},${e.y} L ${h.x},${h.y}`}v(Je,"createLine");function Ke(l,t){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r,t.label="";let e=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),i=Math.max(30,t?.width??0),{cssStyles:h}=t,a=M.svg(e),o=T(t,{});t.look!=="handDrawn"&&(o.roughness=0,o.fillStyle="solid");let n=a.circle(0,0,i*2,o),c=Je(i),p=a.path(c,o),f=e.insert(()=>n,":first-child");return f.insert(()=>p),h&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",s),I(t,f),t.intersect=function(g){return Z.info("crossedCircle intersect",t,{radius:i,point:g}),N.circle(t,i,g)},e}v(Ke,"crossedCircle");function ct(l,t,r,s=100,e=0,i=180){let h=[],a=e*Math.PI/180,c=(i*Math.PI/180-a)/(s-1);for(let p=0;p<s;p++){let f=a+p*c,g=l+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-g,y:-u})}return h}v(ct,"generateCirclePoints");function Ue(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=i.width+(t.padding??0),o=i.height+(t.padding??0),n=Math.max(5,o*.1),{cssStyles:c}=t,p=[...ct(a/2,-o/2,n,30,-90,0),{x:-a/2-n,y:n},...ct(a/2+n*2,-n,n,20,-180,-270),...ct(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:-o/2},...ct(a/2,o/2,n,20,0,90)],f=[{x:a/2,y:-o/2-n},{x:-a/2,y:-o/2-n},...ct(a/2,-o/2,n,20,-90,0),{x:-a/2-n,y:-n},...ct(a/2+a*.1,-n,n,20,-180,-270),...ct(a/2+a*.1,n,n,20,-90,-180),{x:-a/2-n,y:o/2},...ct(a/2,o/2,n,20,0,90),{x:-a/2,y:o/2+n},{x:a/2,y:o/2+n}],g=M.svg(e),u=T(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=Y(p).replace("Z",""),d=g.path(m,u),x=Y(f),b=g.path(x,et({},u)),w=e.insert("g",":first-child");return w.insert(()=>b,":first-child").attr("stroke-opacity",0),w.insert(()=>d,":first-child"),w.attr("class","text"),c&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",c),s&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",s),w.attr("transform",`translate(${n}, 0)`),h.attr("transform",`translate(${-a/2+n-(i.x-(i.left??0))},${-o/2+(t.padding??0)/2-(i.y-(i.top??0))})`),I(t,w),t.intersect=function(k){return N.polygon(t,f,k)},e})}v(Ue,"curlyBraceLeft");function ot(l,t,r,s=100,e=0,i=180){let h=[],a=e*Math.PI/180,c=(i*Math.PI/180-a)/(s-1);for(let p=0;p<s;p++){let f=a+p*c,g=l+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:g,y:u})}return h}v(ot,"generateCirclePoints");function ts(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=i.width+(t.padding??0),o=i.height+(t.padding??0),n=Math.max(5,o*.1),{cssStyles:c}=t,p=[...ot(a/2,-o/2,n,20,-90,0),{x:a/2+n,y:-n},...ot(a/2+n*2,-n,n,20,-180,-270),...ot(a/2+n*2,n,n,20,-90,-180),{x:a/2+n,y:o/2},...ot(a/2,o/2,n,20,0,90)],f=[{x:-a/2,y:-o/2-n},{x:a/2,y:-o/2-n},...ot(a/2,-o/2,n,20,-90,0),{x:a/2+n,y:-n},...ot(a/2+n*2,-n,n,20,-180,-270),...ot(a/2+n*2,n,n,20,-90,-180),{x:a/2+n,y:o/2},...ot(a/2,o/2,n,20,0,90),{x:a/2,y:o/2+n},{x:-a/2,y:o/2+n}],g=M.svg(e),u=T(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=Y(p).replace("Z",""),d=g.path(m,u),x=Y(f),b=g.path(x,et({},u)),w=e.insert("g",":first-child");return w.insert(()=>b,":first-child").attr("stroke-opacity",0),w.insert(()=>d,":first-child"),w.attr("class","text"),c&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",c),s&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",s),w.attr("transform",`translate(${-n}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(i.x-(i.left??0))},${-o/2+(t.padding??0)/2-(i.y-(i.top??0))})`),I(t,w),t.intersect=function(k){return N.polygon(t,f,k)},e})}v(ts,"curlyBraceRight");function tt(l,t,r,s=100,e=0,i=180){let h=[],a=e*Math.PI/180,c=(i*Math.PI/180-a)/(s-1);for(let p=0;p<s;p++){let f=a+p*c,g=l+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-g,y:-u})}return h}v(tt,"generateCirclePoints");function es(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=i.width+(t.padding??0),o=i.height+(t.padding??0),n=Math.max(5,o*.1),{cssStyles:c}=t,p=[...tt(a/2,-o/2,n,30,-90,0),{x:-a/2-n,y:n},...tt(a/2+n*2,-n,n,20,-180,-270),...tt(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:-o/2},...tt(a/2,o/2,n,20,0,90)],f=[...tt(-a/2+n+n/2,-o/2,n,20,-90,-180),{x:a/2-n/2,y:n},...tt(-a/2-n/2,-n,n,20,0,90),...tt(-a/2-n/2,n,n,20,-90,0),{x:a/2-n/2,y:-n},...tt(-a/2+n+n/2,o/2,n,30,-180,-270)],g=[{x:a/2,y:-o/2-n},{x:-a/2,y:-o/2-n},...tt(a/2,-o/2,n,20,-90,0),{x:-a/2-n,y:-n},...tt(a/2+n*2,-n,n,20,-180,-270),...tt(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:o/2},...tt(a/2,o/2,n,20,0,90),{x:-a/2,y:o/2+n},{x:a/2-n-n/2,y:o/2+n},...tt(-a/2+n+n/2,-o/2,n,20,-90,-180),{x:a/2-n/2,y:n},...tt(-a/2-n/2,-n,n,20,0,90),...tt(-a/2-n/2,n,n,20,-90,0),{x:a/2-n/2,y:-n},...tt(-a/2+n+n/2,o/2,n,30,-180,-270)],u=M.svg(e),y=T(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let d=Y(p).replace("Z",""),x=u.path(d,y),w=Y(f).replace("Z",""),k=u.path(w,y),S=Y(g),D=u.path(S,et({},y)),$=e.insert("g",":first-child");return $.insert(()=>D,":first-child").attr("stroke-opacity",0),$.insert(()=>x,":first-child"),$.insert(()=>k,":first-child"),$.attr("class","text"),c&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",c),s&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",s),$.attr("transform",`translate(${n-n/4}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(i.x-(i.left??0))},${-o/2+(t.padding??0)/2-(i.y-(i.top??0))})`),I(t,$),t.intersect=function(B){return N.polygon(t,g,B)},e})}v(es,"curlyBraces");function ss(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=80,a=20,o=Math.max(h,(i.width+(t.padding??0)*2)*1.25,t?.width??0),n=Math.max(a,i.height+(t.padding??0)*2,t?.height??0),c=n/2,{cssStyles:p}=t,f=M.svg(e),g=T(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=o,y=n,m=u-c,d=y/4,x=[{x:m,y:0},{x:d,y:0},{x:0,y:y/2},{x:d,y},{x:m,y},...ye(-m,-y/2,c,50,270,90)],b=Y(x),w=f.path(b,g),k=e.insert(()=>w,":first-child");return k.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&k.selectChildren("path").attr("style",p),s&&t.look!=="handDrawn"&&k.selectChildren("path").attr("style",s),k.attr("transform",`translate(${-o/2}, ${-n/2})`),I(t,k),t.intersect=function(S){return N.polygon(t,x,S)},e})}v(ss,"curvedTrapezoid");var Ma=v((l,t,r,s,e,i)=>[`M${l},${t+i}`,`a${e},${i} 0,0,0 ${r},0`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`].join(" "),"createCylinderPathD"),ka=v((l,t,r,s,e,i)=>[`M${l},${t+i}`,`M${l+r},${t+i}`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`].join(" "),"createOuterCylinderPathD"),$a=v((l,t,r,s,e,i)=>[`M${l-r/2},${-s/2}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");function as(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+t.padding,t.width??0),o=a/2,n=o/(2.5+a/50),c=Math.max(i.height+n+t.padding,t.height??0),p,{cssStyles:f}=t;if(t.look==="handDrawn"){let g=M.svg(e),u=ka(0,0,a,c,o,n),y=$a(0,n,a,c,o,n),m=g.path(u,T(t,{})),d=g.path(y,T(t,{fill:"none"}));p=e.insert(()=>d,":first-child"),p=e.insert(()=>m,":first-child"),p.attr("class","basic label-container"),f&&p.attr("style",f)}else{let g=Ma(0,0,a,c,o,n);p=e.insert("path",":first-child").attr("d",g).attr("class","basic label-container").attr("style",st(f)).attr("style",s)}return p.attr("label-offset-y",n),p.attr("transform",`translate(${-a/2}, ${-(c/2+n)})`),I(t,p),h.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(g){let u=N.rect(t,g),y=u.x-(t.x??0);if(o!=0&&(Math.abs(y)<(t.width??0)/2||Math.abs(y)==(t.width??0)/2&&Math.abs(u.y-(t.y??0))>(t.height??0)/2-n)){let m=n*n*(1-y*y/(o*o));m>0&&(m=Math.sqrt(m)),m=n-m,g.y-(t.y??0)>0&&(m=-m),u.y+=m}return u},e})}v(as,"cylinder");function rs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=i.width+t.padding,o=i.height+t.padding,n=o*.2,c=-a/2,p=-o/2-n/2,{cssStyles:f}=t,g=M.svg(e),u=T(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:c,y:p+n},{x:-c,y:p+n},{x:-c,y:-p},{x:c,y:-p},{x:c,y:p},{x:-c,y:p},{x:-c,y:p+n}],m=g.polygon(y.map(x=>[x.x,x.y]),u),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),h.attr("transform",`translate(${c+(t.padding??0)/2-(i.x-(i.left??0))}, ${p+n+(t.padding??0)/2-(i.y-(i.top??0))})`),I(t,d),t.intersect=function(x){return N.rect(t,x)},e})}v(rs,"dividedRectangle");function is(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,halfPadding:h}=yield q(l,t,G(t)),o=i.width/2+h+5,n=i.width/2+h,c,{cssStyles:p}=t;if(t.look==="handDrawn"){let f=M.svg(e),g=T(t,{roughness:.2,strokeWidth:2.5}),u=T(t,{roughness:.2,strokeWidth:1.5}),y=f.circle(0,0,o*2,g),m=f.circle(0,0,n*2,u);c=e.insert("g",":first-child"),c.attr("class",st(t.cssClasses)).attr("style",st(p)),c.node()?.appendChild(y),c.node()?.appendChild(m)}else{c=e.insert("g",":first-child");let f=c.insert("circle",":first-child"),g=c.insert("circle");c.attr("class","basic label-container").attr("style",s),f.attr("class","outer-circle").attr("style",s).attr("r",o).attr("cx",0).attr("cy",0),g.attr("class","inner-circle").attr("style",s).attr("r",n).attr("cx",0).attr("cy",0)}return I(t,c),t.intersect=function(f){return Z.info("DoubleCircle intersect",t,o,f),N.circle(t,o,f)},e})}v(is,"doublecircle");function ns(l,t,{config:{themeVariables:r}}){let{labelStyles:s,nodeStyles:e}=O(t);t.label="",t.labelStyle=s;let i=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),h=7,{cssStyles:a}=t,o=M.svg(i),{nodeBorder:n}=r,c=T(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);let p=o.circle(0,0,h*2,c),f=i.insert(()=>p,":first-child");return f.selectAll("path").attr("style",`fill: ${n} !important;`),a&&a.length>0&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",a),e&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",e),I(t,f),t.intersect=function(g){return Z.info("filledCircle intersect",t,{radius:h,point:g}),N.circle(t,h,g)},i}v(ns,"filledCircle");function ls(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=i.width+(t.padding??0),o=a+i.height,n=a+i.height,c=[{x:0,y:-o},{x:n,y:-o},{x:n/2,y:0}],{cssStyles:p}=t,f=M.svg(e),g=T(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=Y(c),y=f.path(u,g),m=e.insert(()=>y,":first-child").attr("transform",`translate(${-o/2}, ${o/2})`);return p&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",p),s&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",s),t.width=a,t.height=o,I(t,m),h.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-o/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(d){return Z.info("Triangle intersect",t,c,d),N.polygon(t,c,d)},e})}v(ls,"flippedTriangle");function cs(l,t,{dir:r,config:{state:s,themeVariables:e}}){let{nodeStyles:i}=O(t);t.label="";let h=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),{cssStyles:a}=t,o=Math.max(70,t?.width??0),n=Math.max(10,t?.height??0);r==="LR"&&(o=Math.max(10,t?.width??0),n=Math.max(70,t?.height??0));let c=-1*o/2,p=-1*n/2,f=M.svg(h),g=T(t,{stroke:e.lineColor,fill:e.lineColor});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=f.rectangle(c,p,o,n,g),y=h.insert(()=>u,":first-child");a&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",a),i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),I(t,y);let m=s?.padding??0;return t.width&&t.height&&(t.width+=m/2||0,t.height+=m/2||0),t.intersect=function(d){return N.rect(t,d)},h}v(cs,"forkJoin");function os(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let e=80,i=50,{shapeSvg:h,bbox:a}=yield q(l,t,G(t)),o=Math.max(e,a.width+(t.padding??0)*2,t?.width??0),n=Math.max(i,a.height+(t.padding??0)*2,t?.height??0),c=n/2,{cssStyles:p}=t,f=M.svg(h),g=T(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=[{x:-o/2,y:-n/2},{x:o/2-c,y:-n/2},...ye(-o/2+c,0,c,50,90,270),{x:o/2-c,y:n/2},{x:-o/2,y:n/2}],y=Y(u),m=f.path(y,g),d=h.insert(()=>m,":first-child");return d.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",p),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),I(t,d),t.intersect=function(x){return Z.info("Pill intersect",t,{radius:c,point:x}),N.polygon(t,u,x)},h})}v(os,"halfRoundedRectangle");var Da=v((l,t,r,s,e)=>[`M${l+e},${t}`,`L${l+r-e},${t}`,`L${l+r},${t-s/2}`,`L${l+r-e},${t-s}`,`L${l+e},${t-s}`,`L${l},${t-s/2}`,"Z"].join(" "),"createHexagonPathD");function hs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=4,a=i.height+t.padding,o=a/h,n=i.width+2*o+t.padding,c=[{x:o,y:0},{x:n-o,y:0},{x:n,y:-a/2},{x:n-o,y:-a},{x:o,y:-a},{x:0,y:-a/2}],p,{cssStyles:f}=t;if(t.look==="handDrawn"){let g=M.svg(e),u=T(t,{}),y=Da(0,0,n,a,o),m=g.path(y,u);p=e.insert(()=>m,":first-child").attr("transform",`translate(${-n/2}, ${a/2})`),f&&p.attr("style",f)}else p=gt(e,n,a,c);return s&&p.attr("style",s),t.width=n,t.height=a,I(t,p),t.intersect=function(g){return N.polygon(t,c,g)},e})}v(hs,"hexagon");function gs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.label="",t.labelStyle=r;let{shapeSvg:e}=yield q(l,t,G(t)),i=Math.max(30,t?.width??0),h=Math.max(30,t?.height??0),{cssStyles:a}=t,o=M.svg(e),n=T(t,{});t.look!=="handDrawn"&&(n.roughness=0,n.fillStyle="solid");let c=[{x:0,y:0},{x:i,y:0},{x:0,y:h},{x:i,y:h}],p=Y(c),f=o.path(p,n),g=e.insert(()=>f,":first-child");return g.attr("class","basic label-container"),a&&t.look!=="handDrawn"&&g.selectChildren("path").attr("style",a),s&&t.look!=="handDrawn"&&g.selectChildren("path").attr("style",s),g.attr("transform",`translate(${-i/2}, ${-h/2})`),I(t,g),t.intersect=function(u){return Z.info("Pill intersect",t,{points:c}),N.polygon(t,c,u)},e})}v(gs,"hourglass");function ps(e,i,h){return R(this,arguments,function*(l,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=O(t);t.labelStyle=a;let o=t.assetHeight??48,n=t.assetWidth??48,c=Math.max(o,n),p=s?.wrappingWidth;t.width=Math.max(c,p??0);let{shapeSvg:f,bbox:g,label:u}=yield q(l,t,"icon-shape default"),y=t.pos==="t",m=c,d=c,{nodeBorder:x}=r,{stylesMap:b}=vt(t),w=-d/2,k=-m/2,S=t.label?8:0,D=M.svg(f),$=T(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&($.roughness=0,$.fillStyle="solid");let B=D.rectangle(w,k,d,m,$),C=Math.max(d,g.width),W=m+g.height+S,V=D.rectangle(-C/2,-W/2,C,W,it(et({},$),{fill:"transparent",stroke:"none"})),X=f.insert(()=>B,":first-child"),A=f.insert(()=>V);if(t.icon){let _=f.append("g");_.html(`<g>${yield kt(t.icon,{height:c,width:c,fallbackPrefix:""})}</g>`);let L=_.node().getBBox(),F=L.width,H=L.height,P=L.x,E=L.y;_.attr("transform",`translate(${-F/2-P},${y?g.height/2+S/2-H/2-E:-g.height/2-S/2-H/2-E})`),_.attr("style",`color: ${b.get("stroke")??x};`)}return u.attr("transform",`translate(${-g.width/2-(g.x-(g.left??0))},${y?-W/2:W/2-g.height})`),X.attr("transform",`translate(0,${y?g.height/2+S/2:-g.height/2-S/2})`),I(t,A),t.intersect=function(_){if(Z.info("iconSquare intersect",t,_),!t.label)return N.rect(t,_);let L=t.x??0,F=t.y??0,H=t.height??0,P=[];return y?P=[{x:L-g.width/2,y:F-H/2},{x:L+g.width/2,y:F-H/2},{x:L+g.width/2,y:F-H/2+g.height+S},{x:L+d/2,y:F-H/2+g.height+S},{x:L+d/2,y:F+H/2},{x:L-d/2,y:F+H/2},{x:L-d/2,y:F-H/2+g.height+S},{x:L-g.width/2,y:F-H/2+g.height+S}]:P=[{x:L-d/2,y:F-H/2},{x:L+d/2,y:F-H/2},{x:L+d/2,y:F-H/2+m},{x:L+g.width/2,y:F-H/2+m},{x:L+g.width/2/2,y:F+H/2},{x:L-g.width/2,y:F+H/2},{x:L-g.width/2,y:F-H/2+m},{x:L-d/2,y:F-H/2+m}],N.polygon(t,P,_)},f})}v(ps,"icon");function fs(e,i,h){return R(this,arguments,function*(l,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=O(t);t.labelStyle=a;let o=t.assetHeight??48,n=t.assetWidth??48,c=Math.max(o,n),p=s?.wrappingWidth;t.width=Math.max(c,p??0);let{shapeSvg:f,bbox:g,label:u}=yield q(l,t,"icon-shape default"),y=20,m=t.label?8:0,d=t.pos==="t",{nodeBorder:x,mainBkg:b}=r,{stylesMap:w}=vt(t),k=M.svg(f),S=T(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");let D=w.get("fill");S.stroke=D??b;let $=f.append("g");t.icon&&$.html(`<g>${yield kt(t.icon,{height:c,width:c,fallbackPrefix:""})}</g>`);let B=$.node().getBBox(),C=B.width,W=B.height,V=B.x,X=B.y,A=Math.max(C,W)*Math.SQRT2+y*2,_=k.circle(0,0,A,S),L=Math.max(A,g.width),F=A+g.height+m,H=k.rectangle(-L/2,-F/2,L,F,it(et({},S),{fill:"transparent",stroke:"none"})),P=f.insert(()=>_,":first-child"),E=f.insert(()=>H);return $.attr("transform",`translate(${-C/2-V},${d?g.height/2+m/2-W/2-X:-g.height/2-m/2-W/2-X})`),$.attr("style",`color: ${w.get("stroke")??x};`),u.attr("transform",`translate(${-g.width/2-(g.x-(g.left??0))},${d?-F/2:F/2-g.height})`),P.attr("transform",`translate(0,${d?g.height/2+m/2:-g.height/2-m/2})`),I(t,E),t.intersect=function(z){return Z.info("iconSquare intersect",t,z),N.rect(t,z)},f})}v(fs,"iconCircle");function us(e,i,h){return R(this,arguments,function*(l,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=O(t);t.labelStyle=a;let o=t.assetHeight??48,n=t.assetWidth??48,c=Math.max(o,n),p=s?.wrappingWidth;t.width=Math.max(c,p??0);let{shapeSvg:f,bbox:g,halfPadding:u,label:y}=yield q(l,t,"icon-shape default"),m=t.pos==="t",d=c+u*2,x=c+u*2,{nodeBorder:b,mainBkg:w}=r,{stylesMap:k}=vt(t),S=-x/2,D=-d/2,$=t.label?8:0,B=M.svg(f),C=T(t,{});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");let W=k.get("fill");C.stroke=W??w;let V=B.path(ht(S,D,x,d,5),C),X=Math.max(x,g.width),A=d+g.height+$,_=B.rectangle(-X/2,-A/2,X,A,it(et({},C),{fill:"transparent",stroke:"none"})),L=f.insert(()=>V,":first-child").attr("class","icon-shape2"),F=f.insert(()=>_);if(t.icon){let H=f.append("g");H.html(`<g>${yield kt(t.icon,{height:c,width:c,fallbackPrefix:""})}</g>`);let P=H.node().getBBox(),E=P.width,z=P.height,Q=P.x,rt=P.y;H.attr("transform",`translate(${-E/2-Q},${m?g.height/2+$/2-z/2-rt:-g.height/2-$/2-z/2-rt})`),H.attr("style",`color: ${k.get("stroke")??b};`)}return y.attr("transform",`translate(${-g.width/2-(g.x-(g.left??0))},${m?-A/2:A/2-g.height})`),L.attr("transform",`translate(0,${m?g.height/2+$/2:-g.height/2-$/2})`),I(t,F),t.intersect=function(H){if(Z.info("iconSquare intersect",t,H),!t.label)return N.rect(t,H);let P=t.x??0,E=t.y??0,z=t.height??0,Q=[];return m?Q=[{x:P-g.width/2,y:E-z/2},{x:P+g.width/2,y:E-z/2},{x:P+g.width/2,y:E-z/2+g.height+$},{x:P+x/2,y:E-z/2+g.height+$},{x:P+x/2,y:E+z/2},{x:P-x/2,y:E+z/2},{x:P-x/2,y:E-z/2+g.height+$},{x:P-g.width/2,y:E-z/2+g.height+$}]:Q=[{x:P-x/2,y:E-z/2},{x:P+x/2,y:E-z/2},{x:P+x/2,y:E-z/2+d},{x:P+g.width/2,y:E-z/2+d},{x:P+g.width/2/2,y:E+z/2},{x:P-g.width/2,y:E+z/2},{x:P-g.width/2,y:E-z/2+d},{x:P-x/2,y:E-z/2+d}],N.polygon(t,Q,H)},f})}v(us,"iconRounded");function ys(e,i,h){return R(this,arguments,function*(l,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=O(t);t.labelStyle=a;let o=t.assetHeight??48,n=t.assetWidth??48,c=Math.max(o,n),p=s?.wrappingWidth;t.width=Math.max(c,p??0);let{shapeSvg:f,bbox:g,halfPadding:u,label:y}=yield q(l,t,"icon-shape default"),m=t.pos==="t",d=c+u*2,x=c+u*2,{nodeBorder:b,mainBkg:w}=r,{stylesMap:k}=vt(t),S=-x/2,D=-d/2,$=t.label?8:0,B=M.svg(f),C=T(t,{});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");let W=k.get("fill");C.stroke=W??w;let V=B.path(ht(S,D,x,d,.1),C),X=Math.max(x,g.width),A=d+g.height+$,_=B.rectangle(-X/2,-A/2,X,A,it(et({},C),{fill:"transparent",stroke:"none"})),L=f.insert(()=>V,":first-child"),F=f.insert(()=>_);if(t.icon){let H=f.append("g");H.html(`<g>${yield kt(t.icon,{height:c,width:c,fallbackPrefix:""})}</g>`);let P=H.node().getBBox(),E=P.width,z=P.height,Q=P.x,rt=P.y;H.attr("transform",`translate(${-E/2-Q},${m?g.height/2+$/2-z/2-rt:-g.height/2-$/2-z/2-rt})`),H.attr("style",`color: ${k.get("stroke")??b};`)}return y.attr("transform",`translate(${-g.width/2-(g.x-(g.left??0))},${m?-A/2:A/2-g.height})`),L.attr("transform",`translate(0,${m?g.height/2+$/2:-g.height/2-$/2})`),I(t,F),t.intersect=function(H){if(Z.info("iconSquare intersect",t,H),!t.label)return N.rect(t,H);let P=t.x??0,E=t.y??0,z=t.height??0,Q=[];return m?Q=[{x:P-g.width/2,y:E-z/2},{x:P+g.width/2,y:E-z/2},{x:P+g.width/2,y:E-z/2+g.height+$},{x:P+x/2,y:E-z/2+g.height+$},{x:P+x/2,y:E+z/2},{x:P-x/2,y:E+z/2},{x:P-x/2,y:E-z/2+g.height+$},{x:P-g.width/2,y:E-z/2+g.height+$}]:Q=[{x:P-x/2,y:E-z/2},{x:P+x/2,y:E-z/2},{x:P+x/2,y:E-z/2+d},{x:P+g.width/2,y:E-z/2+d},{x:P+g.width/2/2,y:E+z/2},{x:P-g.width/2,y:E+z/2},{x:P-g.width/2,y:E-z/2+d},{x:P-x/2,y:E-z/2+d}],N.polygon(t,Q,H)},f})}v(ys,"iconSquare");function ds(s,e,i){return R(this,arguments,function*(l,t,{config:{flowchart:r}}){let h=new Image;h.src=t?.img??"",yield h.decode();let a=Number(h.naturalWidth.toString().replace("px","")),o=Number(h.naturalHeight.toString().replace("px",""));t.imageAspectRatio=a/o;let{labelStyles:n}=O(t);t.labelStyle=n;let c=r?.wrappingWidth;t.defaultWidth=r?.wrappingWidth;let p=Math.max(t.label?c??0:0,t?.assetWidth??a),f=t.constraint==="on"&&t?.assetHeight?t.assetHeight*t.imageAspectRatio:p,g=t.constraint==="on"?f/t.imageAspectRatio:t?.assetHeight??o;t.width=Math.max(f,c??0);let{shapeSvg:u,bbox:y,label:m}=yield q(l,t,"image-shape default"),d=t.pos==="t",x=-f/2,b=-g/2,w=t.label?8:0,k=M.svg(u),S=T(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");let D=k.rectangle(x,b,f,g,S),$=Math.max(f,y.width),B=g+y.height+w,C=k.rectangle(-$/2,-B/2,$,B,it(et({},S),{fill:"none",stroke:"none"})),W=u.insert(()=>D,":first-child"),V=u.insert(()=>C);if(t.img){let X=u.append("image");X.attr("href",t.img),X.attr("width",f),X.attr("height",g),X.attr("preserveAspectRatio","none"),X.attr("transform",`translate(${-f/2},${d?B/2-g:-B/2})`)}return m.attr("transform",`translate(${-y.width/2-(y.x-(y.left??0))},${d?-g/2-y.height/2-w/2:g/2-y.height/2+w/2})`),W.attr("transform",`translate(0,${d?y.height/2+w/2:-y.height/2-w/2})`),I(t,V),t.intersect=function(X){if(Z.info("iconSquare intersect",t,X),!t.label)return N.rect(t,X);let A=t.x??0,_=t.y??0,L=t.height??0,F=[];return d?F=[{x:A-y.width/2,y:_-L/2},{x:A+y.width/2,y:_-L/2},{x:A+y.width/2,y:_-L/2+y.height+w},{x:A+f/2,y:_-L/2+y.height+w},{x:A+f/2,y:_+L/2},{x:A-f/2,y:_+L/2},{x:A-f/2,y:_-L/2+y.height+w},{x:A-y.width/2,y:_-L/2+y.height+w}]:F=[{x:A-f/2,y:_-L/2},{x:A+f/2,y:_-L/2},{x:A+f/2,y:_-L/2+g},{x:A+y.width/2,y:_-L/2+g},{x:A+y.width/2/2,y:_+L/2},{x:A-y.width/2,y:_+L/2},{x:A-y.width/2,y:_-L/2+g},{x:A-f/2,y:_-L/2+g}],N.polygon(t,F,X)},u})}v(ds,"imageSquare");function ms(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=Math.max(i.width+(t.padding??0)*2,t?.width??0),a=Math.max(i.height+(t.padding??0)*2,t?.height??0),o=[{x:0,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:-3*a/6,y:-a}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=M.svg(e),f=T(t,{}),g=Y(o),u=p.path(g,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),c&&n.attr("style",c)}else n=gt(e,h,a,o);return s&&n.attr("style",s),t.width=h,t.height=a,I(t,n),t.intersect=function(p){return N.polygon(t,o,p)},e})}v(ms,"inv_trapezoid");function Rt(l,t,r){return R(this,null,function*(){let{labelStyles:s,nodeStyles:e}=O(t);t.labelStyle=s;let{shapeSvg:i,bbox:h}=yield q(l,t,G(t)),a=Math.max(h.width+r.labelPaddingX*2,t?.width||0),o=Math.max(h.height+r.labelPaddingY*2,t?.height||0),n=-a/2,c=-o/2,p,{rx:f,ry:g}=t,{cssStyles:u}=t;if(r?.rx&&r.ry&&(f=r.rx,g=r.ry),t.look==="handDrawn"){let y=M.svg(i),m=T(t,{}),d=f||g?y.path(ht(n,c,a,o,f||0),m):y.rectangle(n,c,a,o,m);p=i.insert(()=>d,":first-child"),p.attr("class","basic label-container").attr("style",st(u))}else p=i.insert("rect",":first-child"),p.attr("class","basic label-container").attr("style",e).attr("rx",st(f)).attr("ry",st(g)).attr("x",n).attr("y",c).attr("width",a).attr("height",o);return I(t,p),t.intersect=function(y){return N.rect(t,y)},i})}v(Rt,"drawRect");function xs(l,t){return R(this,null,function*(){let{shapeSvg:r,bbox:s,label:e}=yield q(l,t,"label"),i=r.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),r.attr("class","label edgeLabel"),e.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),I(t,i),t.intersect=function(o){return N.rect(t,o)},r})}v(xs,"labelRect");function bs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=Math.max(i.width+(t.padding??0),t?.width??0),a=Math.max(i.height+(t.padding??0),t?.height??0),o=[{x:0,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:-(3*a)/6,y:-a}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=M.svg(e),f=T(t,{}),g=Y(o),u=p.path(g,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),c&&n.attr("style",c)}else n=gt(e,h,a,o);return s&&n.attr("style",s),t.width=h,t.height=a,I(t,n),t.intersect=function(p){return N.polygon(t,o,p)},e})}v(bs,"lean_left");function ws(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=Math.max(i.width+(t.padding??0),t?.width??0),a=Math.max(i.height+(t.padding??0),t?.height??0),o=[{x:-3*a/6,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:0,y:-a}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=M.svg(e),f=T(t,{}),g=Y(o),u=p.path(g,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),c&&n.attr("style",c)}else n=gt(e,h,a,o);return s&&n.attr("style",s),t.width=h,t.height=a,I(t,n),t.intersect=function(p){return N.polygon(t,o,p)},e})}v(ws,"lean_right");function Ss(l,t){let{labelStyles:r,nodeStyles:s}=O(t);t.label="",t.labelStyle=r;let e=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,h=Math.max(35,t?.width??0),a=Math.max(35,t?.height??0),o=7,n=[{x:h,y:0},{x:0,y:a+o/2},{x:h-2*o,y:a+o/2},{x:0,y:2*a},{x:h,y:a-o/2},{x:2*o,y:a-o/2}],c=M.svg(e),p=T(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let f=Y(n),g=c.path(f,p),u=e.insert(()=>g,":first-child");return i&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",i),s&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",s),u.attr("transform",`translate(-${h/2},${-a})`),I(t,u),t.intersect=function(y){return Z.info("lightningBolt intersect",t,y),N.polygon(t,n,y)},e}v(Ss,"lightningBolt");var Pa=v((l,t,r,s,e,i,h)=>[`M${l},${t+i}`,`a${e},${i} 0,0,0 ${r},0`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`,`M${l},${t+i+h}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createCylinderPathD"),Ba=v((l,t,r,s,e,i,h)=>[`M${l},${t+i}`,`M${l+r},${t+i}`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`,`M${l},${t+i+h}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createOuterCylinderPathD"),Ca=v((l,t,r,s,e,i)=>[`M${l-r/2},${-s/2}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");function vs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+(t.padding??0),t.width??0),o=a/2,n=o/(2.5+a/50),c=Math.max(i.height+n+(t.padding??0),t.height??0),p=c*.1,f,{cssStyles:g}=t;if(t.look==="handDrawn"){let u=M.svg(e),y=Ba(0,0,a,c,o,n,p),m=Ca(0,n,a,c,o,n),d=T(t,{}),x=u.path(y,d),b=u.path(m,d);e.insert(()=>b,":first-child").attr("class","line"),f=e.insert(()=>x,":first-child"),f.attr("class","basic label-container"),g&&f.attr("style",g)}else{let u=Pa(0,0,a,c,o,n,p);f=e.insert("path",":first-child").attr("d",u).attr("class","basic label-container").attr("style",st(g)).attr("style",s)}return f.attr("label-offset-y",n),f.attr("transform",`translate(${-a/2}, ${-(c/2+n)})`),I(t,f),h.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+n-(i.y-(i.top??0))})`),t.intersect=function(u){let y=N.rect(t,u),m=y.x-(t.x??0);if(o!=0&&(Math.abs(m)<(t.width??0)/2||Math.abs(m)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-n)){let d=n*n*(1-m*m/(o*o));d>0&&(d=Math.sqrt(d)),d=n-d,u.y-(t.y??0)>0&&(d=-d),y.y+=d}return y},e})}v(vs,"linedCylinder");function Ms(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=o/4,c=o+n,{cssStyles:p}=t,f=M.svg(e),g=T(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=[{x:-a/2-a/2*.1,y:-c/2},{x:-a/2-a/2*.1,y:c/2},...ut(-a/2-a/2*.1,c/2,a/2+a/2*.1,c/2,n,.8),{x:a/2+a/2*.1,y:-c/2},{x:-a/2-a/2*.1,y:-c/2},{x:-a/2,y:-c/2},{x:-a/2,y:c/2*1.1},{x:-a/2,y:-c/2}],y=f.polygon(u.map(d=>[d.x,d.y]),g),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",p),s&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",s),m.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)+a/2*.1/2-(i.x-(i.left??0))},${-o/2+(t.padding??0)-n/2-(i.y-(i.top??0))})`),I(t,m),t.intersect=function(d){return N.polygon(t,u,d)},e})}v(Ms,"linedWaveEdgedRect");function ks(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=5,c=-a/2,p=-o/2,{cssStyles:f}=t,g=M.svg(e),u=T(t,{}),y=[{x:c-n,y:p+n},{x:c-n,y:p+o+n},{x:c+a-n,y:p+o+n},{x:c+a-n,y:p+o},{x:c+a,y:p+o},{x:c+a,y:p+o-n},{x:c+a+n,y:p+o-n},{x:c+a+n,y:p-n},{x:c+n,y:p-n},{x:c+n,y:p},{x:c,y:p},{x:c,y:p+n}],m=[{x:c,y:p+n},{x:c+a-n,y:p+n},{x:c+a-n,y:p+o},{x:c+a,y:p+o},{x:c+a,y:p},{x:c,y:p}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=Y(y),x=g.path(d,u),b=Y(m),w=g.path(b,it(et({},u),{fill:"none"})),k=e.insert(()=>w,":first-child");return k.insert(()=>x,":first-child"),k.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",s),h.attr("transform",`translate(${-(i.width/2)-n-(i.x-(i.left??0))}, ${-(i.height/2)+n-(i.y-(i.top??0))})`),I(t,k),t.intersect=function(S){return N.polygon(t,y,S)},e})}v(ks,"multiRect");function $s(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=o/4,c=o+n,p=-a/2,f=-c/2,g=5,{cssStyles:u}=t,y=ut(p-g,f+c+g,p+a-g,f+c+g,n,.8),m=y?.[y.length-1],d=[{x:p-g,y:f+g},{x:p-g,y:f+c+g},...y,{x:p+a-g,y:m.y-g},{x:p+a,y:m.y-g},{x:p+a,y:m.y-2*g},{x:p+a+g,y:m.y-2*g},{x:p+a+g,y:f-g},{x:p+g,y:f-g},{x:p+g,y:f},{x:p,y:f},{x:p,y:f+g}],x=[{x:p,y:f+g},{x:p+a-g,y:f+g},{x:p+a-g,y:m.y-g},{x:p+a,y:m.y-g},{x:p+a,y:f},{x:p,y:f}],b=M.svg(e),w=T(t,{});t.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");let k=Y(d),S=b.path(k,w),D=Y(x),$=b.path(D,w),B=e.insert(()=>S,":first-child");return B.insert(()=>$),B.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&B.selectAll("path").attr("style",u),s&&t.look!=="handDrawn"&&B.selectAll("path").attr("style",s),B.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-(i.width/2)-g-(i.x-(i.left??0))}, ${-(i.height/2)+g-n/2-(i.y-(i.top??0))})`),I(t,B),t.intersect=function(C){return N.polygon(t,d,C)},e})}v($s,"multiWaveEdgedRectangle");function Ds(s,e,i){return R(this,arguments,function*(l,t,{config:{themeVariables:r}}){let{labelStyles:h,nodeStyles:a}=O(t);t.labelStyle=h,t.useHtmlLabels||dt().flowchart?.htmlLabels!==!1||(t.centerLabel=!0);let{shapeSvg:n,bbox:c}=yield q(l,t,G(t)),p=Math.max(c.width+(t.padding??0)*2,t?.width??0),f=Math.max(c.height+(t.padding??0)*2,t?.height??0),g=-p/2,u=-f/2,{cssStyles:y}=t,m=M.svg(n),d=T(t,{fill:r.noteBkgColor,stroke:r.noteBorderColor});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let x=m.rectangle(g,u,p,f,d),b=n.insert(()=>x,":first-child");return b.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",y),a&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",a),I(t,b),t.intersect=function(w){return N.rect(t,w)},n})}v(Ds,"note");var La=v((l,t,r)=>[`M${l+r/2},${t}`,`L${l+r},${t-r/2}`,`L${l+r/2},${t-r}`,`L${l},${t-r/2}`,"Z"].join(" "),"createDecisionBoxPathD");function Ps(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=i.width+t.padding,a=i.height+t.padding,o=h+a,n=[{x:o/2,y:0},{x:o,y:-o/2},{x:o/2,y:-o},{x:0,y:-o/2}],c,{cssStyles:p}=t;if(t.look==="handDrawn"){let f=M.svg(e),g=T(t,{}),u=La(0,0,o),y=f.path(u,g);c=e.insert(()=>y,":first-child").attr("transform",`translate(${-o/2}, ${o/2})`),p&&c.attr("style",p)}else c=gt(e,o,o,n);return s&&c.attr("style",s),I(t,c),t.intersect=function(f){return Z.debug(`APA12 Intersect called SPLIT
point:`,f,`
node:
`,t,`
res:`,N.polygon(t,n,f)),N.polygon(t,n,f)},e})}v(Ps,"question");function Bs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+(t.padding??0),t?.width??0),o=Math.max(i.height+(t.padding??0),t?.height??0),n=-a/2,c=-o/2,p=c/2,f=[{x:n+p,y:c},{x:n,y:0},{x:n+p,y:-c},{x:-n,y:-c},{x:-n,y:c}],{cssStyles:g}=t,u=M.svg(e),y=T(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=Y(f),d=u.path(m,y),x=e.insert(()=>d,":first-child");return x.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",g),s&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",s),x.attr("transform",`translate(${-p/2},0)`),h.attr("transform",`translate(${-p/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),I(t,x),t.intersect=function(b){return N.polygon(t,f,b)},e})}v(Bs,"rect_left_inv_arrow");function Cs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let e;t.cssClasses?e="node "+t.cssClasses:e="node default";let i=l.insert("g").attr("class",e).attr("id",t.domId||t.id),h=i.insert("g"),a=i.insert("g").attr("class","label").attr("style",s),o=t.description,n=t.label,c=a.node().appendChild(yield pe(n,t.labelStyle,!0,!0)),p={width:0,height:0};if(U(K()?.flowchart?.htmlLabels)){let $=c.children[0],B=J(c);p=$.getBoundingClientRect(),B.attr("width",p.width),B.attr("height",p.height)}Z.info("Text 2",o);let f=o||[],g=c.getBBox(),u=a.node().appendChild(yield pe(f.join?f.join("<br/>"):f,t.labelStyle,!0,!0)),y=u.children[0],m=J(u);p=y.getBoundingClientRect(),m.attr("width",p.width),m.attr("height",p.height);let d=(t.padding||0)/2;J(u).attr("transform","translate( "+(p.width>g.width?0:(g.width-p.width)/2)+", "+(g.height+d+5)+")"),J(c).attr("transform","translate( "+(p.width<g.width?0:-(g.width-p.width)/2)+", 0)"),p=a.node().getBBox(),a.attr("transform","translate("+-p.width/2+", "+(-p.height/2-d+3)+")");let x=p.width+(t.padding||0),b=p.height+(t.padding||0),w=-p.width/2-d,k=-p.height/2-d,S,D;if(t.look==="handDrawn"){let $=M.svg(i),B=T(t,{}),C=$.path(ht(w,k,x,b,t.rx||0),B),W=$.line(-p.width/2-d,-p.height/2-d+g.height+d,p.width/2+d,-p.height/2-d+g.height+d,B);D=i.insert(()=>(Z.debug("Rough node insert CXC",C),W),":first-child"),S=i.insert(()=>(Z.debug("Rough node insert CXC",C),C),":first-child")}else S=h.insert("rect",":first-child"),D=h.insert("line"),S.attr("class","outer title-state").attr("style",s).attr("x",-p.width/2-d).attr("y",-p.height/2-d).attr("width",p.width+(t.padding||0)).attr("height",p.height+(t.padding||0)),D.attr("class","divider").attr("x1",-p.width/2-d).attr("x2",p.width/2+d).attr("y1",-p.height/2-d+g.height+d).attr("y2",-p.height/2-d+g.height+d);return I(t,S),t.intersect=function($){return N.rect(t,$)},i})}v(Cs,"rectWithTitle");function Ls(l,t){return R(this,null,function*(){let r={rx:5,ry:5,classes:"",labelPaddingX:(t?.padding||0)*1,labelPaddingY:(t?.padding||0)*1};return Rt(l,t,r)})}v(Ls,"roundedRect");function Rs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=t?.padding??0,o=Math.max(i.width+(t.padding??0)*2,t?.width??0),n=Math.max(i.height+(t.padding??0)*2,t?.height??0),c=-i.width/2-a,p=-i.height/2-a,{cssStyles:f}=t,g=M.svg(e),u=T(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:c,y:p},{x:c+o+8,y:p},{x:c+o+8,y:p+n},{x:c-8,y:p+n},{x:c-8,y:p},{x:c,y:p},{x:c,y:p+n}],m=g.polygon(y.map(x=>[x.x,x.y]),u),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container").attr("style",st(f)),s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),h.attr("transform",`translate(${-o/2+4+(t.padding??0)-(i.x-(i.left??0))},${-n/2+(t.padding??0)-(i.y-(i.top??0))})`),I(t,d),t.intersect=function(x){return N.rect(t,x)},e})}v(Rs,"shadedProcess");function Ns(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=-a/2,c=-o/2,{cssStyles:p}=t,f=M.svg(e),g=T(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=[{x:n,y:c},{x:n,y:c+o},{x:n+a,y:c+o},{x:n+a,y:c-o/2}],y=Y(u),m=f.path(y,g),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",p),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),d.attr("transform",`translate(0, ${o/4})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(i.x-(i.left??0))}, ${-o/4+(t.padding??0)-(i.y-(i.top??0))})`),I(t,d),t.intersect=function(x){return N.polygon(t,u,x)},e})}v(Ns,"slopedRect");function As(l,t){return R(this,null,function*(){let r={rx:0,ry:0,classes:"",labelPaddingX:(t?.padding||0)*2,labelPaddingY:(t?.padding||0)*1};return Rt(l,t,r)})}v(As,"squareRect");function Ws(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=i.height+t.padding,a=i.width+h/4+t.padding,o,{cssStyles:n}=t;if(t.look==="handDrawn"){let c=M.svg(e),p=T(t,{}),f=ht(-a/2,-h/2,a,h,h/2),g=c.path(f,p);o=e.insert(()=>g,":first-child"),o.attr("class","basic label-container").attr("style",st(n))}else o=e.insert("rect",":first-child"),o.attr("class","basic label-container").attr("style",s).attr("rx",h/2).attr("ry",h/2).attr("x",-a/2).attr("y",-h/2).attr("width",a).attr("height",h);return I(t,o),t.intersect=function(c){return N.rect(t,c)},e})}v(Ws,"stadium");function Ts(l,t){return R(this,null,function*(){return Rt(l,t,{rx:5,ry:5,classes:"flowchart-node"})})}v(Ts,"state");function Hs(l,t,{config:{themeVariables:r}}){let{labelStyles:s,nodeStyles:e}=O(t);t.labelStyle=s;let{cssStyles:i}=t,{lineColor:h,stateBorder:a,nodeBorder:o}=r,n=l.insert("g").attr("class","node default").attr("id",t.domId||t.id),c=M.svg(n),p=T(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let f=c.circle(0,0,14,it(et({},p),{stroke:h,strokeWidth:2})),g=a??o,u=c.circle(0,0,5,it(et({},p),{fill:g,stroke:g,strokeWidth:2,fillStyle:"solid"})),y=n.insert(()=>f,":first-child");return y.insert(()=>u),i&&y.selectAll("path").attr("style",i),e&&y.selectAll("path").attr("style",e),I(t,y),t.intersect=function(m){return N.circle(t,7,m)},n}v(Hs,"stateEnd");function Es(l,t,{config:{themeVariables:r}}){let{lineColor:s}=r,e=l.insert("g").attr("class","node default").attr("id",t.domId||t.id),i;if(t.look==="handDrawn"){let a=M.svg(e).circle(0,0,14,ha(s));i=e.insert(()=>a),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=e.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return I(t,i),t.intersect=function(h){return N.circle(t,7,h)},e}v(Es,"stateStart");function Is(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=(t?.padding||0)/2,a=i.width+t.padding,o=i.height+t.padding,n=-i.width/2-h,c=-i.height/2-h,p=[{x:0,y:0},{x:a,y:0},{x:a,y:-o},{x:0,y:-o},{x:0,y:0},{x:-8,y:0},{x:a+8,y:0},{x:a+8,y:-o},{x:-8,y:-o},{x:-8,y:0}];if(t.look==="handDrawn"){let f=M.svg(e),g=T(t,{}),u=f.rectangle(n-8,c,a+16,o,g),y=f.line(n,c,n,c+o,g),m=f.line(n+a,c,n+a,c+o,g);e.insert(()=>y,":first-child"),e.insert(()=>m,":first-child");let d=e.insert(()=>u,":first-child"),{cssStyles:x}=t;d.attr("class","basic label-container").attr("style",st(x)),I(t,d)}else{let f=gt(e,a,o,p);s&&f.attr("style",s),I(t,f)}return t.intersect=function(f){return N.polygon(t,p,f)},e})}v(Is,"subroutine");function Os(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=Math.max(i.width+(t.padding??0)*2,t?.width??0),a=Math.max(i.height+(t.padding??0)*2,t?.height??0),o=-h/2,n=-a/2,c=.2*a,p=.2*a,{cssStyles:f}=t,g=M.svg(e),u=T(t,{}),y=[{x:o-c/2,y:n},{x:o+h+c/2,y:n},{x:o+h+c/2,y:n+a},{x:o-c/2,y:n+a}],m=[{x:o+h-c/2,y:n+a},{x:o+h+c/2,y:n+a},{x:o+h+c/2,y:n+a-p}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=Y(y),x=g.path(d,u),b=Y(m),w=g.path(b,it(et({},u),{fillStyle:"solid"})),k=e.insert(()=>w,":first-child");return k.insert(()=>x,":first-child"),k.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",s),I(t,k),t.intersect=function(S){return N.polygon(t,y,S)},e})}v(Os,"taggedRect");function _s(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=o/4,c=.2*a,p=.2*o,f=o+n,{cssStyles:g}=t,u=M.svg(e),y=T(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=[{x:-a/2-a/2*.1,y:f/2},...ut(-a/2-a/2*.1,f/2,a/2+a/2*.1,f/2,n,.8),{x:a/2+a/2*.1,y:-f/2},{x:-a/2-a/2*.1,y:-f/2}],d=-a/2+a/2*.1,x=-f/2-p*.4,b=[{x:d+a-c,y:(x+o)*1.4},{x:d+a,y:x+o-p},{x:d+a,y:(x+o)*.9},...ut(d+a,(x+o)*1.3,d+a-c,(x+o)*1.5,-o*.03,.5)],w=Y(m),k=u.path(w,y),S=Y(b),D=u.path(S,it(et({},y),{fillStyle:"solid"})),$=e.insert(()=>D,":first-child");return $.insert(()=>k,":first-child"),$.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",g),s&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",s),$.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(i.x-(i.left??0))},${-o/2+(t.padding??0)-n/2-(i.y-(i.top??0))})`),I(t,$),t.intersect=function(B){return N.polygon(t,m,B)},e})}v(_s,"taggedWaveEdgedRectangle");function zs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=Math.max(i.width+t.padding,t?.width||0),a=Math.max(i.height+t.padding,t?.height||0),o=-h/2,n=-a/2,c=e.insert("rect",":first-child");return c.attr("class","text").attr("style",s).attr("rx",0).attr("ry",0).attr("x",o).attr("y",n).attr("width",h).attr("height",a),I(t,c),t.intersect=function(p){return N.rect(t,p)},e})}v(zs,"text");var Ra=v((l,t,r,s,e,i)=>`M${l},${t}
    a${e},${i} 0,0,1 0,${-s}
    l${r},0
    a${e},${i} 0,0,1 0,${s}
    M${r},${-s}
    a${e},${i} 0,0,0 0,${s}
    l${-r},0`,"createCylinderPathD"),Na=v((l,t,r,s,e,i)=>[`M${l},${t}`,`M${l+r},${t}`,`a${e},${i} 0,0,0 0,${-s}`,`l${-r},0`,`a${e},${i} 0,0,0 0,${s}`,`l${r},0`].join(" "),"createOuterCylinderPathD"),Aa=v((l,t,r,s,e,i)=>[`M${l+r/2},${-s/2}`,`a${e},${i} 0,0,0 0,${s}`].join(" "),"createInnerCylinderPathD");function js(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h,halfPadding:a}=yield q(l,t,G(t)),o=t.look==="neo"?a*2:a,n=i.height+o,c=n/2,p=c/(2.5+n/50),f=i.width+p+o,{cssStyles:g}=t,u;if(t.look==="handDrawn"){let y=M.svg(e),m=Na(0,0,f,n,p,c),d=Aa(0,0,f,n,p,c),x=y.path(m,T(t,{})),b=y.path(d,T(t,{fill:"none"}));u=e.insert(()=>b,":first-child"),u=e.insert(()=>x,":first-child"),u.attr("class","basic label-container"),g&&u.attr("style",g)}else{let y=Ra(0,0,f,n,p,c);u=e.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",st(g)).attr("style",s),u.attr("class","basic label-container"),g&&u.selectAll("path").attr("style",g),s&&u.selectAll("path").attr("style",s)}return u.attr("label-offset-x",p),u.attr("transform",`translate(${-f/2}, ${n/2} )`),h.attr("transform",`translate(${-(i.width/2)-p-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),I(t,u),t.intersect=function(y){let m=N.rect(t,y),d=m.y-(t.y??0);if(c!=0&&(Math.abs(d)<(t.height??0)/2||Math.abs(d)==(t.height??0)/2&&Math.abs(m.x-(t.x??0))>(t.width??0)/2-p)){let x=p*p*(1-d*d/(c*c));x!=0&&(x=Math.sqrt(Math.abs(x))),x=p-x,y.x-(t.x??0)>0&&(x=-x),m.x+=x}return m},e})}v(js,"tiltedCylinder");function Gs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=i.width+t.padding,a=i.height+t.padding,o=[{x:-3*a/6,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:0,y:-a}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=M.svg(e),f=T(t,{}),g=Y(o),u=p.path(g,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),c&&n.attr("style",c)}else n=gt(e,h,a,o);return s&&n.attr("style",s),t.width=h,t.height=a,I(t,n),t.intersect=function(p){return N.polygon(t,o,p)},e})}v(Gs,"trapezoid");function Fs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=60,a=20,o=Math.max(h,i.width+(t.padding??0)*2,t?.width??0),n=Math.max(a,i.height+(t.padding??0)*2,t?.height??0),{cssStyles:c}=t,p=M.svg(e),f=T(t,{});t.look!=="handDrawn"&&(f.roughness=0,f.fillStyle="solid");let g=[{x:-o/2*.8,y:-n/2},{x:o/2*.8,y:-n/2},{x:o/2,y:-n/2*.6},{x:o/2,y:n/2},{x:-o/2,y:n/2},{x:-o/2,y:-n/2*.6}],u=Y(g),y=p.path(u,f),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),c&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",c),s&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",s),I(t,m),t.intersect=function(d){return N.polygon(t,g,d)},e})}v(Fs,"trapezoidalPentagon");function qs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=U(K().flowchart?.htmlLabels),o=i.width+(t.padding??0),n=o+i.height,c=o+i.height,p=[{x:0,y:0},{x:c,y:0},{x:c/2,y:-n}],{cssStyles:f}=t,g=M.svg(e),u=T(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=Y(p),m=g.path(y,u),d=e.insert(()=>m,":first-child").attr("transform",`translate(${-n/2}, ${n/2})`);return f&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",f),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),t.width=o,t.height=n,I(t,d),h.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${n/2-(i.height+(t.padding??0)/(a?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(x){return Z.info("Triangle intersect",t,p,x),N.polygon(t,p,x)},e})}v(qs,"triangle");function Xs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=o/8,c=o+n,{cssStyles:p}=t,g=70-a,u=g>0?g/2:0,y=M.svg(e),m=T(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let d=[{x:-a/2-u,y:c/2},...ut(-a/2-u,c/2,a/2+u,c/2,n,.8),{x:a/2+u,y:-c/2},{x:-a/2-u,y:-c/2}],x=Y(d),b=y.path(x,m),w=e.insert(()=>b,":first-child");return w.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",p),s&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",s),w.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(i.x-(i.left??0))},${-o/2+(t.padding??0)-n-(i.y-(i.top??0))})`),I(t,w),t.intersect=function(k){return N.polygon(t,d,k)},e})}v(Xs,"waveEdgedRectangle");function Ys(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield q(l,t,G(t)),h=100,a=50,o=Math.max(i.width+(t.padding??0)*2,t?.width??0),n=Math.max(i.height+(t.padding??0)*2,t?.height??0),c=o/n,p=o,f=n;p>f*c?f=p/c:p=f*c,p=Math.max(p,h),f=Math.max(f,a);let g=Math.min(f*.2,f/4),u=f+g*2,{cssStyles:y}=t,m=M.svg(e),d=T(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let x=[{x:-p/2,y:u/2},...ut(-p/2,u/2,p/2,u/2,g,1),{x:p/2,y:-u/2},...ut(p/2,-u/2,-p/2,-u/2,g,-1)],b=Y(x),w=m.path(b,d),k=e.insert(()=>w,":first-child");return k.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",y),s&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",s),I(t,k),t.intersect=function(S){return N.polygon(t,x,S)},e})}v(Ys,"waveRectangle");function Vs(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield q(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=5,c=-a/2,p=-o/2,{cssStyles:f}=t,g=M.svg(e),u=T(t,{}),y=[{x:c-n,y:p-n},{x:c-n,y:p+o},{x:c+a,y:p+o},{x:c+a,y:p-n}],m=`M${c-n},${p-n} L${c+a},${p-n} L${c+a},${p+o} L${c-n},${p+o} L${c-n},${p-n}
                M${c-n},${p} L${c+a},${p}
                M${c},${p-n} L${c},${p+o}`;t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=g.path(m,u),x=e.insert(()=>d,":first-child");return x.attr("transform",`translate(${n/2}, ${n/2})`),x.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",s),h.attr("transform",`translate(${-(i.width/2)+n/2-(i.x-(i.left??0))}, ${-(i.height/2)+n/2-(i.y-(i.top??0))})`),I(t,x),t.intersect=function(b){return N.polygon(t,y,b)},e})}v(Vs,"windowPane");function de(l,t){return R(this,null,function*(){let r=t;if(r.alias&&(t.label=r.alias),t.look==="handDrawn"){let{themeVariables:P}=dt(),{background:E}=P,z=it(et({},t),{id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${E}`]});yield de(l,z)}let s=dt();t.useHtmlLabels=s.htmlLabels;let e=s.er?.diagramPadding??10,i=s.er?.entityPadding??6,{cssStyles:h}=t,{labelStyles:a}=O(t);if(r.attributes.length===0&&t.label){let P={rx:0,ry:0,labelPaddingX:e,labelPaddingY:e*1.5,classes:""};$t(t.label,s)+P.labelPaddingX*2<s.er.minEntityWidth&&(t.width=s.er.minEntityWidth);let E=yield Rt(l,t,P);if(!U(s.htmlLabels)){let z=E.select("text"),Q=z.node()?.getBBox();z.attr("transform",`translate(${-Q.width/2}, 0)`)}return E}s.htmlLabels||(e*=1.25,i*=1.25);let o=G(t);o||(o="node default");let n=l.insert("g").attr("class",o).attr("id",t.domId||t.id),c=yield wt(n,t.label??"",s,0,0,["name"],a);c.height+=i;let p=0,f=[],g=0,u=0,y=0,m=0,d=!0,x=!0;for(let P of r.attributes){let E=yield wt(n,P.type,s,0,p,["attribute-type"],a);g=Math.max(g,E.width+e);let z=yield wt(n,P.name,s,0,p,["attribute-name"],a);u=Math.max(u,z.width+e);let Q=yield wt(n,P.keys.join(),s,0,p,["attribute-keys"],a);y=Math.max(y,Q.width+e);let rt=yield wt(n,P.comment,s,0,p,["attribute-comment"],a);m=Math.max(m,rt.width+e),p+=Math.max(E.height,z.height,Q.height,rt.height)+i,f.push(p)}f.pop();let b=4;y<=e&&(d=!1,y=0,b--),m<=e&&(x=!1,m=0,b--);let w=n.node().getBBox();if(c.width+e*2-(g+u+y+m)>0){let P=c.width+e*2-(g+u+y+m);g+=P/b,u+=P/b,y>0&&(y+=P/b),m>0&&(m+=P/b)}let k=g+u+y+m,S=M.svg(n),D=T(t,{});t.look!=="handDrawn"&&(D.roughness=0,D.fillStyle="solid");let $=Math.max(w.width+e*2,t?.width||0,k),B=Math.max(w.height+(f[0]||p)+i,t?.height||0),C=-$/2,W=-B/2;n.selectAll("g:not(:first-child)").each((P,E,z)=>{let Q=J(z[E]),rt=Q.attr("transform"),Mt=0,me=0;if(rt){let jt=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(rt);jt&&(Mt=parseFloat(jt[1]),me=parseFloat(jt[2]),Q.attr("class").includes("attribute-name")?Mt+=g:Q.attr("class").includes("attribute-keys")?Mt+=g+u:Q.attr("class").includes("attribute-comment")&&(Mt+=g+u+y))}Q.attr("transform",`translate(${C+e/2+Mt}, ${me+W+c.height+i/2})`)}),n.select(".name").attr("transform","translate("+-c.width/2+", "+(W+i/2)+")");let V=S.rectangle(C,W,$,B,D),X=n.insert(()=>V,":first-child").attr("style",h.join("")),{themeVariables:A}=dt(),{rowEven:_,rowOdd:L,nodeBorder:F}=A;f.push(0);for(let[P,E]of f.entries()){if(P===0&&f.length>1)continue;let z=P%2===0&&E!==0,Q=S.rectangle(C,c.height+W+E,$,c.height,it(et({},D),{fill:z?_:L,stroke:F}));n.insert(()=>Q,"g.label").attr("style",h.join("")).attr("class",`row-rect-${P%2===0?"even":"odd"}`)}let H=S.line(C,c.height+W,$+C,c.height+W,D);n.insert(()=>H).attr("class","divider"),H=S.line(g+C,c.height+W,g+C,B+W,D),n.insert(()=>H).attr("class","divider"),d&&(H=S.line(g+u+C,c.height+W,g+u+C,B+W,D),n.insert(()=>H).attr("class","divider")),x&&(H=S.line(g+u+y+C,c.height+W,g+u+y+C,B+W,D),n.insert(()=>H).attr("class","divider"));for(let P of f)H=S.line(C,c.height+W+P,$+C,c.height+W+P,D),n.insert(()=>H).attr("class","divider");return I(t,X),t.intersect=function(P){return N.rect(t,P)},n})}v(de,"erBox");function wt(a,o,n){return R(this,arguments,function*(l,t,r,s=0,e=0,i=[],h=""){let c=l.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${s}, ${e})`).attr("style",h);t!==Ft(t)&&(t=Ft(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));let p=c.node().appendChild(yield pt(c,t,{width:$t(t,r)+100,style:h,useHtmlLabels:r.htmlLabels},r));if(t.includes("&lt;")||t.includes("&gt;")){let g=p.children[0];for(g.textContent=g.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");g.childNodes[0];)g=g.childNodes[0],g.textContent=g.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let f=p.getBBox();if(U(r.htmlLabels)){let g=p.children[0];g.style.textAlign="start";let u=J(p);f=g.getBoundingClientRect(),u.attr("width",f.width),u.attr("height",f.height)}return f})}v(wt,"addText");function Zs(i,h,a,o){return R(this,arguments,function*(l,t,r,s,e=r.class.padding??12){let n=s?0:3,c=l.insert("g").attr("class",G(t)).attr("id",t.domId||t.id),p=null,f=null,g=null,u=null,y=0,m=0,d=0;if(p=c.insert("g").attr("class","annotation-group text"),t.annotations.length>0){let S=t.annotations[0];yield Lt(p,{text:`\xAB${S}\xBB`},0),y=p.node().getBBox().height}f=c.insert("g").attr("class","label-group text"),yield Lt(f,t,0,["font-weight: bolder"]);let x=f.node().getBBox();m=x.height,g=c.insert("g").attr("class","members-group text");let b=0;for(let S of t.members){let D=yield Lt(g,S,b,[S.parseClassifier()]);b+=D+n}d=g.node().getBBox().height,d<=0&&(d=e/2),u=c.insert("g").attr("class","methods-group text");let w=0;for(let S of t.methods){let D=yield Lt(u,S,w,[S.parseClassifier()]);w+=D+n}let k=c.node().getBBox();if(p!==null){let S=p.node().getBBox();p.attr("transform",`translate(${-S.width/2})`)}return f.attr("transform",`translate(${-x.width/2}, ${y})`),k=c.node().getBBox(),g.attr("transform",`translate(0, ${y+m+e*2})`),k=c.node().getBBox(),u.attr("transform",`translate(0, ${y+m+(d?d+e*4:e*2)})`),k=c.node().getBBox(),{shapeSvg:c,bbox:k}})}v(Zs,"textHelper");function Lt(e,i,h){return R(this,arguments,function*(l,t,r,s=[]){let a=l.insert("g").attr("class","label").attr("style",s.join("; ")),o=dt(),n="useHtmlLabels"in t?t.useHtmlLabels:U(o.htmlLabels)??!0,c="";"text"in t?c=t.text:c=t.label,!n&&c.startsWith("\\")&&(c=c.substring(1)),qt(c)&&(n=!0);let p=yield pt(a,Xt(mt(c)),{width:$t(c,o)+50,classes:"markdown-node-label",useHtmlLabels:n},o),f,g=1;if(n){let u=p.children[0],y=J(p);g=u.innerHTML.split("<br>").length,u.innerHTML.includes("</math>")&&(g+=u.innerHTML.split("<mrow>").length-1);let m=u.getElementsByTagName("img");if(m){let d=c.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...m].map(x=>new Promise(b=>{function w(){if(x.style.display="flex",x.style.flexDirection="column",d){let k=o.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,D=parseInt(k,10)*5+"px";x.style.minWidth=D,x.style.maxWidth=D}else x.style.width="100%";b(x)}v(w,"setupImage"),setTimeout(()=>{x.complete&&w()}),x.addEventListener("error",w),x.addEventListener("load",w)})))}f=u.getBoundingClientRect(),y.attr("width",f.width),y.attr("height",f.height)}else{s.includes("font-weight: bolder")&&J(p).selectAll("tspan").attr("font-weight",""),g=p.children.length;let u=p.children[0];(p.textContent===""||p.textContent.includes("&gt"))&&(u.textContent=c[0]+c.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),c[1]===" "&&(u.textContent=u.textContent[0]+" "+u.textContent.substring(1))),u.textContent==="undefined"&&(u.textContent=""),f=p.getBBox()}return a.attr("transform","translate(0,"+(-f.height/(2*g)+r)+")"),f.height})}v(Lt,"addText");function Qs(l,t){return R(this,null,function*(){let r=K(),s=r.class.padding??12,e=s,i=t.useHtmlLabels??U(r.htmlLabels)??!0,h=t;h.annotations=h.annotations??[],h.members=h.members??[],h.methods=h.methods??[];let{shapeSvg:a,bbox:o}=yield Zs(l,t,r,i,e),{labelStyles:n,nodeStyles:c}=O(t);t.labelStyle=n,t.cssStyles=h.styles||"";let p=h.styles?.join(";")||c||"";t.cssStyles||(t.cssStyles=p.replaceAll("!important","").split(";"));let f=h.members.length===0&&h.methods.length===0&&!r.class?.hideEmptyMembersBox,g=M.svg(a),u=T(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=o.width,m=o.height;h.members.length===0&&h.methods.length===0?m+=e:h.members.length>0&&h.methods.length===0&&(m+=e*2);let d=-y/2,x=-m/2,b=g.rectangle(d-s,x-s-(f?s:h.members.length===0&&h.methods.length===0?-s/2:0),y+2*s,m+2*s+(f?s*2:h.members.length===0&&h.methods.length===0?-s:0),u),w=a.insert(()=>b,":first-child");w.attr("class","basic label-container");let k=w.node().getBBox();a.selectAll(".text").each((B,C,W)=>{let V=J(W[C]),X=V.attr("transform"),A=0;if(X){let H=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(X);H&&(A=parseFloat(H[2]))}let _=A+x+s-(f?s:h.members.length===0&&h.methods.length===0?-s/2:0);i||(_-=4);let L=d;(V.attr("class").includes("label-group")||V.attr("class").includes("annotation-group"))&&(L=-V.node()?.getBBox().width/2||0,a.selectAll("text").each(function(F,H,P){window.getComputedStyle(P[H]).textAnchor==="middle"&&(L=0)})),V.attr("transform",`translate(${L}, ${_})`)});let S=a.select(".annotation-group").node().getBBox().height-(f?s/2:0)||0,D=a.select(".label-group").node().getBBox().height-(f?s/2:0)||0,$=a.select(".members-group").node().getBBox().height-(f?s/2:0)||0;if(h.members.length>0||h.methods.length>0||f){let B=g.line(k.x,S+D+x+s,k.x+k.width,S+D+x+s,u);a.insert(()=>B).attr("class","divider").attr("style",p)}if(f||h.members.length>0||h.methods.length>0){let B=g.line(k.x,S+D+$+x+e*2+s,k.x+k.width,S+D+$+x+s+e*2,u);a.insert(()=>B).attr("class","divider").attr("style",p)}if(h.look!=="handDrawn"&&a.selectAll("path").attr("style",p),w.select(":nth-child(2)").attr("style",p),a.selectAll(".divider").select("path").attr("style",p),t.labelStyle?a.selectAll("span").attr("style",t.labelStyle):a.selectAll("span").attr("style",p),!i){let B=RegExp(/color\s*:\s*([^;]*)/),C=B.exec(p);if(C){let W=C[0].replace("color","fill");a.selectAll("tspan").attr("style",W)}else if(n){let W=B.exec(n);if(W){let V=W[0].replace("color","fill");a.selectAll("tspan").attr("style",V)}}}return I(t,w),t.intersect=function(B){return N.rect(t,B)},a})}v(Qs,"classBox");function Js(l,t){return R(this,null,function*(){let{labelStyles:r,nodeStyles:s}=O(t);t.labelStyle=r;let e=t,i=t,h=20,a=20,o="verifyMethod"in t,n=G(t),c=l.insert("g").attr("class",n).attr("id",t.domId??t.id),p;o?p=yield lt(c,`&lt;&lt;${e.type}&gt;&gt;`,0,t.labelStyle):p=yield lt(c,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let f=p,g=yield lt(c,e.name,f,t.labelStyle+"; font-weight: bold;");if(f+=g+a,o){let S=yield lt(c,`${e.requirementId?`Id: ${e.requirementId}`:""}`,f,t.labelStyle);f+=S;let D=yield lt(c,`${e.text?`Text: ${e.text}`:""}`,f,t.labelStyle);f+=D;let $=yield lt(c,`${e.risk?`Risk: ${e.risk}`:""}`,f,t.labelStyle);f+=$,yield lt(c,`${e.verifyMethod?`Verification: ${e.verifyMethod}`:""}`,f,t.labelStyle)}else{let S=yield lt(c,`${i.type?`Type: ${i.type}`:""}`,f,t.labelStyle);f+=S,yield lt(c,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,f,t.labelStyle)}let u=(c.node()?.getBBox().width??200)+h,y=(c.node()?.getBBox().height??200)+h,m=-u/2,d=-y/2,x=M.svg(c),b=T(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");let w=x.rectangle(m,d,u,y,b),k=c.insert(()=>w,":first-child");if(k.attr("class","basic label-container").attr("style",s),c.selectAll(".label").each((S,D,$)=>{let B=J($[D]),C=B.attr("transform"),W=0,V=0;if(C){let L=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(C);L&&(W=parseFloat(L[1]),V=parseFloat(L[2]))}let X=V-y/2,A=m+h/2;(D===0||D===1)&&(A=W),B.attr("transform",`translate(${A}, ${X+h})`)}),f>p+g+a){let S=x.line(m,d+p+g+a,m+u,d+p+g+a,b);c.insert(()=>S).attr("style",s)}return I(t,k),t.intersect=function(S){return N.rect(t,S)},c})}v(Js,"requirementBox");function lt(l,t,r,s=""){return R(this,null,function*(){if(t==="")return 0;let e=l.insert("g").attr("class","label").attr("style",s),i=K(),h=i.htmlLabels??!0,a=yield pt(e,Xt(mt(t)),{width:$t(t,i)+50,classes:"markdown-node-label",useHtmlLabels:h,style:s},i),o;if(h){let n=a.children[0],c=J(a);o=n.getBoundingClientRect(),c.attr("width",o.width),c.attr("height",o.height)}else{let n=a.children[0];for(let c of n.children)c.textContent=c.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),s&&c.setAttribute("style",s);o=a.getBBox(),o.height+=6}return e.attr("transform",`translate(${-o.width/2},${-o.height/2+r})`),o.height})}v(lt,"addText");var Wa=v(l=>{switch(l){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");function Ks(s,e,i){return R(this,arguments,function*(l,t,{config:r}){let{labelStyles:h,nodeStyles:a}=O(t);t.labelStyle=h||"";let o=10,n=t.width;t.width=(t.width??200)-10;let{shapeSvg:c,bbox:p,label:f}=yield q(l,t,G(t)),g=t.padding||10,u="",y;"ticket"in t&&t.ticket&&r?.kanban?.ticketBaseUrl&&(u=r?.kanban?.ticketBaseUrl.replace("#TICKET#",t.ticket),y=c.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",u).attr("target","_blank"));let m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1},d,x;y?{label:d,bbox:x}=yield ge(y,"ticket"in t&&t.ticket||"",m):{label:d,bbox:x}=yield ge(c,"ticket"in t&&t.ticket||"",m);let{label:b,bbox:w}=yield ge(c,"assigned"in t&&t.assigned||"",m);t.width=n;let k=10,S=t?.width||0,D=Math.max(x.height,w.height)/2,$=Math.max(p.height+k*2,t?.height||0)+D,B=-S/2,C=-$/2;f.attr("transform","translate("+(g-S/2)+", "+(-D-p.height/2)+")"),d.attr("transform","translate("+(g-S/2)+", "+(-D+p.height/2)+")"),b.attr("transform","translate("+(g+S/2-w.width-2*o)+", "+(-D+p.height/2)+")");let W,{rx:V,ry:X}=t,{cssStyles:A}=t;if(t.look==="handDrawn"){let _=M.svg(c),L=T(t,{}),F=V||X?_.path(ht(B,C,S,$,V||0),L):_.rectangle(B,C,S,$,L);W=c.insert(()=>F,":first-child"),W.attr("class","basic label-container").attr("style",A||null)}else{W=c.insert("rect",":first-child"),W.attr("class","basic label-container __APA__").attr("style",a).attr("rx",V??5).attr("ry",X??5).attr("x",B).attr("y",C).attr("width",S).attr("height",$);let _="priority"in t&&t.priority;if(_){let L=c.append("line"),F=B+2,H=C+Math.floor((V??0)/2),P=C+$-Math.floor((V??0)/2);L.attr("x1",F).attr("y1",H).attr("x2",F).attr("y2",P).attr("stroke-width","4").attr("stroke",Wa(_))}}return I(t,W),t.height=$,t.intersect=function(_){return N.rect(t,_)},c})}v(Ks,"kanbanItem");var Ta=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:As},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Ls},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Ws},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Is},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:as},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:Qe},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Ps},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:hs},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:ws},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:bs},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Gs},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:ms},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:is},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:zs},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:Ve},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Rs},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:Es},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:Hs},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:cs},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:gs},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:Ue},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:ts},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:es},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Ss},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:Xs},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:os},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:js},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:vs},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:ss},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:rs},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:qs},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:Vs},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:ns},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:Fs},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:ls},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Ns},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:$s},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:ks},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:Ye},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:Ke},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:_s},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Os},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:Ys},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Bs},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Ms}],Ha=v(()=>{let t=[...Object.entries({state:Ts,choice:Ze,note:Ds,rectWithTitle:Cs,labelRect:xs,iconSquare:ys,iconCircle:fs,icon:ps,iconRounded:us,imageSquare:ds,anchor:Xe,kanbanItem:Ks,classBox:Qs,erBox:de,requirementBox:Js}),...Ta.flatMap(r=>[r.shortName,..."aliases"in r?r.aliases:[],..."internalAliases"in r?r.internalAliases:[]].map(e=>[e,r.handler]))];return Object.fromEntries(t)},"generateShapeMap"),Us=Ha();function Ea(l){return l in Us}v(Ea,"isValidShape");var zt=new Map;function Ia(l,t,r){return R(this,null,function*(){let s,e;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");let i=t.shape?Us[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let h;r.config.securityLevel==="sandbox"?h="_top":t.linkTarget&&(h=t.linkTarget||"_blank"),s=l.insert("svg:a").attr("xlink:href",t.link).attr("target",h??null),e=yield i(s,t,r)}else e=yield i(l,t,r),s=e;return t.tooltip&&e.attr("title",t.tooltip),zt.set(t.id,s),t.haveCallback&&s.attr("class",s.attr("class")+" clickable"),s})}v(Ia,"insertNode");var ii=v((l,t)=>{zt.set(t.id,l)},"setNodeElem"),ni=v(()=>{zt.clear()},"clear"),li=v(l=>{let t=zt.get(l.id);Z.trace("Transforming node",l.diff,l,"translate("+(l.x-l.width/2-5)+", "+l.width/2+")");let r=8,s=l.diff||0;return l.clusterNode?t.attr("transform","translate("+(l.x+s-l.width/2)+", "+(l.y-l.height/2-r)+")"):t.attr("transform","translate("+l.x+", "+l.y+")"),s},"positionNode");export{M as a,q as b,I as c,pe as d,pa as e,Qa as f,Ja as g,Ea as h,Ia as i,ii as j,ni as k,li as l};
