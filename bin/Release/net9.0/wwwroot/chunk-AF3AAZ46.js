import{Ca as U,Ec as ue,Gb as Ie,Gc as Ue,Hc as ze,Ib as Te,Mb as he,Pc as Fe,Ra as Ce,Sa as P,Ta as Pe,Ub as Re,Vb as De,Zb as Oe,a as x,ac as z,b as _,cc as Le,dc as Ne,ec as je,fc as F,gc as W,hc as Be,id as We,jd as I,ma as ve,pa as ke,sa as B,sc as G,ub as D,yb as Ae,zb as le}from"./chunk-LANYA5T4.js";var O=(n,e)=>n.push.apply(n,e),v=n=>n.sort((e,t)=>e.i-t.i||e.j-t.j),de=n=>{let e={},t=1;return n.forEach(s=>{e[s]=t,t+=1}),e};var Ge={4:[[1,2],[2,3]],5:[[1,3],[2,3],[2,4]],6:[[1,2],[2,4],[4,5]],7:[[1,3],[2,3],[4,5],[4,6]],8:[[2,4],[4,6]]};var fe=2050,me=1e3,Ye=Ge,He=10,qe=1e4,Y=10,H=50,q=20,V=/^[A-Z\xbf-\xdf][^A-Z\xbf-\xdf]+$/,Ve=/^[^A-Z\xbf-\xdf]+[A-Z\xbf-\xdf]$/,$e=/^[A-Z\xbf-\xdf]+$/,$=/^[^a-z\xdf-\xff]+$/,Xe=/^[a-z\xdf-\xff]+$/,Ze=/^[^A-Z\xbf-\xdf]+$/,Ke=/[a-z\xdf-\xff]/,Qe=/[A-Z\xbf-\xdf]/,Je=/[^A-Za-z\xbf-\xdf]/gi,et=/^\d+$/,T=new Date().getFullYear(),tt={recentYear:/19\d\d|200\d|201\d|202\d/g},pe=[" ",",",";",":","|","/","\\","_",".","-"],st=pe.length;var X=class{match({password:e}){let t=[...this.getMatchesWithoutSeparator(e),...this.getMatchesWithSeparator(e)],s=this.filterNoise(t);return v(s)}getMatchesWithSeparator(e){let t=[],s=/^(\d{1,4})([\s/\\_.-])(\d{1,2})\2(\d{1,4})$/;for(let r=0;r<=Math.abs(e.length-6);r+=1)for(let o=r+5;o<=r+9&&!(o>=e.length);o+=1){let a=e.slice(r,+o+1||9e9),i=s.exec(a);if(i!=null){let c=this.mapIntegersToDayMonthYear([parseInt(i[1],10),parseInt(i[3],10),parseInt(i[4],10)]);c!=null&&t.push({pattern:"date",token:a,i:r,j:o,separator:i[2],year:c.year,month:c.month,day:c.day})}}return t}getMatchesWithoutSeparator(e){let t=[],s=/^\d{4,8}$/,r=o=>Math.abs(o.year-T);for(let o=0;o<=Math.abs(e.length-4);o+=1)for(let a=o+3;a<=o+7&&!(a>=e.length);a+=1){let i=e.slice(o,+a+1||9e9);if(s.exec(i)){let c=[],h=i.length;if(Ye[h].forEach(([f,p])=>{let g=this.mapIntegersToDayMonthYear([parseInt(i.slice(0,f),10),parseInt(i.slice(f,p),10),parseInt(i.slice(p),10)]);g!=null&&c.push(g)}),c.length>0){let f=c[0],p=r(c[0]);c.slice(1).forEach(g=>{let d=r(g);d<p&&(f=g,p=d)}),t.push({pattern:"date",token:i,i:o,j:a,separator:"",year:f.year,month:f.month,day:f.day})}}}return t}filterNoise(e){return e.filter(t=>{let s=!1,r=e.length;for(let o=0;o<r;o+=1){let a=e[o];if(t!==a&&a.i<=t.i&&a.j>=t.j){s=!0;break}}return!s})}mapIntegersToDayMonthYear(e){if(e[1]>31||e[1]<=0)return null;let t=0,s=0,r=0;for(let o=0,a=e.length;o<a;o+=1){let i=e[o];if(i>99&&i<me||i>fe)return null;i>31&&(s+=1),i>12&&(t+=1),i<=0&&(r+=1)}return s>=2||t===3||r>=2?null:this.getDayMonth(e)}getDayMonth(e){let t=[[e[2],e.slice(0,2)],[e[0],e.slice(1,3)]],s=t.length;for(let r=0;r<s;r+=1){let[o,a]=t[r];if(me<=o&&o<=fe){let i=this.mapIntegersToDayMonth(a);return i!=null?{year:o,month:i.month,day:i.day}:null}}for(let r=0;r<s;r+=1){let[o,a]=t[r],i=this.mapIntegersToDayMonth(a);if(i!=null)return{year:this.twoToFourDigitYear(o),month:i.month,day:i.day}}return null}mapIntegersToDayMonth(e){let t=[e,e.slice().reverse()];for(let s=0;s<t.length;s+=1){let r=t[s],o=r[0],a=r[1];if(o>=1&&o<=31&&a>=1&&a<=12)return{day:o,month:a}}return null}twoToFourDigitYear(e){return e>99?e:e>50?e+1900:e+2e3}};var A=new Uint32Array(65536),Bt=(n,e)=>{let t=n.length,s=e.length,r=1<<t-1,o=-1,a=0,i=t,c=t;for(;c--;)A[n.charCodeAt(c)]|=1<<c;for(c=0;c<s;c++){let h=A[e.charCodeAt(c)],u=h|a;h|=(h&o)+o^o,a|=~(h|o),o&=h,a&r&&i++,o&r&&i--,a=a<<1|1,o=o<<1|~(u|a),a&=u}for(c=t;c--;)A[n.charCodeAt(c)]=0;return i},Ut=(n,e)=>{let t=e.length,s=n.length,r=[],o=[],a=Math.ceil(t/32),i=Math.ceil(s/32);for(let d=0;d<a;d++)o[d]=-1,r[d]=0;let c=0;for(;c<i-1;c++){let d=0,b=-1,k=c*32,M=Math.min(32,s)+k;for(let m=k;m<M;m++)A[n.charCodeAt(m)]|=1<<m;for(let m=0;m<t;m++){let w=A[e.charCodeAt(m)],S=o[m/32|0]>>>m&1,C=r[m/32|0]>>>m&1,we=w|d,_e=((w|C)&b)+b^b|w|C,R=d|~(_e|b),j=b&_e;R>>>31^S&&(o[m/32|0]^=1<<m),j>>>31^C&&(r[m/32|0]^=1<<m),R=R<<1|S,j=j<<1|C,b=j|~(we|R),d=R&we}for(let m=k;m<M;m++)A[n.charCodeAt(m)]=0}let h=0,u=-1,f=c*32,p=Math.min(32,s-f)+f;for(let d=f;d<p;d++)A[n.charCodeAt(d)]|=1<<d;let g=s;for(let d=0;d<t;d++){let b=A[e.charCodeAt(d)],k=o[d/32|0]>>>d&1,M=r[d/32|0]>>>d&1,m=b|h,w=((b|M)&u)+u^u|b|M,S=h|~(w|u),C=u&w;g+=S>>>s-1&1,g-=C>>>s-1&1,S>>>31^k&&(o[d/32|0]^=1<<d),C>>>31^M&&(r[d/32|0]^=1<<d),S=S<<1|k,C=C<<1|M,u=C|~(m|S),h=S&m}for(let d=f;d<p;d++)A[n.charCodeAt(d)]=0;return g},rt=(n,e)=>{if(n.length<e.length){let t=e;e=n,n=t}return e.length===0?n.length:n.length<=32?Bt(n,e):Ut(n,e)};var zt=(n,e,t)=>{let s=n.length<=e.length,r=n.length<=t;return s||r?Math.ceil(n.length/4):t},nt=(n,e,t)=>{let s=0,r=Object.keys(e).find(o=>{let a=zt(n,o,t);if(Math.abs(n.length-o.length)>a)return!1;let i=rt(n,o),c=i<=a;return c&&(s=i),c});return r?{levenshteinDistance:s,levenshteinDistanceEntry:r}:{}};var ge={a:["4","@"],b:["8"],c:["(","{","[","<"],d:["6","|)"],e:["3"],f:["#"],g:["6","9","&"],h:["#","|-|"],i:["1","!","|"],k:["<","|<"],l:["!","1","|","7"],m:["^^","nn","2n","/\\\\/\\\\"],n:["//"],o:["0","()"],q:["9"],u:["|_|"],s:["$","5"],t:["+","7"],v:["<",">","/"],w:["^/","uu","vv","2u","2v","\\\\/\\\\/"],x:["%","><"],z:["2"]};var Z={warnings:{straightRow:"straightRow",keyPattern:"keyPattern",simpleRepeat:"simpleRepeat",extendedRepeat:"extendedRepeat",sequences:"sequences",recentYears:"recentYears",dates:"dates",topTen:"topTen",topHundred:"topHundred",common:"common",similarToCommon:"similarToCommon",wordByItself:"wordByItself",namesByThemselves:"namesByThemselves",commonNames:"commonNames",userInputs:"userInputs",pwned:"pwned"},suggestions:{l33t:"l33t",reverseWords:"reverseWords",allUppercase:"allUppercase",capitalization:"capitalization",dates:"dates",recentYears:"recentYears",associatedYears:"associatedYears",sequences:"sequences",repeated:"repeated",longerKeyboardPattern:"longerKeyboardPattern",anotherWord:"anotherWord",useWords:"useWords",noNeed:"noNeed",pwned:"pwned"},timeEstimation:{ltSecond:"ltSecond",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",month:"month",months:"months",year:"year",years:"years",centuries:"centuries"}};var L=class n{constructor(e=[]){this.parents=e,this.children=new Map}addSub(e,...t){let s=e.charAt(0);this.children.has(s)||this.children.set(s,new n([...this.parents,s]));let r=this.children.get(s);for(let o=1;o<e.length;o+=1){let a=e.charAt(o);r.hasChild(a)||r.addChild(a),r=r.getChild(a)}return r.subs=(r.subs||[]).concat(t),this}getChild(e){return this.children.get(e)}isTerminal(){return!!this.subs}addChild(e){this.hasChild(e)||this.children.set(e,new n([...this.parents,e]))}hasChild(e){return this.children.has(e)}};var be=(n,e)=>(Object.entries(n).forEach(([t,s])=>{s.forEach(r=>{e.addSub(r,t)})}),e);var K=class{constructor(){this.matchers={},this.l33tTable=ge,this.trieNodeRoot=be(ge,new L),this.dictionary={userInputs:[]},this.rankedDictionaries={},this.rankedDictionariesMaxWordSize={},this.translations=Z,this.graphs={},this.useLevenshteinDistance=!1,this.levenshteinThreshold=2,this.l33tMaxSubstitutions=100,this.maxLength=256,this.setRankedDictionaries()}setOptions(e={}){e.l33tTable&&(this.l33tTable=e.l33tTable,this.trieNodeRoot=be(e.l33tTable,new L)),e.dictionary&&(this.dictionary=e.dictionary,this.setRankedDictionaries()),e.translations&&this.setTranslations(e.translations),e.graphs&&(this.graphs=e.graphs),e.useLevenshteinDistance!==void 0&&(this.useLevenshteinDistance=e.useLevenshteinDistance),e.levenshteinThreshold!==void 0&&(this.levenshteinThreshold=e.levenshteinThreshold),e.l33tMaxSubstitutions!==void 0&&(this.l33tMaxSubstitutions=e.l33tMaxSubstitutions),e.maxLength!==void 0&&(this.maxLength=e.maxLength)}setTranslations(e){if(this.checkCustomTranslations(e))this.translations=e;else throw new Error("Invalid translations object fallback to keys")}checkCustomTranslations(e){let t=!0;return Object.keys(Z).forEach(s=>{if(s in e){let r=s;Object.keys(Z[r]).forEach(o=>{o in e[r]||(t=!1)})}else t=!1}),t}setRankedDictionaries(){let e={},t={};Object.keys(this.dictionary).forEach(s=>{e[s]=de(this.dictionary[s]),t[s]=this.getRankedDictionariesMaxWordSize(this.dictionary[s])}),this.rankedDictionaries=e,this.rankedDictionariesMaxWordSize=t}getRankedDictionariesMaxWordSize(e){let t=e.map(s=>typeof s!="string"?s.toString().length:s.length);return t.length===0?0:t.reduce((s,r)=>Math.max(s,r),-1/0)}buildSanitizedRankedDictionary(e){let t=[];return e.forEach(s=>{let r=typeof s;(r==="string"||r==="number"||r==="boolean")&&t.push(s.toString().toLowerCase())}),de(t)}extendUserInputsDictionary(e){this.dictionary.userInputs||(this.dictionary.userInputs=[]);let t=[...this.dictionary.userInputs,...e];this.rankedDictionaries.userInputs=this.buildSanitizedRankedDictionary(t),this.rankedDictionariesMaxWordSize.userInputs=this.getRankedDictionariesMaxWordSize(t)}addMatcher(e,t){this.matchers[e]?console.info(`Matcher ${e} already exists`):this.matchers[e]=t}},l=new K;var Q=class{constructor(e){this.defaultMatch=e}match({password:e}){let t=e.split("").reverse().join("");return this.defaultMatch({password:t}).map(s=>_(x({},s),{token:s.token.split("").reverse().join(""),reversed:!0,i:e.length-1-s.j,j:e.length-1-s.i}))}};var xe=class{constructor({substr:e,limit:t,trieRoot:s}){this.buffer=[],this.finalPasswords=[],this.substr=e,this.limit=t,this.trieRoot=s}getAllPossibleSubsAtIndex(e){let t=[],s=this.trieRoot;for(let r=e;r<this.substr.length;r+=1){let o=this.substr.charAt(r);if(s=s.getChild(o),!s)break;t.push(s)}return t}helper({onlyFullSub:e,isFullSub:t,index:s,subIndex:r,changes:o,lastSubLetter:a,consecutiveSubCount:i}){if(this.finalPasswords.length>=this.limit)return;if(s===this.substr.length){e===t&&this.finalPasswords.push({password:this.buffer.join(""),changes:o});return}let c=[...this.getAllPossibleSubsAtIndex(s)],h=!1;for(let u=s+c.length-1;u>=s;u-=1){let f=c[u-s];if(f.isTerminal()){if(a===f.parents.join("")&&i>=3)continue;h=!0;let p=f.subs;for(let g of p){this.buffer.push(g);let d=o.concat({i:r,letter:g,substitution:f.parents.join("")});if(this.helper({onlyFullSub:e,isFullSub:t,index:u+1,subIndex:r+g.length,changes:d,lastSubLetter:f.parents.join(""),consecutiveSubCount:a===f.parents.join("")?i+1:1}),this.buffer.pop(),this.finalPasswords.length>=this.limit)return}}}if(!e||!h){let u=this.substr.charAt(s);this.buffer.push(u),this.helper({onlyFullSub:e,isFullSub:t&&!h,index:s+1,subIndex:r+1,changes:o,lastSubLetter:a,consecutiveSubCount:i}),this.buffer.pop()}}getAll(){return this.helper({onlyFullSub:!0,isFullSub:!0,index:0,subIndex:0,changes:[],lastSubLetter:void 0,consecutiveSubCount:0}),this.helper({onlyFullSub:!1,isFullSub:!0,index:0,subIndex:0,changes:[],lastSubLetter:void 0,consecutiveSubCount:0}),this.finalPasswords}},ot=(n,e,t)=>new xe({substr:n,limit:e,trieRoot:t}).getAll();var Ft=(n,e,t)=>{let r=n.changes.filter(h=>h.i<e).reduce((h,u)=>h-u.letter.length+u.substitution.length,e),o=n.changes.filter(h=>h.i>=e&&h.i<=t),a=o.reduce((h,u)=>h-u.letter.length+u.substitution.length,t-e+r),i=[],c=[];return o.forEach(h=>{i.findIndex(f=>f.letter===h.letter&&f.substitution===h.substitution)<0&&(i.push({letter:h.letter,substitution:h.substitution}),c.push(`${h.substitution} -> ${h.letter}`))}),{i:r,j:a,subs:i,subDisplay:c.join(", ")}},J=class{constructor(e){this.defaultMatch=e}isAlreadyIncluded(e,t){return e.some(s=>Object.entries(s).every(([r,o])=>r==="subs"||o===t[r]))}match({password:e}){let t=[],s=ot(e,l.l33tMaxSubstitutions,l.trieNodeRoot),r=!1,o=!0;return s.forEach(a=>{if(r)return;let i=this.defaultMatch({password:a.password,useLevenshtein:o});o=!1,i.forEach(c=>{r||(r=c.i===0&&c.j===e.length-1);let h=Ft(a,c.i,c.j),u=e.slice(h.i,+h.j+1||9e9),f=x(_(x({},c),{l33t:!0,token:u}),h),p=this.isAlreadyIncluded(t,f);u.toLowerCase()!==c.matchedWord&&!p&&t.push(f)})}),t.filter(a=>a.token.length>1)}};var ee=class{constructor(){this.l33t=new J(this.defaultMatch),this.reverse=new Q(this.defaultMatch)}match({password:e}){let t=[...this.defaultMatch({password:e}),...this.reverse.match({password:e}),...this.l33t.match({password:e})];return v(t)}defaultMatch({password:e,useLevenshtein:t=!0}){let s=[],r=e.length,o=e.toLowerCase();return Object.keys(l.rankedDictionaries).forEach(a=>{let i=l.rankedDictionaries[a],c=l.rankedDictionariesMaxWordSize[a],h=Math.min(c,r);for(let u=0;u<r;u+=1){let f=Math.min(u+h,r);for(let p=u;p<f;p+=1){let g=o.slice(u,+p+1||9e9),d=g in i,b={},k=u===0&&p===r-1;l.useLevenshteinDistance&&k&&!d&&t&&(b=nt(g,i,l.levenshteinThreshold));let M=Object.keys(b).length!==0;if(d||M){let m=M?b.levenshteinDistanceEntry:g,w=i[m];s.push(x({pattern:"dictionary",i:u,j:p,token:e.slice(u,+p+1||9e9),matchedWord:g,rank:w,dictionaryName:a,reversed:!1,l33t:!1},b))}}}}),s}};var te=class{match({password:e,regexes:t=tt}){let s=[];return Object.keys(t).forEach(r=>{let o=t[r];o.lastIndex=0;let a;for(;a=o.exec(e);)if(a){let i=a[0];s.push({pattern:"regex",token:i,i:a.index,j:a.index+a[0].length-1,regexName:r,regexMatch:a})}}),v(s)}};var E={nCk(n,e){let t=n;if(e>t)return 0;if(e===0)return 1;let s=1;for(let r=1;r<=e;r+=1)s*=t,s/=r,t-=1;return s},log10(n){return n===0?0:Math.log(n)/Math.log(10)},log2(n){return Math.log(n)/Math.log(2)},factorial(n){let e=1;for(let t=2;t<=n;t+=1)e*=t;return e}};var at=({token:n})=>{let e=He**n.length;e===Number.POSITIVE_INFINITY&&(e=Number.MAX_VALUE);let t;return n.length===1?t=Y+1:t=H+1,Math.max(e,t)};var it=({year:n,separator:e})=>{let s=Math.max(Math.abs(n-T),q)*365;return e&&(s*=4),s};var Wt=n=>{let e=n.split(""),t=e.filter(a=>a.match(Qe)).length,s=e.filter(a=>a.match(Ke)).length,r=0,o=Math.min(t,s);for(let a=1;a<=o;a+=1)r+=E.nCk(t+s,a);return r},ct=n=>{let e=n.replace(Je,"");if(e.match(Ze)||e.toLowerCase()===e)return 1;let t=[V,Ve,$],s=t.length;for(let r=0;r<s;r+=1){let o=t[r];if(e.match(o))return 2}return Wt(e)};var lt=(n,e)=>{let t=0,s=n.indexOf(e);for(;s>=0;)t+=1,s=n.indexOf(e,s+e.length);return t},Gt=({sub:n,token:e})=>{let t=e.toLowerCase(),s=lt(t,n.substitution),r=lt(t,n.letter);return{subbedCount:s,unsubbedCount:r}},ht=({l33t:n,subs:e,token:t})=>{if(!n)return 1;let s=1;return e.forEach(r=>{let{subbedCount:o,unsubbedCount:a}=Gt({sub:r,token:t});if(o===0||a===0)s*=2;else{let i=Math.min(a,o),c=0;for(let h=1;h<=i;h+=1)c+=E.nCk(a+o,h);s*=c}}),s};var ut=({rank:n,reversed:e,l33t:t,subs:s,token:r,dictionaryName:o})=>{let a=n,i=ct(r),c=ht({l33t:t,subs:s,token:r}),h=e&&2||1,u;return o==="diceware"?u=6**5/2:u=a*i*c*h,{baseGuesses:a,uppercaseVariations:i,l33tVariations:c,calculation:u}};var dt=({regexName:n,regexMatch:e,token:t})=>{let s={alphaLower:26,alphaUpper:26,alpha:52,alphanumeric:62,digits:10,symbols:33};if(n in s)return s[n]**t.length;switch(n){case"recentYear":return Math.max(Math.abs(parseInt(e[0],10)-T),q)}return 0};var ft=({baseGuesses:n,repeatCount:e})=>n*e;var mt=({token:n,ascending:e})=>{let t=n.charAt(0),s=0;return["a","A","z","Z","0","1","9"].includes(t)?s=4:t.match(/\d/)?s=10:s=26,e||(s*=2),s*n.length};var Yt=n=>{let e=0;return Object.keys(n).forEach(t=>{let s=n[t];e+=s.filter(r=>!!r).length}),e/=Object.entries(n).length,e},Ht=({token:n,graph:e,turns:t})=>{let s=Object.keys(l.graphs[e]).length,r=Yt(l.graphs[e]),o=0,a=n.length;for(let i=2;i<=a;i+=1){let c=Math.min(t,i-1);for(let h=1;h<=c;h+=1)o+=E.nCk(i-1,h-1)*s*r**h}return o},pt=({graph:n,token:e,shiftedCount:t,turns:s})=>{let r=Ht({token:e,graph:n,turns:s});if(t){let o=e.length-t;if(t===0||o===0)r*=2;else{let a=0;for(let i=1;i<=Math.min(t,o);i+=1)a+=E.nCk(t+o,i);r*=a}}return Math.round(r)};var gt=()=>st;var qt=(n,e)=>{let t=1;return n.token.length<e.length&&(n.token.length===1?t=Y:t=H),t},bt={bruteforce:at,date:it,dictionary:ut,regex:dt,repeat:ft,sequence:mt,spatial:pt,separator:gt},Vt=(n,e)=>bt[n]?bt[n](e):l.matchers[n]&&"scoring"in l.matchers[n]?l.matchers[n].scoring(e):0,xt=(n,e)=>{let t={};if("guesses"in n&&n.guesses!=null)return n;let s=qt(n,e),r=Vt(n.pattern,n),o=0;typeof r=="number"?o=r:n.pattern==="dictionary"&&(o=r.calculation,t.baseGuesses=r.baseGuesses,t.uppercaseVariations=r.uppercaseVariations,t.l33tVariations=r.l33tVariations);let a=Math.max(o,s);return _(x(x({},n),t),{guesses:a,guessesLog10:E.log10(a)})};var y={password:"",optimal:{},excludeAdditive:!1,separatorRegex:void 0,fillArray(n,e){let t=[];for(let s=0;s<n;s+=1){let r=[];e==="object"&&(r={}),t.push(r)}return t},makeBruteforceMatch(n,e){return{pattern:"bruteforce",token:this.password.slice(n,+e+1||9e9),i:n,j:e}},update(n,e){let t=n.j,s=xt(n,this.password),r=s.guesses;e>1&&(r*=this.optimal.pi[s.i-1][e-1]);let o=E.factorial(e)*r;this.excludeAdditive||(o+=qe**(e-1));let a=!1;Object.keys(this.optimal.g[t]).forEach(i=>{let c=this.optimal.g[t][i];parseInt(i,10)<=e&&c<=o&&(a=!0)}),a||(this.optimal.g[t][e]=o,this.optimal.m[t][e]=s,this.optimal.pi[t][e]=r)},bruteforceUpdate(n){let e=this.makeBruteforceMatch(0,n);this.update(e,1);for(let t=1;t<=n;t+=1){e=this.makeBruteforceMatch(t,n);let s=this.optimal.m[t-1];Object.keys(s).forEach(r=>{s[r].pattern!=="bruteforce"&&this.update(e,parseInt(r,10)+1)})}},unwind(n){let e=[],t=n-1,s=0,r=1/0,o=this.optimal.g[t];for(o&&Object.keys(o).forEach(a=>{let i=o[a];i<r&&(s=parseInt(a,10),r=i)});t>=0;){let a=this.optimal.m[t][s];e.unshift(a),t=a.i-1,s-=1}return e}},N={mostGuessableMatchSequence(n,e,t=!1){y.password=n,y.excludeAdditive=t;let s=n.length,r=y.fillArray(s,"array");e.forEach(c=>{r[c.j].push(c)}),r=r.map(c=>c.sort((h,u)=>h.i-u.i)),y.optimal={m:y.fillArray(s,"object"),pi:y.fillArray(s,"object"),g:y.fillArray(s,"object")};for(let c=0;c<s;c+=1)r[c].forEach(h=>{h.i>0?Object.keys(y.optimal.m[h.i-1]).forEach(u=>{y.update(h,parseInt(u,10)+1)}):y.update(h,1)}),y.bruteforceUpdate(c);let o=y.unwind(s),a=o.length,i=this.getGuesses(n,a);return{password:n,guesses:i,guessesLog10:E.log10(i),sequence:o}},getGuesses(n,e){let t=n.length,s=0;return n.length===0?s=1:s=y.optimal.g[t-1][e],s}};var se=class{match({password:e,omniMatch:t}){let s=[],r=0;for(;r<e.length;){let a=this.getGreedyMatch(e,r),i=this.getLazyMatch(e,r);if(a==null)break;let{match:c,baseToken:h}=this.setMatchToken(a,i);if(c){let u=c.index+c[0].length-1,f=this.getBaseGuesses(h,t);s.push(this.normalizeMatch(h,u,c,f)),r=u+1}}return s.some(a=>a instanceof Promise)?Promise.all(s):s}normalizeMatch(e,t,s,r){let o={pattern:"repeat",i:s.index,j:t,token:s[0],baseToken:e,baseGuesses:0,repeatCount:s[0].length/e.length};return r instanceof Promise?r.then(a=>_(x({},o),{baseGuesses:a})):_(x({},o),{baseGuesses:r})}getGreedyMatch(e,t){let s=/(.+)\1+/g;return s.lastIndex=t,s.exec(e)}getLazyMatch(e,t){let s=/(.+?)\1+/g;return s.lastIndex=t,s.exec(e)}setMatchToken(e,t){let s=/^(.+?)\1+$/,r,o="";if(t&&e[0].length>t[0].length){r=e;let a=s.exec(r[0]);a&&(o=a[1])}else r=t,r&&(o=r[1]);return{match:r,baseToken:o}}getBaseGuesses(e,t){let s=t.match(e);return s instanceof Promise?s.then(o=>N.mostGuessableMatchSequence(e,o).guesses):N.mostGuessableMatchSequence(e,s).guesses}};var re=class{constructor(){this.MAX_DELTA=5}match({password:e}){let t=[];if(e.length===1)return[];let s=0,r=null,o=e.length;for(let a=1;a<o;a+=1){let i=e.charCodeAt(a)-e.charCodeAt(a-1);if(r==null&&(r=i),i!==r){let c=a-1;this.update({i:s,j:c,delta:r,password:e,result:t}),s=c,r=i}}return this.update({i:s,j:o-1,delta:r,password:e,result:t}),t}update({i:e,j:t,delta:s,password:r,result:o}){if(t-e>1||Math.abs(s)===1){let a=Math.abs(s);if(a>0&&a<=this.MAX_DELTA){let i=r.slice(e,+t+1||9e9),{sequenceName:c,sequenceSpace:h}=this.getSequence(i);return o.push({pattern:"sequence",i:e,j:t,token:r.slice(e,+t+1||9e9),sequenceName:c,sequenceSpace:h,ascending:s>0})}}return null}getSequence(e){let t="unicode",s=26;return Xe.test(e)?(t="lower",s=26):$e.test(e)?(t="upper",s=26):et.test(e)&&(t="digits",s=10),{sequenceName:t,sequenceSpace:s}}};var ne=class{constructor(){this.SHIFTED_RX=/[~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?]/}match({password:e}){let t=[];return Object.keys(l.graphs).forEach(s=>{let r=l.graphs[s];O(t,this.helper(e,r,s))}),v(t)}checkIfShifted(e,t,s){return!e.includes("keypad")&&this.SHIFTED_RX.test(t.charAt(s))?1:0}helper(e,t,s){let r,o=[],a=0,i=e.length;for(;a<i-1;){let c=a+1,h=null,u=0;for(r=this.checkIfShifted(s,e,a);;){let f=e.charAt(c-1),p=t[f]||[],g=!1,d=-1,b=-1;if(c<i){let k=e.charAt(c),M=p.length;for(let m=0;m<M;m+=1){let w=p[m];if(b+=1,w){let S=w.indexOf(k);if(S!==-1){g=!0,d=b,S===1&&(r+=1),h!==d&&(u+=1,h=d);break}}}}if(g)c+=1;else{c-a>2&&o.push({pattern:"spatial",i:a,j:c-1,token:e.slice(a,c),graph:s,turns:u,shiftedCount:r}),a=c;break}}}return o}};var $t=new RegExp(`[${pe.join("")}]`),oe=class n{static getMostUsedSeparatorChar(e){let t=[...e.split("").filter(r=>$t.test(r)).reduce((r,o)=>{let a=r.get(o);return a?r.set(o,a+1):r.set(o,1),r},new Map).entries()].sort(([r,o],[a,i])=>i-o);if(!t.length)return;let s=t[0];if(!(s[1]<2))return s[0]}static getSeparatorRegex(e){return new RegExp(`([^${e}
])(${e})(?!${e})`,"g")}match({password:e}){let t=[];if(e.length===0)return t;let s=n.getMostUsedSeparatorChar(e);if(s===void 0)return t;let r=n.getSeparatorRegex(s);for(let o of e.matchAll(r)){if(o.index===void 0)continue;let a=o.index+1;t.push({pattern:"separator",token:s,i:a,j:a})}return t}};var ae=class{constructor(){this.matchers={date:X,dictionary:ee,regex:te,repeat:se,sequence:re,spatial:ne,separator:oe}}match(e){let t=[],s=[];return[...Object.keys(this.matchers),...Object.keys(l.matchers)].forEach(o=>{if(!this.matchers[o]&&!l.matchers[o])return;let a=this.matchers[o]?this.matchers[o]:l.matchers[o].Matching,c=new a().match({password:e,omniMatch:this});c instanceof Promise?(c.then(h=>{O(t,h)}),s.push(c)):O(t,c)}),s.length>0?new Promise((o,a)=>{Promise.all(s).then(()=>{o(v(t))}).catch(i=>{a(i)})}):v(t)}};var yt=1,Mt=yt*60,St=Mt*60,Et=St*24,wt=Et*31,_t=wt*12,Xt=_t*100,ye={second:yt,minute:Mt,hour:St,day:Et,month:wt,year:_t,century:Xt},ie=class{translate(e,t){let s=e;t!==void 0&&t!==1&&(s+="s");let{timeEstimation:r}=l.translations;return r[s].replace("{base}",`${t}`)}estimateAttackTimes(e){let t={onlineThrottling100PerHour:e/.027777777777777776,onlineNoThrottling10PerSecond:e/10,offlineSlowHashing1e4PerSecond:e/1e4,offlineFastHashing1e10PerSecond:e/1e10},s={onlineThrottling100PerHour:"",onlineNoThrottling10PerSecond:"",offlineSlowHashing1e4PerSecond:"",offlineFastHashing1e10PerSecond:""};return Object.keys(t).forEach(r=>{let o=t[r];s[r]=this.displayTime(o)}),{crackTimesSeconds:t,crackTimesDisplay:s,score:this.guessesToScore(e)}}guessesToScore(e){return e<1005?0:e<1000005?1:e<100000005?2:e<1e10+5?3:4}displayTime(e){let t="centuries",s,r=Object.keys(ye),o=r.findIndex(a=>e<ye[a]);return o>-1&&(t=r[o-1],o!==0?s=Math.round(e/ye[t]):t="ltSecond"),this.translate(t,s)}};var vt=()=>null;var kt=()=>({warning:l.translations.warnings.dates,suggestions:[l.translations.suggestions.dates]});var Zt=(n,e)=>{let t=null;return e&&!n.l33t&&!n.reversed?n.rank<=10?t=l.translations.warnings.topTen:n.rank<=100?t=l.translations.warnings.topHundred:t=l.translations.warnings.common:n.guessesLog10<=4&&(t=l.translations.warnings.similarToCommon),t},Kt=(n,e)=>{let t=null;return e&&(t=l.translations.warnings.wordByItself),t},Qt=(n,e)=>e?l.translations.warnings.namesByThemselves:l.translations.warnings.commonNames,Jt=(n,e)=>{let t=null,s=n.dictionaryName,r=s==="lastnames"||s.toLowerCase().includes("firstnames");return s==="passwords"?t=Zt(n,e):s.includes("wikipedia")?t=Kt(n,e):r?t=Qt(n,e):s==="userInputs"&&(t=l.translations.warnings.userInputs),t},Ct=(n,e)=>{let t=Jt(n,e),s=[],r=n.token;return r.match(V)?s.push(l.translations.suggestions.capitalization):r.match($)&&r.toLowerCase()!==r&&s.push(l.translations.suggestions.allUppercase),n.reversed&&n.token.length>=4&&s.push(l.translations.suggestions.reverseWords),n.l33t&&s.push(l.translations.suggestions.l33t),{warning:t,suggestions:s}};var Pt=n=>n.regexName==="recentYear"?{warning:l.translations.warnings.recentYears,suggestions:[l.translations.suggestions.recentYears,l.translations.suggestions.associatedYears]}:{warning:null,suggestions:[]};var At=n=>{let e=l.translations.warnings.extendedRepeat;return n.baseToken.length===1&&(e=l.translations.warnings.simpleRepeat),{warning:e,suggestions:[l.translations.suggestions.repeated]}};var It=()=>({warning:l.translations.warnings.sequences,suggestions:[l.translations.suggestions.sequences]});var Tt=n=>{let e=l.translations.warnings.keyPattern;return n.turns===1&&(e=l.translations.warnings.straightRow),{warning:e,suggestions:[l.translations.suggestions.longerKeyboardPattern]}};var Rt=()=>null;var Dt={warning:null,suggestions:[]},ce=class{constructor(){this.matchers={bruteforce:vt,date:kt,dictionary:Ct,regex:Pt,repeat:At,sequence:It,spatial:Tt,separator:Rt},this.defaultFeedback={warning:null,suggestions:[]},this.setDefaultSuggestions()}setDefaultSuggestions(){this.defaultFeedback.suggestions.push(l.translations.suggestions.useWords,l.translations.suggestions.noNeed)}getFeedback(e,t){if(t.length===0)return this.defaultFeedback;if(e>2)return Dt;let s=l.translations.suggestions.anotherWord,r=this.getLongestMatch(t),o=this.getMatchFeedback(r,t.length===1);return o!=null?o.suggestions.unshift(s):o={warning:null,suggestions:[s]},o}getLongestMatch(e){let t=e[0];return e.slice(1).forEach(r=>{r.token.length>t.token.length&&(t=r)}),t}getMatchFeedback(e,t){return this.matchers[e.pattern]?this.matchers[e.pattern](e,t):l.matchers[e.pattern]&&"feedback"in l.matchers[e.pattern]?l.matchers[e.pattern].feedback(e,t):Dt}};var Ot=()=>new Date().getTime(),es=(n,e,t)=>{let s=new ce,r=new ie,o=N.mostGuessableMatchSequence(e,n),a=Ot()-t,i=r.estimateAttackTimes(o.guesses);return _(x(x({calcTime:a},o),i),{feedback:s.getFeedback(i.score,o.sequence)})},ts=(n,e)=>(e&&l.extendUserInputsDictionary(e),new ae().match(n)),Me=(n,e)=>{let t=Ot(),s=ts(n,e);if(s instanceof Promise)throw new Error("You are using a Promised matcher, please use `zxcvbnAsync` for it.");return es(s,n,t)};var Se={warnings:{straightRow:"Straight rows of keys on your keyboard are easy to guess.",keyPattern:"Short keyboard patterns are easy to guess.",simpleRepeat:'Repeated characters like "aaa" are easy to guess.',extendedRepeat:'Repeated character patterns like "abcabcabc" are easy to guess.',sequences:'Common character sequences like "abc" are easy to guess.',recentYears:"Recent years are easy to guess.",dates:"Dates are easy to guess.",topTen:"This is a heavily used password.",topHundred:"This is a frequently used password.",common:"This is a commonly used password.",similarToCommon:"This is similar to a commonly used password.",wordByItself:"Single words are easy to guess.",namesByThemselves:"Single names or surnames are easy to guess.",commonNames:"Common names and surnames are easy to guess.",userInputs:"There should not be any personal or page related data.",pwned:"Your password was exposed by a data breach on the Internet."},suggestions:{l33t:"Avoid predictable letter substitutions like '@' for 'a'.",reverseWords:"Avoid reversed spellings of common words.",allUppercase:"Capitalize some, but not all letters.",capitalization:"Capitalize more than the first letter.",dates:"Avoid dates and years that are associated with you.",recentYears:"Avoid recent years.",associatedYears:"Avoid years that are associated with you.",sequences:"Avoid common character sequences.",repeated:"Avoid repeated words and characters.",longerKeyboardPattern:"Use longer keyboard patterns and change typing direction multiple times.",anotherWord:"Add more words that are less common.",useWords:"Use multiple words, but avoid common phrases.",noNeed:"You can create strong passwords without using symbols, numbers, or uppercase letters.",pwned:"If you use this password elsewhere, you should change it."},timeEstimation:{ltSecond:"less than a second",second:"{base} second",seconds:"{base} seconds",minute:"{base} minute",minutes:"{base} minutes",hour:"{base} hour",hours:"{base} hours",day:"{base} day",days:"{base} days",month:"{base} month",months:"{base} months",year:"{base} year",years:"{base} years",centuries:"centuries"}};var Lt=new ke("PSM_CONFIG");var ss={translations:Se},Ee=(()=>{class n{options=B(Lt,{optional:!0});constructor(){this.options?l.setOptions(this.options):l.setOptions(ss)}score(t){return Me(t).score}scoreWithFeedback(t){let s=Me(t);return{score:s.score,feedback:s.feedback}}static \u0275fac=function(s){return new(s||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var jt=(()=>{class n{renderer;el;numberOfProgressBarItems=P(void 0,{transform:I});passwordStrength=P(void 0,{transform:I});colors=P([]);minProgressVal=0;maxProgressVal=100;currentProgressVal=0;dataPasswordStrength=0;progressBar;defaultColors=["darkred","orangered","orange","yellowgreen","green"];constructor(t,s){this.renderer=t,this.el=s,this.progressBar=this.el.nativeElement}ngOnChanges(t){t.numberOfProgressBarItems&&this.setProgressBarItems(),this.setProgressBar()}setProgressBarItems(){let t=this.progressBar.querySelector(".psm__progress-bar-items"),s=100/this.numberOfProgressBarItems();t.childNodes.forEach(r=>{this.renderer.removeChild(t,r)}),Array(this.numberOfProgressBarItems()).fill(1).forEach(r=>{let o=this.renderer.createElement("div");this.renderer.addClass(o,"psm__progress-bar-item"),this.renderer.setStyle(o,"width",`${s}%`),this.renderer.appendChild(t,o)})}setProgressBar(){let t=this.getFillMeterWidth(this.passwordStrength()),s=`${t}%`,r=t/100*this.numberOfProgressBarItems(),o=this.getMeterFillColor(r);this.dataPasswordStrength=this.passwordStrength()||0,this.currentProgressVal=t;let a=this.progressBar.querySelector(".psm__progress-bar-overlay");a&&(this.renderer.setStyle(a,"width",s),this.renderer.setStyle(a,"background-color",o))}getFillMeterWidth(t){if(t==null)return 0;let s=t!==null?(t+1)/5*100:0;return this.getRoundedStrength(s,100/this.numberOfProgressBarItems())}getMeterFillColor(t){if(!t||t<=0||t>this.colors().length&&t>this.defaultColors.length){let o=this.colors();return o[0]?o[0]:this.defaultColors[0]}let s=t-1,r=this.colors();return r[s]?r[s]:this.defaultColors[s]}getRoundedStrength(t,s){return Math.round(t/s)*s}static \u0275fac=function(s){return new(s||n)(le(Ae),le(Pe))};static \u0275dir=Te({type:n,selectors:[["",8,"psm__progress-bar"]],hostVars:4,hostBindings:function(s,r){s&2&&Re("aria-valuemin",r.minProgressVal)("aria-valuemax",r.maxProgressVal)("aria-valuenow",r.currentProgressVal)("data-strength",r.dataPasswordStrength)},inputs:{numberOfProgressBarItems:[1,"numberOfProgressBarItems"],passwordStrength:[1,"passwordStrength"],colors:[1,"colors"]},features:[U]})}return n})();function rs(n,e){if(n&1&&(F(0,"small",3),ue(1),W()),n&2){let t=G(2);D(),Ue(" ",t.feedback.warning," ")}}function ns(n,e){if(n&1&&ue(0),n&2){let t=e.$implicit,s=e.$index,r=e.$count;ze(" ",t,"",s===r-1?"":" "," ")}}function os(n,e){if(n&1&&(F(0,"small",4),Ne(1,ns,1,2,null,null,Le),W()),n&2){let t=G(2);D(),je(t.feedback.suggestions)}}function as(n,e){if(n&1&&he(0,rs,2,1,"small",3)(1,os,3,0,"small",4),n&2){let t=G();z(t.feedback.warning?0:-1),D(),z(t.feedback.suggestions&&t.feedback.suggestions.length?1:-1)}}var to=(()=>{class n{password=P();minPasswordLength=P(8,{transform:I});enableFeedback=P(!1,{transform:We});colors=P([]);numberOfProgressBarItems=P(5,{transform:I});strengthChange=Ce();baseClass="psm";passwordStrength=null;feedback=null;prevPasswordStrength=null;passwordStrengthMeterService=B(Ee);ngOnChanges(t){t.password&&this.calculatePasswordStrength()}calculatePasswordStrength(){let t=this.password();if(!t)this.passwordStrength=null,this.feedback=null;else if(t&&t.length<this.minPasswordLength())this.passwordStrength=0,this.feedback=null;else if(this.enableFeedback()){let s=this.passwordStrengthMeterService.scoreWithFeedback(t);this.passwordStrength=s.score,this.feedback=s.feedback}else this.passwordStrength=this.passwordStrengthMeterService.score(t),this.feedback=null;this.prevPasswordStrength!==this.passwordStrength&&(this.strengthChange.emit(this.passwordStrength),this.prevPasswordStrength=this.passwordStrength)}static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Ie({type:n,selectors:[["password-strength-meter"]],hostVars:2,hostBindings:function(s,r){s&2&&Oe(r.baseClass)},inputs:{password:[1,"password"],minPasswordLength:[1,"minPasswordLength"],enableFeedback:[1,"enableFeedback"],colors:[1,"colors"],numberOfProgressBarItems:[1,"numberOfProgressBarItems"]},outputs:{strengthChange:"strengthChange"},features:[Fe([Ee]),U],decls:4,vars:4,consts:[["role","progressbar",1,"psm__progress-bar",3,"colors","numberOfProgressBarItems","passwordStrength"],[1,"psm__progress-bar-items"],[1,"psm__progress-bar-overlay"],[1,"psm__feedback"],[1,"psm__suggestion"]],template:function(s,r){s&1&&(F(0,"div",0),Be(1,"div",1)(2,"div",2),W(),he(3,as,2,2)),s&2&&(De("colors",r.colors())("numberOfProgressBarItems",r.numberOfProgressBarItems())("passwordStrength",r.passwordStrength),D(3),z(r.enableFeedback()&&r.feedback?3:-1))},dependencies:[jt],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}.psm__progress-bar[_ngcontent-%COMP%]{position:relative;height:3px;margin:10px auto;background:#fff;border-radius:3px}.psm__progress-bar-items[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;width:100%;height:100%;background:#ddd}.psm__progress-bar-item[_ngcontent-%COMP%]{z-index:5;height:100%;border-right:4px solid #fff}.psm__progress-bar-item[_ngcontent-%COMP%]:last-child{border-right:0}.psm__progress-bar-overlay[_ngcontent-%COMP%]{position:absolute;top:0;height:3px;background:red;border-radius:3px;transition:width .5s ease-in-out,background .25s}.psm__feedback[_ngcontent-%COMP%], .psm__suggestion[_ngcontent-%COMP%]{display:block;margin-top:.25rem;color:#6c757d!important;font-weight:400;font-size:70%}"]})}return n})();export{to as a};
