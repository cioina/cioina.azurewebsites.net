import{a as Kt}from"./chunk-ZY2OP2ZA.js";import{a as $e,b as Dt,d as T,e as L}from"./chunk-V4EF3QKM.js";import{d as Bt,g as ft}from"./chunk-GHTS3ETZ.js";import{i as Pt,k as De,o as St,q as rt}from"./chunk-DHXEJWWB.js";import{D as wt,H as Ht,J as tt,K as Zt,L as Qt,N as ke,O as ve,_ as U,ba as Jt,h as v,j as Q,ja as K,v as Me}from"./chunk-L252YWS3.js";import{a as st,b as lt,h as N}from"./chunk-3XFQOAE3.js";function Ut(o,t,r){if(o&&o.length){let[s,e]=t,i=Math.PI/180*r,h=Math.cos(i),a=Math.sin(i);for(let c of o){let[n,l]=c;c[0]=(n-s)*h-(l-e)*a+s,c[1]=(n-s)*a+(l-e)*h+e}}}function ia(o,t){return o[0]===t[0]&&o[1]===t[1]}function na(o,t,r,s=1){let e=r,i=Math.max(t,.1),h=o[0]&&o[0][0]&&typeof o[0][0]=="number"?[o]:o,a=[0,0];if(e)for(let n of h)Ut(n,a,e);let c=(function(n,l,g){let f=[];for(let x of n){let w=[...x];ia(w[0],w[w.length-1])||w.push([w[0][0],w[0][1]]),w.length>2&&f.push(w)}let p=[];l=Math.max(l,.1);let u=[];for(let x of f)for(let w=0;w<x.length-1;w++){let b=x[w],S=x[w+1];if(b[1]!==S[1]){let M=Math.min(b[1],S[1]);u.push({ymin:M,ymax:Math.max(b[1],S[1]),x:M===b[1]?b[0]:S[0],islope:(S[0]-b[0])/(S[1]-b[1])})}}if(u.sort((x,w)=>x.ymin<w.ymin?-1:x.ymin>w.ymin?1:x.x<w.x?-1:x.x>w.x?1:x.ymax===w.ymax?0:(x.ymax-w.ymax)/Math.abs(x.ymax-w.ymax)),!u.length)return p;let y=[],m=u[0].ymin,d=0;for(;y.length||u.length;){if(u.length){let x=-1;for(let w=0;w<u.length&&!(u[w].ymin>m);w++)x=w;u.splice(0,x+1).forEach(w=>{y.push({s:m,edge:w})})}if(y=y.filter(x=>!(x.edge.ymax<=m)),y.sort((x,w)=>x.edge.x===w.edge.x?0:(x.edge.x-w.edge.x)/Math.abs(x.edge.x-w.edge.x)),(g!==1||d%l==0)&&y.length>1)for(let x=0;x<y.length;x+=2){let w=x+1;if(w>=y.length)break;let b=y[x].edge,S=y[w].edge;p.push([[Math.round(b.x),m],[Math.round(S.x),m]])}m+=g,y.forEach(x=>{x.edge.x=x.edge.x+g*x.edge.islope}),d++}return p})(h,i,s);if(e){for(let n of h)Ut(n,a,-e);(function(n,l,g){let f=[];n.forEach(p=>f.push(...p)),Ut(f,l,g)})(c,a,-e)}return c}function At(o,t){var r;let s=t.hachureAngle+90,e=t.hachureGap;e<0&&(e=4*t.strokeWidth),e=Math.round(Math.max(e,.1));let i=1;return t.roughness>=1&&(((r=t.randomizer)===null||r===void 0?void 0:r.next())||Math.random())>.7&&(i=e),na(o,e,s,i||1)}var Nt=class{constructor(t){this.helper=t}fillPolygons(t,r){return this._fillPolygons(t,r)}_fillPolygons(t,r){let s=At(t,r);return{type:"fillSketch",ops:this.renderLines(s,r)}}renderLines(t,r){let s=[];for(let e of t)s.push(...this.helper.doubleLineOps(e[0][0],e[0][1],e[1][0],e[1][1],r));return s}};function qt(o){let t=o[0],r=o[1];return Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2))}var re=class extends Nt{fillPolygons(t,r){let s=r.hachureGap;s<0&&(s=4*r.strokeWidth),s=Math.max(s,.1);let e=At(t,Object.assign({},r,{hachureGap:s})),i=Math.PI/180*r.hachureAngle,h=[],a=.5*s*Math.cos(i),c=.5*s*Math.sin(i);for(let[n,l]of e)qt([n,l])&&h.push([[n[0]-a,n[1]+c],[...l]],[[n[0]+a,n[1]-c],[...l]]);return{type:"fillSketch",ops:this.renderLines(h,r)}}},ie=class extends Nt{fillPolygons(t,r){let s=this._fillPolygons(t,r),e=Object.assign({},r,{hachureAngle:r.hachureAngle+90}),i=this._fillPolygons(t,e);return s.ops=s.ops.concat(i.ops),s}},ne=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=At(t,r=Object.assign({},r,{hachureAngle:0}));return this.dotsOnLines(s,r)}dotsOnLines(t,r){let s=[],e=r.hachureGap;e<0&&(e=4*r.strokeWidth),e=Math.max(e,.1);let i=r.fillWeight;i<0&&(i=r.strokeWidth/2);let h=e/4;for(let a of t){let c=qt(a),n=c/e,l=Math.ceil(n)-1,g=c-l*e,f=(a[0][0]+a[1][0])/2-e/4,p=Math.min(a[0][1],a[1][1]);for(let u=0;u<l;u++){let y=p+g+u*e,m=f-h+2*Math.random()*h,d=y-h+2*Math.random()*h,x=this.helper.ellipse(m,d,i,i,r);s.push(...x.ops)}}return{type:"fillSketch",ops:s}}},le=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=At(t,r);return{type:"fillSketch",ops:this.dashedLine(s,r)}}dashedLine(t,r){let s=r.dashOffset<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashOffset,e=r.dashGap<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashGap,i=[];return t.forEach(h=>{let a=qt(h),c=Math.floor(a/(s+e)),n=(a+e-c*(s+e))/2,l=h[0],g=h[1];l[0]>g[0]&&(l=h[1],g=h[0]);let f=Math.atan((g[1]-l[1])/(g[0]-l[0]));for(let p=0;p<c;p++){let u=p*(s+e),y=u+s,m=[l[0]+u*Math.cos(f)+n*Math.cos(f),l[1]+u*Math.sin(f)+n*Math.sin(f)],d=[l[0]+y*Math.cos(f)+n*Math.cos(f),l[1]+y*Math.sin(f)+n*Math.sin(f)];i.push(...this.helper.doubleLineOps(m[0],m[1],d[0],d[1],r))}}),i}},ce=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=r.hachureGap<0?4*r.strokeWidth:r.hachureGap,e=r.zigzagOffset<0?s:r.zigzagOffset,i=At(t,r=Object.assign({},r,{hachureGap:s+e}));return{type:"fillSketch",ops:this.zigzagLines(i,e,r)}}zigzagLines(t,r,s){let e=[];return t.forEach(i=>{let h=qt(i),a=Math.round(h/(2*r)),c=i[0],n=i[1];c[0]>n[0]&&(c=i[1],n=i[0]);let l=Math.atan((n[1]-c[1])/(n[0]-c[0]));for(let g=0;g<a;g++){let f=2*g*r,p=2*(g+1)*r,u=Math.sqrt(2*Math.pow(r,2)),y=[c[0]+f*Math.cos(l),c[1]+f*Math.sin(l)],m=[c[0]+p*Math.cos(l),c[1]+p*Math.sin(l)],d=[y[0]+u*Math.cos(l+Math.PI/4),y[1]+u*Math.sin(l+Math.PI/4)];e.push(...this.helper.doubleLineOps(y[0],y[1],d[0],d[1],s),...this.helper.doubleLineOps(d[0],d[1],m[0],m[1],s))}}),e}},it={},oe=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},la=0,te=1,Pe=2,It={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function ee(o,t){return o.type===t}function ye(o){let t=[],r=(function(h){let a=new Array;for(;h!=="";)if(h.match(/^([ \t\r\n,]+)/))h=h.substr(RegExp.$1.length);else if(h.match(/^([aAcChHlLmMqQsStTvVzZ])/))a[a.length]={type:la,text:RegExp.$1},h=h.substr(RegExp.$1.length);else{if(!h.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];a[a.length]={type:te,text:`${parseFloat(RegExp.$1)}`},h=h.substr(RegExp.$1.length)}return a[a.length]={type:Pe,text:""},a})(o),s="BOD",e=0,i=r[e];for(;!ee(i,Pe);){let h=0,a=[];if(s==="BOD"){if(i.text!=="M"&&i.text!=="m")return ye("M0,0"+o);e++,h=It[i.text],s=i.text}else ee(i,te)?h=It[s]:(e++,h=It[i.text],s=i.text);if(!(e+h<r.length))throw new Error("Path data ended short");for(let c=e;c<e+h;c++){let n=r[c];if(!ee(n,te))throw new Error("Param not a number: "+s+","+n.text);a[a.length]=+n.text}if(typeof It[s]!="number")throw new Error("Bad segment: "+s);{let c={key:s,data:a};t.push(c),e+=h,i=r[e],s==="M"&&(s="L"),s==="m"&&(s="l")}}return t}function We(o){let t=0,r=0,s=0,e=0,i=[];for(let{key:h,data:a}of o)switch(h){case"M":i.push({key:"M",data:[...a]}),[t,r]=a,[s,e]=a;break;case"m":t+=a[0],r+=a[1],i.push({key:"M",data:[t,r]}),s=t,e=r;break;case"L":i.push({key:"L",data:[...a]}),[t,r]=a;break;case"l":t+=a[0],r+=a[1],i.push({key:"L",data:[t,r]});break;case"C":i.push({key:"C",data:[...a]}),t=a[4],r=a[5];break;case"c":{let c=a.map((n,l)=>l%2?n+r:n+t);i.push({key:"C",data:c}),t=c[4],r=c[5];break}case"Q":i.push({key:"Q",data:[...a]}),t=a[2],r=a[3];break;case"q":{let c=a.map((n,l)=>l%2?n+r:n+t);i.push({key:"Q",data:c}),t=c[2],r=c[3];break}case"A":i.push({key:"A",data:[...a]}),t=a[5],r=a[6];break;case"a":t+=a[5],r+=a[6],i.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,r]});break;case"H":i.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...a]}),r=a[0];break;case"v":r+=a[0],i.push({key:"V",data:[r]});break;case"S":i.push({key:"S",data:[...a]}),t=a[2],r=a[3];break;case"s":{let c=a.map((n,l)=>l%2?n+r:n+t);i.push({key:"S",data:c}),t=c[2],r=c[3];break}case"T":i.push({key:"T",data:[...a]}),t=a[0],r=a[1];break;case"t":t+=a[0],r+=a[1],i.push({key:"T",data:[t,r]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=s,r=e}return i}function He(o){let t=[],r="",s=0,e=0,i=0,h=0,a=0,c=0;for(let{key:n,data:l}of o){switch(n){case"M":t.push({key:"M",data:[...l]}),[s,e]=l,[i,h]=l;break;case"C":t.push({key:"C",data:[...l]}),s=l[4],e=l[5],a=l[2],c=l[3];break;case"L":t.push({key:"L",data:[...l]}),[s,e]=l;break;case"H":s=l[0],t.push({key:"L",data:[s,e]});break;case"V":e=l[0],t.push({key:"L",data:[s,e]});break;case"S":{let g=0,f=0;r==="C"||r==="S"?(g=s+(s-a),f=e+(e-c)):(g=s,f=e),t.push({key:"C",data:[g,f,...l]}),a=l[0],c=l[1],s=l[2],e=l[3];break}case"T":{let[g,f]=l,p=0,u=0;r==="Q"||r==="T"?(p=s+(s-a),u=e+(e-c)):(p=s,u=e);let y=s+2*(p-s)/3,m=e+2*(u-e)/3,d=g+2*(p-g)/3,x=f+2*(u-f)/3;t.push({key:"C",data:[y,m,d,x,g,f]}),a=p,c=u,s=g,e=f;break}case"Q":{let[g,f,p,u]=l,y=s+2*(g-s)/3,m=e+2*(f-e)/3,d=p+2*(g-p)/3,x=u+2*(f-u)/3;t.push({key:"C",data:[y,m,d,x,p,u]}),a=g,c=f,s=p,e=u;break}case"A":{let g=Math.abs(l[0]),f=Math.abs(l[1]),p=l[2],u=l[3],y=l[4],m=l[5],d=l[6];g===0||f===0?(t.push({key:"C",data:[s,e,m,d,m,d]}),s=m,e=d):(s!==m||e!==d)&&(Ie(s,e,m,d,g,f,p,u,y).forEach(function(x){t.push({key:"C",data:x})}),s=m,e=d);break}case"Z":t.push({key:"Z",data:[]}),s=i,e=h}r=n}return t}function Ct(o,t,r){return[o*Math.cos(r)-t*Math.sin(r),o*Math.sin(r)+t*Math.cos(r)]}function Ie(o,t,r,s,e,i,h,a,c,n){let l=(g=h,Math.PI*g/180);var g;let f=[],p=0,u=0,y=0,m=0;if(n)[p,u,y,m]=n;else{[o,t]=Ct(o,t,-l),[r,s]=Ct(r,s,-l);let E=(o-r)/2,B=(t-s)/2,I=E*E/(e*e)+B*B/(i*i);I>1&&(I=Math.sqrt(I),e*=I,i*=I);let R=e*e,q=i*i,z=R*q-R*B*B-q*E*E,W=R*B*B+q*E*E,F=(a===c?-1:1)*Math.sqrt(Math.abs(z/W));y=F*e*B/i+(o+r)/2,m=F*-i*E/e+(t+s)/2,p=Math.asin(parseFloat(((t-m)/i).toFixed(9))),u=Math.asin(parseFloat(((s-m)/i).toFixed(9))),o<y&&(p=Math.PI-p),r<y&&(u=Math.PI-u),p<0&&(p=2*Math.PI+p),u<0&&(u=2*Math.PI+u),c&&p>u&&(p-=2*Math.PI),!c&&u>p&&(u-=2*Math.PI)}let d=u-p;if(Math.abs(d)>120*Math.PI/180){let E=u,B=r,I=s;u=c&&u>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,f=Ie(r=y+e*Math.cos(u),s=m+i*Math.sin(u),B,I,e,i,h,0,c,[u,E,y,m])}d=u-p;let x=Math.cos(p),w=Math.sin(p),b=Math.cos(u),S=Math.sin(u),M=Math.tan(d/4),D=4/3*e*M,$=4/3*i*M,P=[o,t],C=[o+D*w,t-$*x],O=[r+D*S,s-$*b],V=[r,s];if(C[0]=2*P[0]-C[0],C[1]=2*P[1]-C[1],n)return[C,O,V].concat(f);{f=[C,O,V].concat(f);let E=[];for(let B=0;B<f.length;B+=3){let I=Ct(f[B][0],f[B][1],l),R=Ct(f[B+1][0],f[B+1][1],l),q=Ct(f[B+2][0],f[B+2][1],l);E.push([I[0],I[1],R[0],R[1],q[0],q[1]])}return E}}var ca={randOffset:function(o,t){return j(o,t)},randOffsetWithRange:function(o,t,r){return jt(o,t,r)},ellipse:function(o,t,r,s,e){let i=Oe(r,s,e);return he(o,t,e,i).opset},doubleLineOps:function(o,t,r,s,e){return ut(o,t,r,s,e,!0)}};function Ee(o,t,r,s,e){return{type:"path",ops:ut(o,t,r,s,e)}}function _t(o,t,r){let s=(o||[]).length;if(s>2){let e=[];for(let i=0;i<s-1;i++)e.push(...ut(o[i][0],o[i][1],o[i+1][0],o[i+1][1],r));return t&&e.push(...ut(o[s-1][0],o[s-1][1],o[0][0],o[0][1],r)),{type:"path",ops:e}}return s===2?Ee(o[0][0],o[0][1],o[1][0],o[1][1],r):{type:"path",ops:[]}}function oa(o,t,r,s,e){return(function(i,h){return _t(i,!0,h)})([[o,t],[o+r,t],[o+r,t+s],[o,t+s]],e)}function Be(o,t){if(o.length){let r=typeof o[0][0]=="number"?[o]:o,s=Et(r[0],1*(1+.2*t.roughness),t),e=t.disableMultiStroke?[]:Et(r[0],1.5*(1+.22*t.roughness),Ne(t));for(let i=1;i<r.length;i++){let h=r[i];if(h.length){let a=Et(h,1*(1+.2*t.roughness),t),c=t.disableMultiStroke?[]:Et(h,1.5*(1+.22*t.roughness),Ne(t));for(let n of a)n.op!=="move"&&s.push(n);for(let n of c)n.op!=="move"&&e.push(n)}}return{type:"path",ops:s.concat(e)}}return{type:"path",ops:[]}}function Oe(o,t,r){let s=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(o/2,2)+Math.pow(t/2,2))/2)),e=Math.ceil(Math.max(r.curveStepCount,r.curveStepCount/Math.sqrt(200)*s)),i=2*Math.PI/e,h=Math.abs(o/2),a=Math.abs(t/2),c=1-r.curveFitting;return h+=j(h*c,r),a+=j(a*c,r),{increment:i,rx:h,ry:a}}function he(o,t,r,s){let[e,i]=Ae(s.increment,o,t,s.rx,s.ry,1,s.increment*jt(.1,jt(.4,1,r),r),r),h=Gt(e,null,r);if(!r.disableMultiStroke&&r.roughness!==0){let[a]=Ae(s.increment,o,t,s.rx,s.ry,1.5,0,r),c=Gt(a,null,r);h=h.concat(c)}return{estimatedPoints:i,opset:{type:"path",ops:h}}}function Ce(o,t,r,s,e,i,h,a,c){let n=o,l=t,g=Math.abs(r/2),f=Math.abs(s/2);g+=j(.01*g,c),f+=j(.01*f,c);let p=e,u=i;for(;p<0;)p+=2*Math.PI,u+=2*Math.PI;u-p>2*Math.PI&&(p=0,u=2*Math.PI);let y=2*Math.PI/c.curveStepCount,m=Math.min(y/2,(u-p)/2),d=Le(m,n,l,g,f,p,u,1,c);if(!c.disableMultiStroke){let x=Le(m,n,l,g,f,p,u,1.5,c);d.push(...x)}return h&&(a?d.push(...ut(n,l,n+g*Math.cos(p),l+f*Math.sin(p),c),...ut(n,l,n+g*Math.cos(u),l+f*Math.sin(u),c)):d.push({op:"lineTo",data:[n,l]},{op:"lineTo",data:[n+g*Math.cos(p),l+f*Math.sin(p)]})),{type:"path",ops:d}}function Re(o,t){let r=He(We(ye(o))),s=[],e=[0,0],i=[0,0];for(let{key:h,data:a}of r)switch(h){case"M":i=[a[0],a[1]],e=[a[0],a[1]];break;case"L":s.push(...ut(i[0],i[1],a[0],a[1],t)),i=[a[0],a[1]];break;case"C":{let[c,n,l,g,f,p]=a;s.push(...ha(c,n,l,g,f,p,i,t)),i=[f,p];break}case"Z":s.push(...ut(i[0],i[1],e[0],e[1],t)),i=[e[0],e[1]]}return{type:"path",ops:s}}function se(o,t){let r=[];for(let s of o)if(s.length){let e=t.maxRandomnessOffset||0,i=s.length;if(i>2){r.push({op:"move",data:[s[0][0]+j(e,t),s[0][1]+j(e,t)]});for(let h=1;h<i;h++)r.push({op:"lineTo",data:[s[h][0]+j(e,t),s[h][1]+j(e,t)]})}}return{type:"fillPath",ops:r}}function Mt(o,t){return(function(r,s){let e=r.fillStyle||"hachure";if(!it[e])switch(e){case"zigzag":it[e]||(it[e]=new re(s));break;case"cross-hatch":it[e]||(it[e]=new ie(s));break;case"dots":it[e]||(it[e]=new ne(s));break;case"dashed":it[e]||(it[e]=new le(s));break;case"zigzag-line":it[e]||(it[e]=new ce(s));break;default:e="hachure",it[e]||(it[e]=new Nt(s))}return it[e]})(t,ca).fillPolygons(o,t)}function Ne(o){let t=Object.assign({},o);return t.randomizer=void 0,o.seed&&(t.seed=o.seed+1),t}function _e(o){return o.randomizer||(o.randomizer=new oe(o.seed||0)),o.randomizer.next()}function jt(o,t,r,s=1){return r.roughness*s*(_e(r)*(t-o)+o)}function j(o,t,r=1){return jt(-o,o,t,r)}function ut(o,t,r,s,e,i=!1){let h=i?e.disableMultiStrokeFill:e.disableMultiStroke,a=ge(o,t,r,s,e,!0,!1);if(h)return a;let c=ge(o,t,r,s,e,!0,!0);return a.concat(c)}function ge(o,t,r,s,e,i,h){let a=Math.pow(o-r,2)+Math.pow(t-s,2),c=Math.sqrt(a),n=1;n=c<200?1:c>500?.4:-.0016668*c+1.233334;let l=e.maxRandomnessOffset||0;l*l*100>a&&(l=c/10);let g=l/2,f=.2+.2*_e(e),p=e.bowing*e.maxRandomnessOffset*(s-t)/200,u=e.bowing*e.maxRandomnessOffset*(o-r)/200;p=j(p,e,n),u=j(u,e,n);let y=[],m=()=>j(g,e,n),d=()=>j(l,e,n),x=e.preserveVertices;return i&&(h?y.push({op:"move",data:[o+(x?0:m()),t+(x?0:m())]}):y.push({op:"move",data:[o+(x?0:j(l,e,n)),t+(x?0:j(l,e,n))]})),h?y.push({op:"bcurveTo",data:[p+o+(r-o)*f+m(),u+t+(s-t)*f+m(),p+o+2*(r-o)*f+m(),u+t+2*(s-t)*f+m(),r+(x?0:m()),s+(x?0:m())]}):y.push({op:"bcurveTo",data:[p+o+(r-o)*f+d(),u+t+(s-t)*f+d(),p+o+2*(r-o)*f+d(),u+t+2*(s-t)*f+d(),r+(x?0:d()),s+(x?0:d())]}),y}function Et(o,t,r){if(!o.length)return[];let s=[];s.push([o[0][0]+j(t,r),o[0][1]+j(t,r)]),s.push([o[0][0]+j(t,r),o[0][1]+j(t,r)]);for(let e=1;e<o.length;e++)s.push([o[e][0]+j(t,r),o[e][1]+j(t,r)]),e===o.length-1&&s.push([o[e][0]+j(t,r),o[e][1]+j(t,r)]);return Gt(s,null,r)}function Gt(o,t,r){let s=o.length,e=[];if(s>3){let i=[],h=1-r.curveTightness;e.push({op:"move",data:[o[1][0],o[1][1]]});for(let a=1;a+2<s;a++){let c=o[a];i[0]=[c[0],c[1]],i[1]=[c[0]+(h*o[a+1][0]-h*o[a-1][0])/6,c[1]+(h*o[a+1][1]-h*o[a-1][1])/6],i[2]=[o[a+1][0]+(h*o[a][0]-h*o[a+2][0])/6,o[a+1][1]+(h*o[a][1]-h*o[a+2][1])/6],i[3]=[o[a+1][0],o[a+1][1]],e.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}if(t&&t.length===2){let a=r.maxRandomnessOffset;e.push({op:"lineTo",data:[t[0]+j(a,r),t[1]+j(a,r)]})}}else s===3?(e.push({op:"move",data:[o[1][0],o[1][1]]}),e.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[2][0],o[2][1]]})):s===2&&e.push(...ge(o[0][0],o[0][1],o[1][0],o[1][1],r,!0,!0));return e}function Ae(o,t,r,s,e,i,h,a){let c=[],n=[];if(a.roughness===0){o/=4,n.push([t+s*Math.cos(-o),r+e*Math.sin(-o)]);for(let l=0;l<=2*Math.PI;l+=o){let g=[t+s*Math.cos(l),r+e*Math.sin(l)];c.push(g),n.push(g)}n.push([t+s*Math.cos(0),r+e*Math.sin(0)]),n.push([t+s*Math.cos(o),r+e*Math.sin(o)])}else{let l=j(.5,a)-Math.PI/2;n.push([j(i,a)+t+.9*s*Math.cos(l-o),j(i,a)+r+.9*e*Math.sin(l-o)]);let g=2*Math.PI+l-.01;for(let f=l;f<g;f+=o){let p=[j(i,a)+t+s*Math.cos(f),j(i,a)+r+e*Math.sin(f)];c.push(p),n.push(p)}n.push([j(i,a)+t+s*Math.cos(l+2*Math.PI+.5*h),j(i,a)+r+e*Math.sin(l+2*Math.PI+.5*h)]),n.push([j(i,a)+t+.98*s*Math.cos(l+h),j(i,a)+r+.98*e*Math.sin(l+h)]),n.push([j(i,a)+t+.9*s*Math.cos(l+.5*h),j(i,a)+r+.9*e*Math.sin(l+.5*h)])}return[n,c]}function Le(o,t,r,s,e,i,h,a,c){let n=i+j(.1,c),l=[];l.push([j(a,c)+t+.9*s*Math.cos(n-o),j(a,c)+r+.9*e*Math.sin(n-o)]);for(let g=n;g<=h;g+=o)l.push([j(a,c)+t+s*Math.cos(g),j(a,c)+r+e*Math.sin(g)]);return l.push([t+s*Math.cos(h),r+e*Math.sin(h)]),l.push([t+s*Math.cos(h),r+e*Math.sin(h)]),Gt(l,null,c)}function ha(o,t,r,s,e,i,h,a){let c=[],n=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3],l=[0,0],g=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let p=0;p<g;p++)p===0?c.push({op:"move",data:[h[0],h[1]]}):c.push({op:"move",data:[h[0]+(f?0:j(n[0],a)),h[1]+(f?0:j(n[0],a))]}),l=f?[e,i]:[e+j(n[p],a),i+j(n[p],a)],c.push({op:"bcurveTo",data:[o+j(n[p],a),t+j(n[p],a),r+j(n[p],a),s+j(n[p],a),l[0],l[1]]});return c}function Rt(o){return[...o]}function Te(o,t=0){let r=o.length;if(r<3)throw new Error("A curve must have at least three points.");let s=[];if(r===3)s.push(Rt(o[0]),Rt(o[1]),Rt(o[2]),Rt(o[2]));else{let e=[];e.push(o[0],o[0]);for(let a=1;a<o.length;a++)e.push(o[a]),a===o.length-1&&e.push(o[a]);let i=[],h=1-t;s.push(Rt(e[0]));for(let a=1;a+2<e.length;a++){let c=e[a];i[0]=[c[0],c[1]],i[1]=[c[0]+(h*e[a+1][0]-h*e[a-1][0])/6,c[1]+(h*e[a+1][1]-h*e[a-1][1])/6],i[2]=[e[a+1][0]+(h*e[a][0]-h*e[a+2][0])/6,e[a+1][1]+(h*e[a][1]-h*e[a+2][1])/6],i[3]=[e[a+1][0],e[a+1][1]],s.push(i[1],i[2],i[3])}}return s}function zt(o,t){return Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)}function ga(o,t,r){let s=zt(t,r);if(s===0)return zt(o,t);let e=((o[0]-t[0])*(r[0]-t[0])+(o[1]-t[1])*(r[1]-t[1]))/s;return e=Math.max(0,Math.min(1,e)),zt(o,bt(t,r,e))}function bt(o,t,r){return[o[0]+(t[0]-o[0])*r,o[1]+(t[1]-o[1])*r]}function pe(o,t,r,s){let e=s||[];if((function(a,c){let n=a[c+0],l=a[c+1],g=a[c+2],f=a[c+3],p=3*l[0]-2*n[0]-f[0];p*=p;let u=3*l[1]-2*n[1]-f[1];u*=u;let y=3*g[0]-2*f[0]-n[0];y*=y;let m=3*g[1]-2*f[1]-n[1];return m*=m,p<y&&(p=y),u<m&&(u=m),p+u})(o,t)<r){let a=o[t+0];e.length?(i=e[e.length-1],h=a,Math.sqrt(zt(i,h))>1&&e.push(a)):e.push(a),e.push(o[t+3])}else{let c=o[t+0],n=o[t+1],l=o[t+2],g=o[t+3],f=bt(c,n,.5),p=bt(n,l,.5),u=bt(l,g,.5),y=bt(f,p,.5),m=bt(p,u,.5),d=bt(y,m,.5);pe([c,f,y,d],0,r,e),pe([d,m,u,g],0,r,e)}var i,h;return e}function pa(o,t){return Ft(o,0,o.length,t)}function Ft(o,t,r,s,e){let i=e||[],h=o[t],a=o[r-1],c=0,n=1;for(let l=t+1;l<r-1;++l){let g=ga(o[l],h,a);g>c&&(c=g,n=l)}return Math.sqrt(c)>s?(Ft(o,t,n+1,s,i),Ft(o,n,r,s,i)):(i.length||i.push(h),i.push(a)),i}function ae(o,t=.15,r){let s=[],e=(o.length-1)/3;for(let i=0;i<e;i++)pe(o,3*i,t,s);return r&&r>0?Ft(s,0,s.length,r):s}var ct="none",kt=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,r,s){return{shape:t,sets:r||[],options:s||this.defaultOptions}}line(t,r,s,e,i){let h=this._o(i);return this._d("line",[Ee(t,r,s,e,h)],h)}rectangle(t,r,s,e,i){let h=this._o(i),a=[],c=oa(t,r,s,e,h);if(h.fill){let n=[[t,r],[t+s,r],[t+s,r+e],[t,r+e]];h.fillStyle==="solid"?a.push(se([n],h)):a.push(Mt([n],h))}return h.stroke!==ct&&a.push(c),this._d("rectangle",a,h)}ellipse(t,r,s,e,i){let h=this._o(i),a=[],c=Oe(s,e,h),n=he(t,r,h,c);if(h.fill)if(h.fillStyle==="solid"){let l=he(t,r,h,c).opset;l.type="fillPath",a.push(l)}else a.push(Mt([n.estimatedPoints],h));return h.stroke!==ct&&a.push(n.opset),this._d("ellipse",a,h)}circle(t,r,s,e){let i=this.ellipse(t,r,s,s,e);return i.shape="circle",i}linearPath(t,r){let s=this._o(r);return this._d("linearPath",[_t(t,!1,s)],s)}arc(t,r,s,e,i,h,a=!1,c){let n=this._o(c),l=[],g=Ce(t,r,s,e,i,h,a,!0,n);if(a&&n.fill)if(n.fillStyle==="solid"){let f=Object.assign({},n);f.disableMultiStroke=!0;let p=Ce(t,r,s,e,i,h,!0,!1,f);p.type="fillPath",l.push(p)}else l.push((function(f,p,u,y,m,d,x){let w=f,b=p,S=Math.abs(u/2),M=Math.abs(y/2);S+=j(.01*S,x),M+=j(.01*M,x);let D=m,$=d;for(;D<0;)D+=2*Math.PI,$+=2*Math.PI;$-D>2*Math.PI&&(D=0,$=2*Math.PI);let P=($-D)/x.curveStepCount,C=[];for(let O=D;O<=$;O+=P)C.push([w+S*Math.cos(O),b+M*Math.sin(O)]);return C.push([w+S*Math.cos($),b+M*Math.sin($)]),C.push([w,b]),Mt([C],x)})(t,r,s,e,i,h,n));return n.stroke!==ct&&l.push(g),this._d("arc",l,n)}curve(t,r){let s=this._o(r),e=[],i=Be(t,s);if(s.fill&&s.fill!==ct)if(s.fillStyle==="solid"){let h=Be(t,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));e.push({type:"fillPath",ops:this._mergedShape(h.ops)})}else{let h=[],a=t;if(a.length){let c=typeof a[0][0]=="number"?[a]:a;for(let n of c)n.length<3?h.push(...n):n.length===3?h.push(...ae(Te([n[0],n[0],n[1],n[2]]),10,(1+s.roughness)/2)):h.push(...ae(Te(n),10,(1+s.roughness)/2))}h.length&&e.push(Mt([h],s))}return s.stroke!==ct&&e.push(i),this._d("curve",e,s)}polygon(t,r){let s=this._o(r),e=[],i=_t(t,!0,s);return s.fill&&(s.fillStyle==="solid"?e.push(se([t],s)):e.push(Mt([t],s))),s.stroke!==ct&&e.push(i),this._d("polygon",e,s)}path(t,r){let s=this._o(r),e=[];if(!t)return this._d("path",e,s);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let i=s.fill&&s.fill!=="transparent"&&s.fill!==ct,h=s.stroke!==ct,a=!!(s.simplification&&s.simplification<1),c=(function(l,g,f){let p=He(We(ye(l))),u=[],y=[],m=[0,0],d=[],x=()=>{d.length>=4&&y.push(...ae(d,g)),d=[]},w=()=>{x(),y.length&&(u.push(y),y=[])};for(let{key:S,data:M}of p)switch(S){case"M":w(),m=[M[0],M[1]],y.push(m);break;case"L":x(),y.push([M[0],M[1]]);break;case"C":if(!d.length){let D=y.length?y[y.length-1]:m;d.push([D[0],D[1]])}d.push([M[0],M[1]]),d.push([M[2],M[3]]),d.push([M[4],M[5]]);break;case"Z":x(),y.push([m[0],m[1]])}if(w(),!f)return u;let b=[];for(let S of u){let M=pa(S,f);M.length&&b.push(M)}return b})(t,1,a?4-4*(s.simplification||1):(1+s.roughness)/2),n=Re(t,s);if(i)if(s.fillStyle==="solid")if(c.length===1){let l=Re(t,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));e.push({type:"fillPath",ops:this._mergedShape(l.ops)})}else e.push(se(c,s));else e.push(Mt(c,s));return h&&(a?c.forEach(l=>{e.push(_t(l,!1,s))}):e.push(n)),this._d("path",e,s)}opsToPath(t,r){let s="";for(let e of t.ops){let i=typeof r=="number"&&r>=0?e.data.map(h=>+h.toFixed(r)):e.data;switch(e.op){case"move":s+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":s+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":s+=`L${i[0]} ${i[1]} `}}return s.trim()}toPaths(t){let r=t.sets||[],s=t.options||this.defaultOptions,e=[];for(let i of r){let h=null;switch(i.type){case"path":h={d:this.opsToPath(i),stroke:s.stroke,strokeWidth:s.strokeWidth,fill:ct};break;case"fillPath":h={d:this.opsToPath(i),stroke:ct,strokeWidth:0,fill:s.fill||ct};break;case"fillSketch":h=this.fillSketch(i,s)}h&&e.push(h)}return e}fillSketch(t,r){let s=r.fillWeight;return s<0&&(s=r.strokeWidth/2),{d:this.opsToPath(t),stroke:r.fill||ct,strokeWidth:s,fill:ct}}_mergedShape(t){return t.filter((r,s)=>s===0||r.op!=="move")}},fe=class{constructor(t,r){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new kt(r)}draw(t){let r=t.sets||[],s=t.options||this.getDefaultOptions(),e=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(let h of r)switch(h.type){case"path":e.save(),e.strokeStyle=s.stroke==="none"?"transparent":s.stroke,e.lineWidth=s.strokeWidth,s.strokeLineDash&&e.setLineDash(s.strokeLineDash),s.strokeLineDashOffset&&(e.lineDashOffset=s.strokeLineDashOffset),this._drawToContext(e,h,i),e.restore();break;case"fillPath":{e.save(),e.fillStyle=s.fill||"";let a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(e,h,i,a),e.restore();break}case"fillSketch":this.fillSketch(e,h,s)}}fillSketch(t,r,s){let e=s.fillWeight;e<0&&(e=s.strokeWidth/2),t.save(),s.fillLineDash&&t.setLineDash(s.fillLineDash),s.fillLineDashOffset&&(t.lineDashOffset=s.fillLineDashOffset),t.strokeStyle=s.fill||"",t.lineWidth=e,this._drawToContext(t,r,s.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,r,s,e="nonzero"){t.beginPath();for(let i of r.ops){let h=typeof s=="number"&&s>=0?i.data.map(a=>+a.toFixed(s)):i.data;switch(i.op){case"move":t.moveTo(h[0],h[1]);break;case"bcurveTo":t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"lineTo":t.lineTo(h[0],h[1])}}r.type==="fillPath"?t.fill(e):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,r,s,e,i){let h=this.gen.line(t,r,s,e,i);return this.draw(h),h}rectangle(t,r,s,e,i){let h=this.gen.rectangle(t,r,s,e,i);return this.draw(h),h}ellipse(t,r,s,e,i){let h=this.gen.ellipse(t,r,s,e,i);return this.draw(h),h}circle(t,r,s,e){let i=this.gen.circle(t,r,s,e);return this.draw(i),i}linearPath(t,r){let s=this.gen.linearPath(t,r);return this.draw(s),s}polygon(t,r){let s=this.gen.polygon(t,r);return this.draw(s),s}arc(t,r,s,e,i,h,a=!1,c){let n=this.gen.arc(t,r,s,e,i,h,a,c);return this.draw(n),n}curve(t,r){let s=this.gen.curve(t,r);return this.draw(s),s}path(t,r){let s=this.gen.path(t,r);return this.draw(s),s}},Ot="http://www.w3.org/2000/svg",ue=class{constructor(t,r){this.svg=t,this.gen=new kt(r)}draw(t){let r=t.sets||[],s=t.options||this.getDefaultOptions(),e=this.svg.ownerDocument||window.document,i=e.createElementNS(Ot,"g"),h=t.options.fixedDecimalPlaceDigits;for(let a of r){let c=null;switch(a.type){case"path":c=e.createElementNS(Ot,"path"),c.setAttribute("d",this.opsToPath(a,h)),c.setAttribute("stroke",s.stroke),c.setAttribute("stroke-width",s.strokeWidth+""),c.setAttribute("fill","none"),s.strokeLineDash&&c.setAttribute("stroke-dasharray",s.strokeLineDash.join(" ").trim()),s.strokeLineDashOffset&&c.setAttribute("stroke-dashoffset",`${s.strokeLineDashOffset}`);break;case"fillPath":c=e.createElementNS(Ot,"path"),c.setAttribute("d",this.opsToPath(a,h)),c.setAttribute("stroke","none"),c.setAttribute("stroke-width","0"),c.setAttribute("fill",s.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||c.setAttribute("fill-rule","evenodd");break;case"fillSketch":c=this.fillSketch(e,a,s)}c&&i.appendChild(c)}return i}fillSketch(t,r,s){let e=s.fillWeight;e<0&&(e=s.strokeWidth/2);let i=t.createElementNS(Ot,"path");return i.setAttribute("d",this.opsToPath(r,s.fixedDecimalPlaceDigits)),i.setAttribute("stroke",s.fill||""),i.setAttribute("stroke-width",e+""),i.setAttribute("fill","none"),s.fillLineDash&&i.setAttribute("stroke-dasharray",s.fillLineDash.join(" ").trim()),s.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${s.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,r){return this.gen.opsToPath(t,r)}line(t,r,s,e,i){let h=this.gen.line(t,r,s,e,i);return this.draw(h)}rectangle(t,r,s,e,i){let h=this.gen.rectangle(t,r,s,e,i);return this.draw(h)}ellipse(t,r,s,e,i){let h=this.gen.ellipse(t,r,s,e,i);return this.draw(h)}circle(t,r,s,e){let i=this.gen.circle(t,r,s,e);return this.draw(i)}linearPath(t,r){let s=this.gen.linearPath(t,r);return this.draw(s)}polygon(t,r){let s=this.gen.polygon(t,r);return this.draw(s)}arc(t,r,s,e,i,h,a=!1,c){let n=this.gen.arc(t,r,s,e,i,h,a,c);return this.draw(n)}curve(t,r){let s=this.gen.curve(t,r);return this.draw(s)}path(t,r){let s=this.gen.path(t,r);return this.draw(s)}},k={canvas:(o,t)=>new fe(o,t),svg:(o,t)=>new ue(o,t),generator:o=>new kt(o),newSeed:()=>kt.newSeed()};var X=v((o,t,r)=>N(null,null,function*(){let s,e=t.useHtmlLabels||tt(U()?.htmlLabels);r?s=r:s="node default";let i=o.insert("g").attr("class",s).attr("id",t.domId||t.id),h=i.insert("g").attr("class","label").attr("style",rt(t.labelStyle)),a;t.label===void 0?a="":a=typeof t.label=="string"?t.label:t.label[0];let c=yield ft(h,Ht(St(a),U()),{useHtmlLabels:e,width:t.width||U().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img}),n=c.getBBox(),l=(t?.padding??0)/2;if(e){let g=c.children[0],f=K(c),p=g.getElementsByTagName("img");if(p){let u=a.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...p].map(y=>new Promise(m=>{function d(){if(y.style.display="flex",y.style.flexDirection="column",u){let x=U().fontSize?U().fontSize:window.getComputedStyle(document.body).fontSize,w=5,[b=Me.fontSize]=De(x),S=b*w+"px";y.style.minWidth=S,y.style.maxWidth=S}else y.style.width="100%";m(y)}v(d,"setupImage"),setTimeout(()=>{y.complete&&d()}),y.addEventListener("error",d),y.addEventListener("load",d)})))}n=g.getBoundingClientRect(),f.attr("width",n.width),f.attr("height",n.height)}return e?h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"):h.attr("transform","translate(0, "+-n.height/2+")"),t.centerLabel&&h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),h.insert("rect",":first-child"),{shapeSvg:i,bbox:n,halfPadding:l,label:h}}),"labelHelper"),de=v((o,t,r)=>N(null,null,function*(){let s=r.useHtmlLabels||tt(U()?.flowchart?.htmlLabels),e=o.insert("g").attr("class","label").attr("style",r.labelStyle||""),i=yield ft(e,Ht(St(t),U()),{useHtmlLabels:s,width:r.width||U()?.flowchart?.wrappingWidth,style:r.labelStyle,addSvgBackground:!!r.icon||!!r.img}),h=i.getBBox(),a=r.padding/2;if(tt(U()?.flowchart?.htmlLabels)){let c=i.children[0],n=K(i);h=c.getBoundingClientRect(),n.attr("width",h.width),n.attr("height",h.height)}return s?e.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"):e.attr("transform","translate(0, "+-h.height/2+")"),r.centerLabel&&e.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),e.insert("rect",":first-child"),{shapeSvg:o,bbox:h,halfPadding:a,label:e}}),"insertLabel"),H=v((o,t)=>{let r=t.node().getBBox();o.width=r.width,o.height=r.height},"updateNodeBounds"),G=v((o,t)=>(o.look==="handDrawn"?"rough-node":"node")+" "+o.cssClasses+" "+(t||""),"getNodeClasses");function Z(o){let t=o.map((r,s)=>`${s===0?"M":"L"}${r.x},${r.y}`);return t.push("Z"),t.join(" ")}v(Z,"createPathFromPoints");function yt(o,t,r,s,e,i){let h=[],c=r-o,n=s-t,l=c/i,g=2*Math.PI/l,f=t+n/2;for(let p=0;p<=50;p++){let u=p/50,y=o+u*c,m=f+e*Math.sin(g*(y-o));h.push({x:y,y:m})}return h}v(yt,"generateFullSineWavePoints");function Wt(o,t,r,s,e,i){let h=[],a=e*Math.PI/180,l=(i*Math.PI/180-a)/(s-1);for(let g=0;g<s;g++){let f=a+g*l,p=o+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-p,y:-u})}return h}v(Wt,"generateCirclePoints");var fa=v((o,t)=>{var r=o.x,s=o.y,e=t.x-r,i=t.y-s,h=o.width/2,a=o.height/2,c,n;return Math.abs(i)*h>Math.abs(e)*a?(i<0&&(a=-a),c=i===0?0:a*e/i,n=a):(e<0&&(h=-h),c=h,n=e===0?0:h*i/e),{x:r+c,y:s+n}},"intersectRect"),$t=fa;function ze(o,t){t&&o.attr("style",t)}v(ze,"applyStyle");function je(o){return N(this,null,function*(){let t=K(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),r=t.append("xhtml:div"),s=U(),e=o.label;o.label&&Qt(o.label)&&(e=yield ke(o.label.replace(ve.lineBreakRegex,`
`),s));let h='<span class="'+(o.isNode?"nodeLabel":"edgeLabel")+'" '+(o.labelStyle?'style="'+o.labelStyle+'"':"")+">"+e+"</span>";return r.html(Ht(h,s)),ze(r,o.labelStyle),r.style("display","inline-block"),r.style("padding-right","1px"),r.style("white-space","nowrap"),r.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()})}v(je,"addHtmlLabel");var ua=v((o,t,r,s)=>N(null,null,function*(){let e=o||"";if(typeof e=="object"&&(e=e[0]),tt(U().flowchart.htmlLabels)){e=e.replace(/\\n|\n/g,"<br />"),Q.info("vertexText"+e);let i={isNode:s,label:St(e).replace(/fa[blrs]?:fa-[\w-]+/g,a=>`<i class='${a.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return yield je(i)}else{let i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let h=[];typeof e=="string"?h=e.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(e)?h=e:h=[];for(let a of h){let c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),c.setAttribute("dy","1em"),c.setAttribute("x","0"),r?c.setAttribute("class","title-row"):c.setAttribute("class","row"),c.textContent=a.trim(),i.appendChild(c)}return i}}),"createLabel"),me=ua,dt=v((o,t,r,s,e)=>["M",o+e,t,"H",o+r-e,"A",e,e,0,0,1,o+r,t+e,"V",t+s-e,"A",e,e,0,0,1,o+r-e,t+s,"H",o+e,"A",e,e,0,0,1,o,t+s-e,"V",t+e,"A",e,e,0,0,1,o+e,t,"Z"].join(" "),"createRoundedRectPathD"),Ge=v((o,t)=>N(null,null,function*(){Q.info("Creating subgraph rect for ",t.id,t);let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{clusterBkg:i,clusterBorder:h}=s,{labelStyles:a,nodeStyles:c,borderStyles:n,backgroundStyles:l}=T(t),g=o.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=tt(r.flowchart.htmlLabels),p=g.insert("g").attr("class","cluster-label "),u=yield ft(p,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0}),y=u.getBBox();if(tt(r.flowchart.htmlLabels)){let D=u.children[0],$=K(u);y=D.getBoundingClientRect(),$.attr("width",y.width),$.attr("height",y.height)}let m=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(m-t.width)/2-t.padding:t.diff=-t.padding;let d=t.height,x=t.x-m/2,w=t.y-d/2;Q.trace("Data ",t,JSON.stringify(t));let b;if(t.look==="handDrawn"){let D=k.svg(g),$=L(t,{roughness:.7,fill:i,stroke:h,fillWeight:3,seed:e}),P=D.path(dt(x,w,m,d,0),$);b=g.insert(()=>(Q.debug("Rough node insert CXC",P),P),":first-child"),b.select("path:nth-child(2)").attr("style",n.join(";")),b.select("path").attr("style",l.join(";").replace("fill","stroke"))}else b=g.insert("rect",":first-child"),b.attr("style",c).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",w).attr("width",m).attr("height",d);let{subGraphTitleTopMargin:S}=Kt(r);if(p.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+S})`),a){let D=p.select("span");D&&D.attr("style",a)}let M=b.node().getBBox();return t.offsetX=0,t.width=M.width,t.height=M.height,t.offsetY=y.height-t.padding/2,t.intersect=function(D){return $t(t,D)},{cluster:g,labelBBox:y}}),"rect"),ya=v((o,t)=>{let r=o.insert("g").attr("class","note-cluster").attr("id",t.id),s=r.insert("rect",":first-child"),e=0*t.padding,i=e/2;s.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+e).attr("height",t.height+e).attr("fill","none");let h=s.node().getBBox();return t.width=h.width,t.height=h.height,t.intersect=function(a){return $t(t,a)},{cluster:r,labelBBox:{width:0,height:0}}},"noteGroup"),da=v((o,t)=>N(null,null,function*(){let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{altBackground:i,compositeBackground:h,compositeTitleBackground:a,nodeBorder:c}=s,n=o.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),l=n.insert("g",":first-child"),g=n.insert("g").attr("class","cluster-label"),f=n.append("rect"),p=g.node().appendChild(yield me(t.label,t.labelStyle,void 0,!0)),u=p.getBBox();if(tt(r.flowchart.htmlLabels)){let P=p.children[0],C=K(p);u=P.getBoundingClientRect(),C.attr("width",u.width),C.attr("height",u.height)}let y=0*t.padding,m=y/2,d=(t.width<=u.width+t.padding?u.width+t.padding:t.width)+y;t.width<=u.width+t.padding?t.diff=(d-t.width)/2-t.padding:t.diff=-t.padding;let x=t.height+y,w=t.height+y-u.height-6,b=t.x-d/2,S=t.y-x/2;t.width=d;let M=t.y-t.height/2-m+u.height+2,D;if(t.look==="handDrawn"){let P=t.cssClasses.includes("statediagram-cluster-alt"),C=k.svg(n),O=t.rx||t.ry?C.path(dt(b,S,d,x,10),{roughness:.7,fill:a,fillStyle:"solid",stroke:c,seed:e}):C.rectangle(b,S,d,x,{seed:e});D=n.insert(()=>O,":first-child");let V=C.rectangle(b,M,d,w,{fill:P?i:h,fillStyle:P?"hachure":"solid",stroke:c,seed:e});D=n.insert(()=>O,":first-child"),f=n.insert(()=>V)}else D=l.insert("rect",":first-child"),D.attr("class","outer").attr("x",b).attr("y",S).attr("width",d).attr("height",x).attr("data-look",t.look),f.attr("class","inner").attr("x",b).attr("y",M).attr("width",d).attr("height",w);g.attr("transform",`translate(${t.x-u.width/2}, ${S+1-(tt(r.flowchart.htmlLabels)?0:3)})`);let $=D.node().getBBox();return t.height=$.height,t.offsetX=0,t.offsetY=u.height-t.padding/2,t.labelBBox=u,t.intersect=function(P){return $t(t,P)},{cluster:n,labelBBox:u}}),"roundedWithTitle"),ma=v((o,t)=>N(null,null,function*(){Q.info("Creating subgraph rect for ",t.id,t);let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{clusterBkg:i,clusterBorder:h}=s,{labelStyles:a,nodeStyles:c,borderStyles:n,backgroundStyles:l}=T(t),g=o.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=tt(r.flowchart.htmlLabels),p=g.insert("g").attr("class","cluster-label "),u=yield ft(p,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0,width:t.width}),y=u.getBBox();if(tt(r.flowchart.htmlLabels)){let D=u.children[0],$=K(u);y=D.getBoundingClientRect(),$.attr("width",y.width),$.attr("height",y.height)}let m=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(m-t.width)/2-t.padding:t.diff=-t.padding;let d=t.height,x=t.x-m/2,w=t.y-d/2;Q.trace("Data ",t,JSON.stringify(t));let b;if(t.look==="handDrawn"){let D=k.svg(g),$=L(t,{roughness:.7,fill:i,stroke:h,fillWeight:4,seed:e}),P=D.path(dt(x,w,m,d,t.rx),$);b=g.insert(()=>(Q.debug("Rough node insert CXC",P),P),":first-child"),b.select("path:nth-child(2)").attr("style",n.join(";")),b.select("path").attr("style",l.join(";").replace("fill","stroke"))}else b=g.insert("rect",":first-child"),b.attr("style",c).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",w).attr("width",m).attr("height",d);let{subGraphTitleTopMargin:S}=Kt(r);if(p.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+S})`),a){let D=p.select("span");D&&D.attr("style",a)}let M=b.node().getBBox();return t.offsetX=0,t.width=M.width,t.height=M.height,t.offsetY=y.height-t.padding/2,t.intersect=function(D){return $t(t,D)},{cluster:g,labelBBox:y}}),"kanbanSection"),xa=v((o,t)=>{let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{nodeBorder:i}=s,h=o.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),a=h.insert("g",":first-child"),c=0*t.padding,n=t.width+c;t.diff=-t.padding;let l=t.height+c,g=t.x-n/2,f=t.y-l/2;t.width=n;let p;if(t.look==="handDrawn"){let m=k.svg(h).rectangle(g,f,n,l,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:e});p=h.insert(()=>m,":first-child")}else p=a.insert("rect",":first-child"),p.attr("class","divider").attr("x",g).attr("y",f).attr("width",n).attr("height",l).attr("data-look",t.look);let u=p.node().getBBox();return t.height=u.height,t.offsetX=0,t.offsetY=0,t.intersect=function(y){return $t(t,y)},{cluster:h,labelBBox:{}}},"divider"),ba=Ge,wa={rect:Ge,squareRect:ba,roundedWithTitle:da,noteGroup:ya,divider:xa,kanbanSection:ma},Fe=new Map,Ja=v((o,t)=>N(null,null,function*(){let r=t.shape||"rect",s=yield wa[r](o,t);return Fe.set(t.id,s),s}),"insertCluster"),Ka=v(()=>{Fe=new Map},"clear");function qe(o,t){return o.intersect(t)}v(qe,"intersectNode");var Sa=qe;function Xe(o,t,r,s){var e=o.x,i=o.y,h=e-s.x,a=i-s.y,c=Math.sqrt(t*t*a*a+r*r*h*h),n=Math.abs(t*r*h/c);s.x<e&&(n=-n);var l=Math.abs(t*r*a/c);return s.y<i&&(l=-l),{x:e+n,y:i+l}}v(Xe,"intersectEllipse");var Ye=Xe;function Ve(o,t,r){return Ye(o,t,t,r)}v(Ve,"intersectCircle");var Ma=Ve;function Ze(o,t,r,s){var e,i,h,a,c,n,l,g,f,p,u,y,m,d,x;if(e=t.y-o.y,h=o.x-t.x,c=t.x*o.y-o.x*t.y,f=e*r.x+h*r.y+c,p=e*s.x+h*s.y+c,!(f!==0&&p!==0&&xe(f,p))&&(i=s.y-r.y,a=r.x-s.x,n=s.x*r.y-r.x*s.y,l=i*o.x+a*o.y+n,g=i*t.x+a*t.y+n,!(l!==0&&g!==0&&xe(l,g))&&(u=e*a-i*h,u!==0)))return y=Math.abs(u/2),m=h*n-a*c,d=m<0?(m-y)/u:(m+y)/u,m=i*c-e*n,x=m<0?(m-y)/u:(m+y)/u,{x:d,y:x}}v(Ze,"intersectLine");function xe(o,t){return o*t>0}v(xe,"sameSign");var ka=Ze;function Qe(o,t,r){let s=o.x,e=o.y,i=[],h=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(l){h=Math.min(h,l.x),a=Math.min(a,l.y)}):(h=Math.min(h,t.x),a=Math.min(a,t.y));let c=s-o.width/2-h,n=e-o.height/2-a;for(let l=0;l<t.length;l++){let g=t[l],f=t[l<t.length-1?l+1:0],p=ka(o,r,{x:c+g.x,y:n+g.y},{x:c+f.x,y:n+f.y});p&&i.push(p)}return i.length?(i.length>1&&i.sort(function(l,g){let f=l.x-r.x,p=l.y-r.y,u=Math.sqrt(f*f+p*p),y=g.x-r.x,m=g.y-r.y,d=Math.sqrt(y*y+m*m);return u<d?-1:u===d?0:1}),i[0]):o}v(Qe,"intersectPolygon");var va=Qe,A={node:Sa,circle:Ma,ellipse:Ye,polygon:va,rect:$t};function Je(o,t){let{labelStyles:r}=T(t);t.labelStyle=r;let s=G(t),e=s;s||(e="anchor");let i=o.insert("g").attr("class",e).attr("id",t.domId||t.id),h=1,{cssStyles:a}=t,c=k.svg(i),n=L(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(n.roughness=0);let l=c.circle(0,0,h*2,n),g=i.insert(()=>l,":first-child");return g.attr("class","anchor").attr("style",rt(a)),H(t,g),t.intersect=function(f){return Q.info("Circle intersect",t,h,f),A.circle(t,h,f)},i}v(Je,"anchor");function be(o,t,r,s,e,i,h){let c=(o+r)/2,n=(t+s)/2,l=Math.atan2(s-t,r-o),g=(r-o)/2,f=(s-t)/2,p=g/e,u=f/i,y=Math.sqrt(p**2+u**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");let m=Math.sqrt(1-y**2),d=c+m*i*Math.sin(l)*(h?-1:1),x=n-m*e*Math.cos(l)*(h?-1:1),w=Math.atan2((t-x)/i,(o-d)/e),S=Math.atan2((s-x)/i,(r-d)/e)-w;h&&S<0&&(S+=2*Math.PI),!h&&S>0&&(S-=2*Math.PI);let M=[];for(let D=0;D<20;D++){let $=D/19,P=w+$*S,C=d+e*Math.cos(P),O=x+i*Math.sin(P);M.push({x:C,y:O})}return M}v(be,"generateArcPoints");function Ke(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=i.width+t.padding+20,a=i.height+t.padding,c=a/2,n=c/(2.5+a/50),{cssStyles:l}=t,g=[{x:h/2,y:-a/2},{x:-h/2,y:-a/2},...be(-h/2,-a/2,-h/2,a/2,n,c,!1),{x:h/2,y:a/2},...be(h/2,a/2,h/2,-a/2,n,c,!0)],f=k.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=Z(g),y=f.path(u,p),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),l&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",l),s&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",s),m.attr("transform",`translate(${n/2}, 0)`),H(t,m),t.intersect=function(d){return A.polygon(t,g,d)},e})}v(Ke,"bowTieRect");function mt(o,t,r,s){return o.insert("polygon",":first-child").attr("points",s.map(function(e){return e.x+","+e.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+r/2+")")}v(mt,"insertPolygonShape");function Ue(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=i.height+t.padding,a=12,c=i.width+t.padding+a,n=0,l=c,g=-h,f=0,p=[{x:n+a,y:g},{x:l,y:g},{x:l,y:f},{x:n,y:f},{x:n,y:g+a},{x:n+a,y:g}],u,{cssStyles:y}=t;if(t.look==="handDrawn"){let m=k.svg(e),d=L(t,{}),x=Z(p),w=m.path(x,d);u=e.insert(()=>w,":first-child").attr("transform",`translate(${-c/2}, ${h/2})`),y&&u.attr("style",y)}else u=mt(e,c,h,p);return s&&u.attr("style",s),H(t,u),t.intersect=function(m){return A.polygon(t,p,m)},e})}v(Ue,"card");function ts(o,t){let{nodeStyles:r}=T(t);t.label="";let s=o.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),{cssStyles:e}=t,i=Math.max(28,t.width??0),h=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],a=k.svg(s),c=L(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let n=Z(h),l=a.path(n,c),g=s.insert(()=>l,":first-child");return e&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",e),r&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",r),t.width=28,t.height=28,t.intersect=function(f){return A.polygon(t,h,f)},s}v(ts,"choice");function es(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,halfPadding:h}=yield X(o,t,G(t)),a=i.width/2+h,c,{cssStyles:n}=t;if(t.look==="handDrawn"){let l=k.svg(e),g=L(t,{}),f=l.circle(0,0,a*2,g);c=e.insert(()=>f,":first-child"),c.attr("class","basic label-container").attr("style",rt(n))}else c=e.insert("circle",":first-child").attr("class","basic label-container").attr("style",s).attr("r",a).attr("cx",0).attr("cy",0);return H(t,c),t.intersect=function(l){return Q.info("Circle intersect",t,a,l),A.circle(t,a,l)},e})}v(es,"circle");function ss(o){let t=Math.cos(Math.PI/4),r=Math.sin(Math.PI/4),s=o*2,e={x:s/2*t,y:s/2*r},i={x:-(s/2)*t,y:s/2*r},h={x:-(s/2)*t,y:-(s/2)*r},a={x:s/2*t,y:-(s/2)*r};return`M ${i.x},${i.y} L ${a.x},${a.y}
                   M ${e.x},${e.y} L ${h.x},${h.y}`}v(ss,"createLine");function as(o,t){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r,t.label="";let e=o.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),i=Math.max(30,t?.width??0),{cssStyles:h}=t,a=k.svg(e),c=L(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let n=a.circle(0,0,i*2,c),l=ss(i),g=a.path(l,c),f=e.insert(()=>n,":first-child");return f.insert(()=>g),h&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",s),H(t,f),t.intersect=function(p){return Q.info("crossedCircle intersect",t,{radius:i,point:p}),A.circle(t,i,p)},e}v(as,"crossedCircle");function ht(o,t,r,s=100,e=0,i=180){let h=[],a=e*Math.PI/180,l=(i*Math.PI/180-a)/(s-1);for(let g=0;g<s;g++){let f=a+g*l,p=o+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-p,y:-u})}return h}v(ht,"generateCirclePoints");function rs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=i.width+(t.padding??0),c=i.height+(t.padding??0),n=Math.max(5,c*.1),{cssStyles:l}=t,g=[...ht(a/2,-c/2,n,30,-90,0),{x:-a/2-n,y:n},...ht(a/2+n*2,-n,n,20,-180,-270),...ht(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:-c/2},...ht(a/2,c/2,n,20,0,90)],f=[{x:a/2,y:-c/2-n},{x:-a/2,y:-c/2-n},...ht(a/2,-c/2,n,20,-90,0),{x:-a/2-n,y:-n},...ht(a/2+a*.1,-n,n,20,-180,-270),...ht(a/2+a*.1,n,n,20,-90,-180),{x:-a/2-n,y:c/2},...ht(a/2,c/2,n,20,0,90),{x:-a/2,y:c/2+n},{x:a/2,y:c/2+n}],p=k.svg(e),u=L(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=Z(g).replace("Z",""),d=p.path(m,u),x=Z(f),w=p.path(x,st({},u)),b=e.insert("g",":first-child");return b.insert(()=>w,":first-child").attr("stroke-opacity",0),b.insert(()=>d,":first-child"),b.attr("class","text"),l&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",l),s&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",s),b.attr("transform",`translate(${n}, 0)`),h.attr("transform",`translate(${-a/2+n-(i.x-(i.left??0))},${-c/2+(t.padding??0)/2-(i.y-(i.top??0))})`),H(t,b),t.intersect=function(S){return A.polygon(t,f,S)},e})}v(rs,"curlyBraceLeft");function gt(o,t,r,s=100,e=0,i=180){let h=[],a=e*Math.PI/180,l=(i*Math.PI/180-a)/(s-1);for(let g=0;g<s;g++){let f=a+g*l,p=o+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:p,y:u})}return h}v(gt,"generateCirclePoints");function is(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=i.width+(t.padding??0),c=i.height+(t.padding??0),n=Math.max(5,c*.1),{cssStyles:l}=t,g=[...gt(a/2,-c/2,n,20,-90,0),{x:a/2+n,y:-n},...gt(a/2+n*2,-n,n,20,-180,-270),...gt(a/2+n*2,n,n,20,-90,-180),{x:a/2+n,y:c/2},...gt(a/2,c/2,n,20,0,90)],f=[{x:-a/2,y:-c/2-n},{x:a/2,y:-c/2-n},...gt(a/2,-c/2,n,20,-90,0),{x:a/2+n,y:-n},...gt(a/2+n*2,-n,n,20,-180,-270),...gt(a/2+n*2,n,n,20,-90,-180),{x:a/2+n,y:c/2},...gt(a/2,c/2,n,20,0,90),{x:a/2,y:c/2+n},{x:-a/2,y:c/2+n}],p=k.svg(e),u=L(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=Z(g).replace("Z",""),d=p.path(m,u),x=Z(f),w=p.path(x,st({},u)),b=e.insert("g",":first-child");return b.insert(()=>w,":first-child").attr("stroke-opacity",0),b.insert(()=>d,":first-child"),b.attr("class","text"),l&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",l),s&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",s),b.attr("transform",`translate(${-n}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(i.x-(i.left??0))},${-c/2+(t.padding??0)/2-(i.y-(i.top??0))})`),H(t,b),t.intersect=function(S){return A.polygon(t,f,S)},e})}v(is,"curlyBraceRight");function et(o,t,r,s=100,e=0,i=180){let h=[],a=e*Math.PI/180,l=(i*Math.PI/180-a)/(s-1);for(let g=0;g<s;g++){let f=a+g*l,p=o+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-p,y:-u})}return h}v(et,"generateCirclePoints");function ns(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=i.width+(t.padding??0),c=i.height+(t.padding??0),n=Math.max(5,c*.1),{cssStyles:l}=t,g=[...et(a/2,-c/2,n,30,-90,0),{x:-a/2-n,y:n},...et(a/2+n*2,-n,n,20,-180,-270),...et(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:-c/2},...et(a/2,c/2,n,20,0,90)],f=[...et(-a/2+n+n/2,-c/2,n,20,-90,-180),{x:a/2-n/2,y:n},...et(-a/2-n/2,-n,n,20,0,90),...et(-a/2-n/2,n,n,20,-90,0),{x:a/2-n/2,y:-n},...et(-a/2+n+n/2,c/2,n,30,-180,-270)],p=[{x:a/2,y:-c/2-n},{x:-a/2,y:-c/2-n},...et(a/2,-c/2,n,20,-90,0),{x:-a/2-n,y:-n},...et(a/2+n*2,-n,n,20,-180,-270),...et(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:c/2},...et(a/2,c/2,n,20,0,90),{x:-a/2,y:c/2+n},{x:a/2-n-n/2,y:c/2+n},...et(-a/2+n+n/2,-c/2,n,20,-90,-180),{x:a/2-n/2,y:n},...et(-a/2-n/2,-n,n,20,0,90),...et(-a/2-n/2,n,n,20,-90,0),{x:a/2-n/2,y:-n},...et(-a/2+n+n/2,c/2,n,30,-180,-270)],u=k.svg(e),y=L(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let d=Z(g).replace("Z",""),x=u.path(d,y),b=Z(f).replace("Z",""),S=u.path(b,y),M=Z(p),D=u.path(M,st({},y)),$=e.insert("g",":first-child");return $.insert(()=>D,":first-child").attr("stroke-opacity",0),$.insert(()=>x,":first-child"),$.insert(()=>S,":first-child"),$.attr("class","text"),l&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",l),s&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",s),$.attr("transform",`translate(${n-n/4}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(i.x-(i.left??0))},${-c/2+(t.padding??0)/2-(i.y-(i.top??0))})`),H(t,$),t.intersect=function(P){return A.polygon(t,p,P)},e})}v(ns,"curlyBraces");function ls(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=80,a=20,c=Math.max(h,(i.width+(t.padding??0)*2)*1.25,t?.width??0),n=Math.max(a,i.height+(t.padding??0)*2,t?.height??0),l=n/2,{cssStyles:g}=t,f=k.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=c,y=n,m=u-l,d=y/4,x=[{x:m,y:0},{x:d,y:0},{x:0,y:y/2},{x:d,y},{x:m,y},...Wt(-m,-y/2,l,50,270,90)],w=Z(x),b=f.path(w,p),S=e.insert(()=>b,":first-child");return S.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&S.selectChildren("path").attr("style",g),s&&t.look!=="handDrawn"&&S.selectChildren("path").attr("style",s),S.attr("transform",`translate(${-c/2}, ${-n/2})`),H(t,S),t.intersect=function(M){return A.polygon(t,x,M)},e})}v(ls,"curvedTrapezoid");var $a=v((o,t,r,s,e,i)=>[`M${o},${t+i}`,`a${e},${i} 0,0,0 ${r},0`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`].join(" "),"createCylinderPathD"),Da=v((o,t,r,s,e,i)=>[`M${o},${t+i}`,`M${o+r},${t+i}`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`].join(" "),"createOuterCylinderPathD"),Pa=v((o,t,r,s,e,i)=>[`M${o-r/2},${-s/2}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");function cs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+t.padding,t.width??0),c=a/2,n=c/(2.5+a/50),l=Math.max(i.height+n+t.padding,t.height??0),g,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=k.svg(e),u=Da(0,0,a,l,c,n),y=Pa(0,n,a,l,c,n),m=p.path(u,L(t,{})),d=p.path(y,L(t,{fill:"none"}));g=e.insert(()=>d,":first-child"),g=e.insert(()=>m,":first-child"),g.attr("class","basic label-container"),f&&g.attr("style",f)}else{let p=$a(0,0,a,l,c,n);g=e.insert("path",":first-child").attr("d",p).attr("class","basic label-container").attr("style",rt(f)).attr("style",s)}return g.attr("label-offset-y",n),g.attr("transform",`translate(${-a/2}, ${-(l/2+n)})`),H(t,g),h.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(p){let u=A.rect(t,p),y=u.x-(t.x??0);if(c!=0&&(Math.abs(y)<(t.width??0)/2||Math.abs(y)==(t.width??0)/2&&Math.abs(u.y-(t.y??0))>(t.height??0)/2-n)){let m=n*n*(1-y*y/(c*c));m>0&&(m=Math.sqrt(m)),m=n-m,p.y-(t.y??0)>0&&(m=-m),u.y+=m}return u},e})}v(cs,"cylinder");function os(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=i.width+t.padding,c=i.height+t.padding,n=c*.2,l=-a/2,g=-c/2-n/2,{cssStyles:f}=t,p=k.svg(e),u=L(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:l,y:g+n},{x:-l,y:g+n},{x:-l,y:-g},{x:l,y:-g},{x:l,y:g},{x:-l,y:g},{x:-l,y:g+n}],m=p.polygon(y.map(x=>[x.x,x.y]),u),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),h.attr("transform",`translate(${l+(t.padding??0)/2-(i.x-(i.left??0))}, ${g+n+(t.padding??0)/2-(i.y-(i.top??0))})`),H(t,d),t.intersect=function(x){return A.rect(t,x)},e})}v(os,"dividedRectangle");function hs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,halfPadding:h}=yield X(o,t,G(t)),c=i.width/2+h+5,n=i.width/2+h,l,{cssStyles:g}=t;if(t.look==="handDrawn"){let f=k.svg(e),p=L(t,{roughness:.2,strokeWidth:2.5}),u=L(t,{roughness:.2,strokeWidth:1.5}),y=f.circle(0,0,c*2,p),m=f.circle(0,0,n*2,u);l=e.insert("g",":first-child"),l.attr("class",rt(t.cssClasses)).attr("style",rt(g)),l.node()?.appendChild(y),l.node()?.appendChild(m)}else{l=e.insert("g",":first-child");let f=l.insert("circle",":first-child"),p=l.insert("circle");l.attr("class","basic label-container").attr("style",s),f.attr("class","outer-circle").attr("style",s).attr("r",c).attr("cx",0).attr("cy",0),p.attr("class","inner-circle").attr("style",s).attr("r",n).attr("cx",0).attr("cy",0)}return H(t,l),t.intersect=function(f){return Q.info("DoubleCircle intersect",t,c,f),A.circle(t,c,f)},e})}v(hs,"doublecircle");function gs(o,t,{config:{themeVariables:r}}){let{labelStyles:s,nodeStyles:e}=T(t);t.label="",t.labelStyle=s;let i=o.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),h=7,{cssStyles:a}=t,c=k.svg(i),{nodeBorder:n}=r,l=L(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(l.roughness=0);let g=c.circle(0,0,h*2,l),f=i.insert(()=>g,":first-child");return f.selectAll("path").attr("style",`fill: ${n} !important;`),a&&a.length>0&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",a),e&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",e),H(t,f),t.intersect=function(p){return Q.info("filledCircle intersect",t,{radius:h,point:p}),A.circle(t,h,p)},i}v(gs,"filledCircle");function ps(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=i.width+(t.padding??0),c=a+i.height,n=a+i.height,l=[{x:0,y:-c},{x:n,y:-c},{x:n/2,y:0}],{cssStyles:g}=t,f=k.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=Z(l),y=f.path(u,p),m=e.insert(()=>y,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return g&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",g),s&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",s),t.width=a,t.height=c,H(t,m),h.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-c/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(d){return Q.info("Triangle intersect",t,l,d),A.polygon(t,l,d)},e})}v(ps,"flippedTriangle");function fs(o,t,{dir:r,config:{state:s,themeVariables:e}}){let{nodeStyles:i}=T(t);t.label="";let h=o.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),{cssStyles:a}=t,c=Math.max(70,t?.width??0),n=Math.max(10,t?.height??0);r==="LR"&&(c=Math.max(10,t?.width??0),n=Math.max(70,t?.height??0));let l=-1*c/2,g=-1*n/2,f=k.svg(h),p=L(t,{stroke:e.lineColor,fill:e.lineColor});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=f.rectangle(l,g,c,n,p),y=h.insert(()=>u,":first-child");a&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",a),i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),H(t,y);let m=s?.padding??0;return t.width&&t.height&&(t.width+=m/2||0,t.height+=m/2||0),t.intersect=function(d){return A.rect(t,d)},h}v(fs,"forkJoin");function us(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let e=80,i=50,{shapeSvg:h,bbox:a}=yield X(o,t,G(t)),c=Math.max(e,a.width+(t.padding??0)*2,t?.width??0),n=Math.max(i,a.height+(t.padding??0)*2,t?.height??0),l=n/2,{cssStyles:g}=t,f=k.svg(h),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:-c/2,y:-n/2},{x:c/2-l,y:-n/2},...Wt(-c/2+l,0,l,50,90,270),{x:c/2-l,y:n/2},{x:-c/2,y:n/2}],y=Z(u),m=f.path(y,p),d=h.insert(()=>m,":first-child");return d.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",g),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),H(t,d),t.intersect=function(x){return Q.info("Pill intersect",t,{radius:l,point:x}),A.polygon(t,u,x)},h})}v(us,"halfRoundedRectangle");function ys(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=i.height+(t.padding??0),a=i.width+(t.padding??0)*2.5,{cssStyles:c}=t,n=k.svg(e),l=L(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");let g=a/2,f=g/6;g=g+f;let p=h/2,u=p/2,y=g-u,m=[{x:-y,y:-p},{x:0,y:-p},{x:y,y:-p},{x:g,y:0},{x:y,y:p},{x:0,y:p},{x:-y,y:p},{x:-g,y:0}],d=Z(m),x=n.path(d,l),w=e.insert(()=>x,":first-child");return w.attr("class","basic label-container"),c&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",c),s&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",s),t.width=a,t.height=h,H(t,w),t.intersect=function(b){return A.polygon(t,m,b)},e})}v(ys,"hexagon");function ds(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.label="",t.labelStyle=r;let{shapeSvg:e}=yield X(o,t,G(t)),i=Math.max(30,t?.width??0),h=Math.max(30,t?.height??0),{cssStyles:a}=t,c=k.svg(e),n=L(t,{});t.look!=="handDrawn"&&(n.roughness=0,n.fillStyle="solid");let l=[{x:0,y:0},{x:i,y:0},{x:0,y:h},{x:i,y:h}],g=Z(l),f=c.path(g,n),p=e.insert(()=>f,":first-child");return p.attr("class","basic label-container"),a&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",a),s&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",s),p.attr("transform",`translate(${-i/2}, ${-h/2})`),H(t,p),t.intersect=function(u){return Q.info("Pill intersect",t,{points:l}),A.polygon(t,l,u)},e})}v(ds,"hourglass");function ms(e,i,h){return N(this,arguments,function*(o,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=T(t);t.labelStyle=a;let c=t.assetHeight??48,n=t.assetWidth??48,l=Math.max(c,n),g=s?.wrappingWidth;t.width=Math.max(l,g??0);let{shapeSvg:f,bbox:p,label:u}=yield X(o,t,"icon-shape default"),y=t.pos==="t",m=l,d=l,{nodeBorder:x}=r,{stylesMap:w}=Dt(t),b=-d/2,S=-m/2,M=t.label?8:0,D=k.svg(f),$=L(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&($.roughness=0,$.fillStyle="solid");let P=D.rectangle(b,S,d,m,$),C=Math.max(d,p.width),O=m+p.height+M,V=D.rectangle(-C/2,-O/2,C,O,lt(st({},$),{fill:"transparent",stroke:"none"})),E=f.insert(()=>P,":first-child"),B=f.insert(()=>V);if(t.icon){let I=f.append("g");I.html(`<g>${yield Bt(t.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);let R=I.node().getBBox(),q=R.width,z=R.height,W=R.x,F=R.y;I.attr("transform",`translate(${-q/2-W},${y?p.height/2+M/2-z/2-F:-p.height/2-M/2-z/2-F})`),I.attr("style",`color: ${w.get("stroke")??x};`)}return u.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${y?-O/2:O/2-p.height})`),E.attr("transform",`translate(0,${y?p.height/2+M/2:-p.height/2-M/2})`),H(t,B),t.intersect=function(I){if(Q.info("iconSquare intersect",t,I),!t.label)return A.rect(t,I);let R=t.x??0,q=t.y??0,z=t.height??0,W=[];return y?W=[{x:R-p.width/2,y:q-z/2},{x:R+p.width/2,y:q-z/2},{x:R+p.width/2,y:q-z/2+p.height+M},{x:R+d/2,y:q-z/2+p.height+M},{x:R+d/2,y:q+z/2},{x:R-d/2,y:q+z/2},{x:R-d/2,y:q-z/2+p.height+M},{x:R-p.width/2,y:q-z/2+p.height+M}]:W=[{x:R-d/2,y:q-z/2},{x:R+d/2,y:q-z/2},{x:R+d/2,y:q-z/2+m},{x:R+p.width/2,y:q-z/2+m},{x:R+p.width/2/2,y:q+z/2},{x:R-p.width/2,y:q+z/2},{x:R-p.width/2,y:q-z/2+m},{x:R-d/2,y:q-z/2+m}],A.polygon(t,W,I)},f})}v(ms,"icon");function xs(e,i,h){return N(this,arguments,function*(o,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=T(t);t.labelStyle=a;let c=t.assetHeight??48,n=t.assetWidth??48,l=Math.max(c,n),g=s?.wrappingWidth;t.width=Math.max(l,g??0);let{shapeSvg:f,bbox:p,label:u}=yield X(o,t,"icon-shape default"),y=20,m=t.label?8:0,d=t.pos==="t",{nodeBorder:x,mainBkg:w}=r,{stylesMap:b}=Dt(t),S=k.svg(f),M=L(t,{});t.look!=="handDrawn"&&(M.roughness=0,M.fillStyle="solid");let D=b.get("fill");M.stroke=D??w;let $=f.append("g");t.icon&&$.html(`<g>${yield Bt(t.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);let P=$.node().getBBox(),C=P.width,O=P.height,V=P.x,E=P.y,B=Math.max(C,O)*Math.SQRT2+y*2,I=S.circle(0,0,B,M),R=Math.max(B,p.width),q=B+p.height+m,z=S.rectangle(-R/2,-q/2,R,q,lt(st({},M),{fill:"transparent",stroke:"none"})),W=f.insert(()=>I,":first-child"),F=f.insert(()=>z);return $.attr("transform",`translate(${-C/2-V},${d?p.height/2+m/2-O/2-E:-p.height/2-m/2-O/2-E})`),$.attr("style",`color: ${b.get("stroke")??x};`),u.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${d?-q/2:q/2-p.height})`),W.attr("transform",`translate(0,${d?p.height/2+m/2:-p.height/2-m/2})`),H(t,F),t.intersect=function(_){return Q.info("iconSquare intersect",t,_),A.rect(t,_)},f})}v(xs,"iconCircle");function bs(e,i,h){return N(this,arguments,function*(o,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=T(t);t.labelStyle=a;let c=t.assetHeight??48,n=t.assetWidth??48,l=Math.max(c,n),g=s?.wrappingWidth;t.width=Math.max(l,g??0);let{shapeSvg:f,bbox:p,halfPadding:u,label:y}=yield X(o,t,"icon-shape default"),m=t.pos==="t",d=l+u*2,x=l+u*2,{nodeBorder:w,mainBkg:b}=r,{stylesMap:S}=Dt(t),M=-x/2,D=-d/2,$=t.label?8:0,P=k.svg(f),C=L(t,{});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");let O=S.get("fill");C.stroke=O??b;let V=P.path(dt(M,D,x,d,5),C),E=Math.max(x,p.width),B=d+p.height+$,I=P.rectangle(-E/2,-B/2,E,B,lt(st({},C),{fill:"transparent",stroke:"none"})),R=f.insert(()=>V,":first-child").attr("class","icon-shape2"),q=f.insert(()=>I);if(t.icon){let z=f.append("g");z.html(`<g>${yield Bt(t.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);let W=z.node().getBBox(),F=W.width,_=W.height,Y=W.x,J=W.y;z.attr("transform",`translate(${-F/2-Y},${m?p.height/2+$/2-_/2-J:-p.height/2-$/2-_/2-J})`),z.attr("style",`color: ${S.get("stroke")??w};`)}return y.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${m?-B/2:B/2-p.height})`),R.attr("transform",`translate(0,${m?p.height/2+$/2:-p.height/2-$/2})`),H(t,q),t.intersect=function(z){if(Q.info("iconSquare intersect",t,z),!t.label)return A.rect(t,z);let W=t.x??0,F=t.y??0,_=t.height??0,Y=[];return m?Y=[{x:W-p.width/2,y:F-_/2},{x:W+p.width/2,y:F-_/2},{x:W+p.width/2,y:F-_/2+p.height+$},{x:W+x/2,y:F-_/2+p.height+$},{x:W+x/2,y:F+_/2},{x:W-x/2,y:F+_/2},{x:W-x/2,y:F-_/2+p.height+$},{x:W-p.width/2,y:F-_/2+p.height+$}]:Y=[{x:W-x/2,y:F-_/2},{x:W+x/2,y:F-_/2},{x:W+x/2,y:F-_/2+d},{x:W+p.width/2,y:F-_/2+d},{x:W+p.width/2/2,y:F+_/2},{x:W-p.width/2,y:F+_/2},{x:W-p.width/2,y:F-_/2+d},{x:W-x/2,y:F-_/2+d}],A.polygon(t,Y,z)},f})}v(bs,"iconRounded");function ws(e,i,h){return N(this,arguments,function*(o,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=T(t);t.labelStyle=a;let c=t.assetHeight??48,n=t.assetWidth??48,l=Math.max(c,n),g=s?.wrappingWidth;t.width=Math.max(l,g??0);let{shapeSvg:f,bbox:p,halfPadding:u,label:y}=yield X(o,t,"icon-shape default"),m=t.pos==="t",d=l+u*2,x=l+u*2,{nodeBorder:w,mainBkg:b}=r,{stylesMap:S}=Dt(t),M=-x/2,D=-d/2,$=t.label?8:0,P=k.svg(f),C=L(t,{});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");let O=S.get("fill");C.stroke=O??b;let V=P.path(dt(M,D,x,d,.1),C),E=Math.max(x,p.width),B=d+p.height+$,I=P.rectangle(-E/2,-B/2,E,B,lt(st({},C),{fill:"transparent",stroke:"none"})),R=f.insert(()=>V,":first-child"),q=f.insert(()=>I);if(t.icon){let z=f.append("g");z.html(`<g>${yield Bt(t.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);let W=z.node().getBBox(),F=W.width,_=W.height,Y=W.x,J=W.y;z.attr("transform",`translate(${-F/2-Y},${m?p.height/2+$/2-_/2-J:-p.height/2-$/2-_/2-J})`),z.attr("style",`color: ${S.get("stroke")??w};`)}return y.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${m?-B/2:B/2-p.height})`),R.attr("transform",`translate(0,${m?p.height/2+$/2:-p.height/2-$/2})`),H(t,q),t.intersect=function(z){if(Q.info("iconSquare intersect",t,z),!t.label)return A.rect(t,z);let W=t.x??0,F=t.y??0,_=t.height??0,Y=[];return m?Y=[{x:W-p.width/2,y:F-_/2},{x:W+p.width/2,y:F-_/2},{x:W+p.width/2,y:F-_/2+p.height+$},{x:W+x/2,y:F-_/2+p.height+$},{x:W+x/2,y:F+_/2},{x:W-x/2,y:F+_/2},{x:W-x/2,y:F-_/2+p.height+$},{x:W-p.width/2,y:F-_/2+p.height+$}]:Y=[{x:W-x/2,y:F-_/2},{x:W+x/2,y:F-_/2},{x:W+x/2,y:F-_/2+d},{x:W+p.width/2,y:F-_/2+d},{x:W+p.width/2/2,y:F+_/2},{x:W-p.width/2,y:F+_/2},{x:W-p.width/2,y:F-_/2+d},{x:W-x/2,y:F-_/2+d}],A.polygon(t,Y,z)},f})}v(ws,"iconSquare");function Ss(s,e,i){return N(this,arguments,function*(o,t,{config:{flowchart:r}}){let h=new Image;h.src=t?.img??"",yield h.decode();let a=Number(h.naturalWidth.toString().replace("px","")),c=Number(h.naturalHeight.toString().replace("px",""));t.imageAspectRatio=a/c;let{labelStyles:n}=T(t);t.labelStyle=n;let l=r?.wrappingWidth;t.defaultWidth=r?.wrappingWidth;let g=Math.max(t.label?l??0:0,t?.assetWidth??a),f=t.constraint==="on"&&t?.assetHeight?t.assetHeight*t.imageAspectRatio:g,p=t.constraint==="on"?f/t.imageAspectRatio:t?.assetHeight??c;t.width=Math.max(f,l??0);let{shapeSvg:u,bbox:y,label:m}=yield X(o,t,"image-shape default"),d=t.pos==="t",x=-f/2,w=-p/2,b=t.label?8:0,S=k.svg(u),M=L(t,{});t.look!=="handDrawn"&&(M.roughness=0,M.fillStyle="solid");let D=S.rectangle(x,w,f,p,M),$=Math.max(f,y.width),P=p+y.height+b,C=S.rectangle(-$/2,-P/2,$,P,lt(st({},M),{fill:"none",stroke:"none"})),O=u.insert(()=>D,":first-child"),V=u.insert(()=>C);if(t.img){let E=u.append("image");E.attr("href",t.img),E.attr("width",f),E.attr("height",p),E.attr("preserveAspectRatio","none"),E.attr("transform",`translate(${-f/2},${d?P/2-p:-P/2})`)}return m.attr("transform",`translate(${-y.width/2-(y.x-(y.left??0))},${d?-p/2-y.height/2-b/2:p/2-y.height/2+b/2})`),O.attr("transform",`translate(0,${d?y.height/2+b/2:-y.height/2-b/2})`),H(t,V),t.intersect=function(E){if(Q.info("iconSquare intersect",t,E),!t.label)return A.rect(t,E);let B=t.x??0,I=t.y??0,R=t.height??0,q=[];return d?q=[{x:B-y.width/2,y:I-R/2},{x:B+y.width/2,y:I-R/2},{x:B+y.width/2,y:I-R/2+y.height+b},{x:B+f/2,y:I-R/2+y.height+b},{x:B+f/2,y:I+R/2},{x:B-f/2,y:I+R/2},{x:B-f/2,y:I-R/2+y.height+b},{x:B-y.width/2,y:I-R/2+y.height+b}]:q=[{x:B-f/2,y:I-R/2},{x:B+f/2,y:I-R/2},{x:B+f/2,y:I-R/2+p},{x:B+y.width/2,y:I-R/2+p},{x:B+y.width/2/2,y:I+R/2},{x:B-y.width/2,y:I+R/2},{x:B-y.width/2,y:I-R/2+p},{x:B-f/2,y:I-R/2+p}],A.polygon(t,q,E)},u})}v(Ss,"imageSquare");function Ms(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=Math.max(i.width+(t.padding??0)*2,t?.width??0),a=Math.max(i.height+(t.padding??0)*2,t?.height??0),c=[{x:0,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:-3*a/6,y:-a}],n,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=k.svg(e),f=L(t,{}),p=Z(c),u=g.path(p,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&n.attr("style",l)}else n=mt(e,h,a,c);return s&&n.attr("style",s),t.width=h,t.height=a,H(t,n),t.intersect=function(g){return A.polygon(t,c,g)},e})}v(Ms,"inv_trapezoid");function Xt(o,t,r){return N(this,null,function*(){let{labelStyles:s,nodeStyles:e}=T(t);t.labelStyle=s;let{shapeSvg:i,bbox:h}=yield X(o,t,G(t)),a=Math.max(h.width+r.labelPaddingX*2,t?.width||0),c=Math.max(h.height+r.labelPaddingY*2,t?.height||0),n=-a/2,l=-c/2,g,{rx:f,ry:p}=t,{cssStyles:u}=t;if(r?.rx&&r.ry&&(f=r.rx,p=r.ry),t.look==="handDrawn"){let y=k.svg(i),m=L(t,{}),d=f||p?y.path(dt(n,l,a,c,f||0),m):y.rectangle(n,l,a,c,m);g=i.insert(()=>d,":first-child"),g.attr("class","basic label-container").attr("style",rt(u))}else g=i.insert("rect",":first-child"),g.attr("class","basic label-container").attr("style",e).attr("rx",rt(f)).attr("ry",rt(p)).attr("x",n).attr("y",l).attr("width",a).attr("height",c);return H(t,g),t.intersect=function(y){return A.rect(t,y)},i})}v(Xt,"drawRect");function ks(o,t){return N(this,null,function*(){let{shapeSvg:r,bbox:s,label:e}=yield X(o,t,"label"),i=r.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),r.attr("class","label edgeLabel"),e.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),H(t,i),t.intersect=function(c){return A.rect(t,c)},r})}v(ks,"labelRect");function vs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=Math.max(i.width+(t.padding??0),t?.width??0),a=Math.max(i.height+(t.padding??0),t?.height??0),c=[{x:0,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:-(3*a)/6,y:-a}],n,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=k.svg(e),f=L(t,{}),p=Z(c),u=g.path(p,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&n.attr("style",l)}else n=mt(e,h,a,c);return s&&n.attr("style",s),t.width=h,t.height=a,H(t,n),t.intersect=function(g){return A.polygon(t,c,g)},e})}v(vs,"lean_left");function $s(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=Math.max(i.width+(t.padding??0),t?.width??0),a=Math.max(i.height+(t.padding??0),t?.height??0),c=[{x:-3*a/6,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:0,y:-a}],n,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=k.svg(e),f=L(t,{}),p=Z(c),u=g.path(p,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&n.attr("style",l)}else n=mt(e,h,a,c);return s&&n.attr("style",s),t.width=h,t.height=a,H(t,n),t.intersect=function(g){return A.polygon(t,c,g)},e})}v($s,"lean_right");function Ds(o,t){let{labelStyles:r,nodeStyles:s}=T(t);t.label="",t.labelStyle=r;let e=o.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,h=Math.max(35,t?.width??0),a=Math.max(35,t?.height??0),c=7,n=[{x:h,y:0},{x:0,y:a+c/2},{x:h-2*c,y:a+c/2},{x:0,y:2*a},{x:h,y:a-c/2},{x:2*c,y:a-c/2}],l=k.svg(e),g=L(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=Z(n),p=l.path(f,g),u=e.insert(()=>p,":first-child");return i&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",i),s&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",s),u.attr("transform",`translate(-${h/2},${-a})`),H(t,u),t.intersect=function(y){return Q.info("lightningBolt intersect",t,y),A.polygon(t,n,y)},e}v(Ds,"lightningBolt");var Ba=v((o,t,r,s,e,i,h)=>[`M${o},${t+i}`,`a${e},${i} 0,0,0 ${r},0`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`,`M${o},${t+i+h}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createCylinderPathD"),Ca=v((o,t,r,s,e,i,h)=>[`M${o},${t+i}`,`M${o+r},${t+i}`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`,`M${o},${t+i+h}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createOuterCylinderPathD"),Ra=v((o,t,r,s,e,i)=>[`M${o-r/2},${-s/2}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");function Ps(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+(t.padding??0),t.width??0),c=a/2,n=c/(2.5+a/50),l=Math.max(i.height+n+(t.padding??0),t.height??0),g=l*.1,f,{cssStyles:p}=t;if(t.look==="handDrawn"){let u=k.svg(e),y=Ca(0,0,a,l,c,n,g),m=Ra(0,n,a,l,c,n),d=L(t,{}),x=u.path(y,d),w=u.path(m,d);e.insert(()=>w,":first-child").attr("class","line"),f=e.insert(()=>x,":first-child"),f.attr("class","basic label-container"),p&&f.attr("style",p)}else{let u=Ba(0,0,a,l,c,n,g);f=e.insert("path",":first-child").attr("d",u).attr("class","basic label-container").attr("style",rt(p)).attr("style",s)}return f.attr("label-offset-y",n),f.attr("transform",`translate(${-a/2}, ${-(l/2+n)})`),H(t,f),h.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+n-(i.y-(i.top??0))})`),t.intersect=function(u){let y=A.rect(t,u),m=y.x-(t.x??0);if(c!=0&&(Math.abs(m)<(t.width??0)/2||Math.abs(m)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-n)){let d=n*n*(1-m*m/(c*c));d>0&&(d=Math.sqrt(d)),d=n-d,u.y-(t.y??0)>0&&(d=-d),y.y+=d}return y},e})}v(Ps,"linedCylinder");function Bs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),c=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=c/4,l=c+n,{cssStyles:g}=t,f=k.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:-a/2-a/2*.1,y:-l/2},{x:-a/2-a/2*.1,y:l/2},...yt(-a/2-a/2*.1,l/2,a/2+a/2*.1,l/2,n,.8),{x:a/2+a/2*.1,y:-l/2},{x:-a/2-a/2*.1,y:-l/2},{x:-a/2,y:-l/2},{x:-a/2,y:l/2*1.1},{x:-a/2,y:-l/2}],y=f.polygon(u.map(d=>[d.x,d.y]),p),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",g),s&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",s),m.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)+a/2*.1/2-(i.x-(i.left??0))},${-c/2+(t.padding??0)-n/2-(i.y-(i.top??0))})`),H(t,m),t.intersect=function(d){return A.polygon(t,u,d)},e})}v(Bs,"linedWaveEdgedRect");function Cs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),c=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=5,l=-a/2,g=-c/2,{cssStyles:f}=t,p=k.svg(e),u=L(t,{}),y=[{x:l-n,y:g+n},{x:l-n,y:g+c+n},{x:l+a-n,y:g+c+n},{x:l+a-n,y:g+c},{x:l+a,y:g+c},{x:l+a,y:g+c-n},{x:l+a+n,y:g+c-n},{x:l+a+n,y:g-n},{x:l+n,y:g-n},{x:l+n,y:g},{x:l,y:g},{x:l,y:g+n}],m=[{x:l,y:g+n},{x:l+a-n,y:g+n},{x:l+a-n,y:g+c},{x:l+a,y:g+c},{x:l+a,y:g},{x:l,y:g}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=Z(y),x=p.path(d,u),w=Z(m),b=p.path(w,lt(st({},u),{fill:"none"})),S=e.insert(()=>b,":first-child");return S.insert(()=>x,":first-child"),S.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",s),h.attr("transform",`translate(${-(i.width/2)-n-(i.x-(i.left??0))}, ${-(i.height/2)+n-(i.y-(i.top??0))})`),H(t,S),t.intersect=function(M){return A.polygon(t,y,M)},e})}v(Cs,"multiRect");function Rs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),c=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=c/4,l=c+n,g=-a/2,f=-l/2,p=5,{cssStyles:u}=t,y=yt(g-p,f+l+p,g+a-p,f+l+p,n,.8),m=y?.[y.length-1],d=[{x:g-p,y:f+p},{x:g-p,y:f+l+p},...y,{x:g+a-p,y:m.y-p},{x:g+a,y:m.y-p},{x:g+a,y:m.y-2*p},{x:g+a+p,y:m.y-2*p},{x:g+a+p,y:f-p},{x:g+p,y:f-p},{x:g+p,y:f},{x:g,y:f},{x:g,y:f+p}],x=[{x:g,y:f+p},{x:g+a-p,y:f+p},{x:g+a-p,y:m.y-p},{x:g+a,y:m.y-p},{x:g+a,y:f},{x:g,y:f}],w=k.svg(e),b=L(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");let S=Z(d),M=w.path(S,b),D=Z(x),$=w.path(D,b),P=e.insert(()=>M,":first-child");return P.insert(()=>$),P.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",u),s&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",s),P.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-(i.width/2)-p-(i.x-(i.left??0))}, ${-(i.height/2)+p-n/2-(i.y-(i.top??0))})`),H(t,P),t.intersect=function(C){return A.polygon(t,d,C)},e})}v(Rs,"multiWaveEdgedRectangle");function Ns(s,e,i){return N(this,arguments,function*(o,t,{config:{themeVariables:r}}){let{labelStyles:h,nodeStyles:a}=T(t);t.labelStyle=h,t.useHtmlLabels||wt().flowchart?.htmlLabels!==!1||(t.centerLabel=!0);let{shapeSvg:n,bbox:l,label:g}=yield X(o,t,G(t)),f=Math.max(l.width+(t.padding??0)*2,t?.width??0),p=Math.max(l.height+(t.padding??0)*2,t?.height??0),u=-f/2,y=-p/2,{cssStyles:m}=t,d=k.svg(n),x=L(t,{fill:r.noteBkgColor,stroke:r.noteBorderColor});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");let w=d.rectangle(u,y,f,p,x),b=n.insert(()=>w,":first-child");return b.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",m),a&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",a),g.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-(l.height/2)-(l.y-(l.top??0))})`),H(t,b),t.intersect=function(S){return A.rect(t,S)},n})}v(Ns,"note");var Na=v((o,t,r)=>[`M${o+r/2},${t}`,`L${o+r},${t-r/2}`,`L${o+r/2},${t-r}`,`L${o},${t-r/2}`,"Z"].join(" "),"createDecisionBoxPathD");function As(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=i.width+t.padding,a=i.height+t.padding,c=h+a,n=.5,l=[{x:c/2,y:0},{x:c,y:-c/2},{x:c/2,y:-c},{x:0,y:-c/2}],g,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=k.svg(e),u=L(t,{}),y=Na(0,0,c),m=p.path(y,u);g=e.insert(()=>m,":first-child").attr("transform",`translate(${-c/2+n}, ${c/2})`),f&&g.attr("style",f)}else g=mt(e,c,c,l),g.attr("transform",`translate(${-c/2+n}, ${c/2})`);return s&&g.attr("style",s),H(t,g),t.intersect=function(p){return Q.debug(`APA12 Intersect called SPLIT
point:`,p,`
node:
`,t,`
res:`,A.polygon(t,l,p)),A.polygon(t,l,p)},e})}v(As,"question");function Ls(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+(t.padding??0),t?.width??0),c=Math.max(i.height+(t.padding??0),t?.height??0),n=-a/2,l=-c/2,g=l/2,f=[{x:n+g,y:l},{x:n,y:0},{x:n+g,y:-l},{x:-n,y:-l},{x:-n,y:l}],{cssStyles:p}=t,u=k.svg(e),y=L(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=Z(f),d=u.path(m,y),x=e.insert(()=>d,":first-child");return x.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",p),s&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",s),x.attr("transform",`translate(${-g/2},0)`),h.attr("transform",`translate(${-g/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),H(t,x),t.intersect=function(w){return A.polygon(t,f,w)},e})}v(Ls,"rect_left_inv_arrow");function Ts(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let e;t.cssClasses?e="node "+t.cssClasses:e="node default";let i=o.insert("g").attr("class",e).attr("id",t.domId||t.id),h=i.insert("g"),a=i.insert("g").attr("class","label").attr("style",s),c=t.description,n=t.label,l=a.node().appendChild(yield me(n,t.labelStyle,!0,!0)),g={width:0,height:0};if(tt(U()?.flowchart?.htmlLabels)){let $=l.children[0],P=K(l);g=$.getBoundingClientRect(),P.attr("width",g.width),P.attr("height",g.height)}Q.info("Text 2",c);let f=c||[],p=l.getBBox(),u=a.node().appendChild(yield me(f.join?f.join("<br/>"):f,t.labelStyle,!0,!0)),y=u.children[0],m=K(u);g=y.getBoundingClientRect(),m.attr("width",g.width),m.attr("height",g.height);let d=(t.padding||0)/2;K(u).attr("transform","translate( "+(g.width>p.width?0:(p.width-g.width)/2)+", "+(p.height+d+5)+")"),K(l).attr("transform","translate( "+(g.width<p.width?0:-(p.width-g.width)/2)+", 0)"),g=a.node().getBBox(),a.attr("transform","translate("+-g.width/2+", "+(-g.height/2-d+3)+")");let x=g.width+(t.padding||0),w=g.height+(t.padding||0),b=-g.width/2-d,S=-g.height/2-d,M,D;if(t.look==="handDrawn"){let $=k.svg(i),P=L(t,{}),C=$.path(dt(b,S,x,w,t.rx||0),P),O=$.line(-g.width/2-d,-g.height/2-d+p.height+d,g.width/2+d,-g.height/2-d+p.height+d,P);D=i.insert(()=>(Q.debug("Rough node insert CXC",C),O),":first-child"),M=i.insert(()=>(Q.debug("Rough node insert CXC",C),C),":first-child")}else M=h.insert("rect",":first-child"),D=h.insert("line"),M.attr("class","outer title-state").attr("style",s).attr("x",-g.width/2-d).attr("y",-g.height/2-d).attr("width",g.width+(t.padding||0)).attr("height",g.height+(t.padding||0)),D.attr("class","divider").attr("x1",-g.width/2-d).attr("x2",g.width/2+d).attr("y1",-g.height/2-d+p.height+d).attr("y2",-g.height/2-d+p.height+d);return H(t,M),t.intersect=function($){return A.rect(t,$)},i})}v(Ts,"rectWithTitle");function Lt(o,t,r,s,e,i,h){let c=(o+r)/2,n=(t+s)/2,l=Math.atan2(s-t,r-o),g=(r-o)/2,f=(s-t)/2,p=g/e,u=f/i,y=Math.sqrt(p**2+u**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");let m=Math.sqrt(1-y**2),d=c+m*i*Math.sin(l)*(h?-1:1),x=n-m*e*Math.cos(l)*(h?-1:1),w=Math.atan2((t-x)/i,(o-d)/e),S=Math.atan2((s-x)/i,(r-d)/e)-w;h&&S<0&&(S+=2*Math.PI),!h&&S>0&&(S-=2*Math.PI);let M=[];for(let D=0;D<20;D++){let $=D/19,P=w+$*S,C=d+e*Math.cos(P),O=x+i*Math.sin(P);M.push({x:C,y:O})}return M}v(Lt,"generateArcPoints");function Ws(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=t?.padding??0,a=t?.padding??0,c=(t?.width?t?.width:i.width)+h*2,n=(t?.height?t?.height:i.height)+a*2,l=5,g=5,{cssStyles:f}=t,p=k.svg(e),u=L(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:-c/2+g,y:-n/2},{x:c/2-g,y:-n/2},...Lt(c/2-g,-n/2,c/2,-n/2+g,l,l,!0),{x:c/2,y:-n/2+g},{x:c/2,y:n/2-g},...Lt(c/2,n/2-g,c/2-g,n/2,l,l,!0),{x:c/2-g,y:n/2},{x:-c/2+g,y:n/2},...Lt(-c/2+g,n/2,-c/2,n/2-g,l,l,!0),{x:-c/2,y:n/2-g},{x:-c/2,y:-n/2+g},...Lt(-c/2,-n/2+g,-c/2+g,-n/2,l,l,!0)],m=Z(y),d=p.path(m,u),x=e.insert(()=>d,":first-child");return x.attr("class","basic label-container outer-path"),f&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",f),s&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",s),H(t,x),t.intersect=function(w){return A.polygon(t,y,w)},e})}v(Ws,"roundedRect");function Hs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=t?.padding??0,c=Math.max(i.width+(t.padding??0)*2,t?.width??0),n=Math.max(i.height+(t.padding??0)*2,t?.height??0),l=-i.width/2-a,g=-i.height/2-a,{cssStyles:f}=t,p=k.svg(e),u=L(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:l,y:g},{x:l+c+8,y:g},{x:l+c+8,y:g+n},{x:l-8,y:g+n},{x:l-8,y:g},{x:l,y:g},{x:l,y:g+n}],m=p.polygon(y.map(x=>[x.x,x.y]),u),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container").attr("style",rt(f)),s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),h.attr("transform",`translate(${-c/2+4+(t.padding??0)-(i.x-(i.left??0))},${-n/2+(t.padding??0)-(i.y-(i.top??0))})`),H(t,d),t.intersect=function(x){return A.rect(t,x)},e})}v(Hs,"shadedProcess");function Is(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),c=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=-a/2,l=-c/2,{cssStyles:g}=t,f=k.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:n,y:l},{x:n,y:l+c},{x:n+a,y:l+c},{x:n+a,y:l-c/2}],y=Z(u),m=f.path(y,p),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",g),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),d.attr("transform",`translate(0, ${c/4})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(i.x-(i.left??0))}, ${-c/4+(t.padding??0)-(i.y-(i.top??0))})`),H(t,d),t.intersect=function(x){return A.polygon(t,u,x)},e})}v(Is,"slopedRect");function Es(o,t){return N(this,null,function*(){let r={rx:0,ry:0,classes:"",labelPaddingX:(t?.padding||0)*2,labelPaddingY:(t?.padding||0)*1};return Xt(o,t,r)})}v(Es,"squareRect");function Os(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=i.height+t.padding,a=i.width+h/4+t.padding,c=h/2,{cssStyles:n}=t,l=k.svg(e),g=L(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=[{x:-a/2+c,y:-h/2},{x:a/2-c,y:-h/2},...Wt(-a/2+c,0,c,50,90,270),{x:a/2-c,y:h/2},...Wt(a/2-c,0,c,50,270,450)],p=Z(f),u=l.path(p,g),y=e.insert(()=>u,":first-child");return y.attr("class","basic label-container outer-path"),n&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",n),s&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",s),H(t,y),t.intersect=function(m){return A.polygon(t,f,m)},e})}v(Os,"stadium");function _s(o,t){return N(this,null,function*(){return Xt(o,t,{rx:5,ry:5,classes:"flowchart-node"})})}v(_s,"state");function zs(o,t,{config:{themeVariables:r}}){let{labelStyles:s,nodeStyles:e}=T(t);t.labelStyle=s;let{cssStyles:i}=t,{lineColor:h,stateBorder:a,nodeBorder:c}=r,n=o.insert("g").attr("class","node default").attr("id",t.domId||t.id),l=k.svg(n),g=L(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=l.circle(0,0,14,lt(st({},g),{stroke:h,strokeWidth:2})),p=a??c,u=l.circle(0,0,5,lt(st({},g),{fill:p,stroke:p,strokeWidth:2,fillStyle:"solid"})),y=n.insert(()=>f,":first-child");return y.insert(()=>u),i&&y.selectAll("path").attr("style",i),e&&y.selectAll("path").attr("style",e),H(t,y),t.intersect=function(m){return A.circle(t,7,m)},n}v(zs,"stateEnd");function js(o,t,{config:{themeVariables:r}}){let{lineColor:s}=r,e=o.insert("g").attr("class","node default").attr("id",t.domId||t.id),i;if(t.look==="handDrawn"){let a=k.svg(e).circle(0,0,14,$e(s));i=e.insert(()=>a),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=e.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return H(t,i),t.intersect=function(h){return A.circle(t,7,h)},e}v(js,"stateStart");function Gs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=(t?.padding||0)/2,a=i.width+t.padding,c=i.height+t.padding,n=-i.width/2-h,l=-i.height/2-h,g=[{x:0,y:0},{x:a,y:0},{x:a,y:-c},{x:0,y:-c},{x:0,y:0},{x:-8,y:0},{x:a+8,y:0},{x:a+8,y:-c},{x:-8,y:-c},{x:-8,y:0}];if(t.look==="handDrawn"){let f=k.svg(e),p=L(t,{}),u=f.rectangle(n-8,l,a+16,c,p),y=f.line(n,l,n,l+c,p),m=f.line(n+a,l,n+a,l+c,p);e.insert(()=>y,":first-child"),e.insert(()=>m,":first-child");let d=e.insert(()=>u,":first-child"),{cssStyles:x}=t;d.attr("class","basic label-container").attr("style",rt(x)),H(t,d)}else{let f=mt(e,a,c,g);s&&f.attr("style",s),H(t,f)}return t.intersect=function(f){return A.polygon(t,g,f)},e})}v(Gs,"subroutine");function Fs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=Math.max(i.width+(t.padding??0)*2,t?.width??0),a=Math.max(i.height+(t.padding??0)*2,t?.height??0),c=-h/2,n=-a/2,l=.2*a,g=.2*a,{cssStyles:f}=t,p=k.svg(e),u=L(t,{}),y=[{x:c-l/2,y:n},{x:c+h+l/2,y:n},{x:c+h+l/2,y:n+a},{x:c-l/2,y:n+a}],m=[{x:c+h-l/2,y:n+a},{x:c+h+l/2,y:n+a},{x:c+h+l/2,y:n+a-g}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=Z(y),x=p.path(d,u),w=Z(m),b=p.path(w,lt(st({},u),{fillStyle:"solid"})),S=e.insert(()=>b,":first-child");return S.insert(()=>x,":first-child"),S.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",s),H(t,S),t.intersect=function(M){return A.polygon(t,y,M)},e})}v(Fs,"taggedRect");function qs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),c=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=c/4,l=.2*a,g=.2*c,f=c+n,{cssStyles:p}=t,u=k.svg(e),y=L(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=[{x:-a/2-a/2*.1,y:f/2},...yt(-a/2-a/2*.1,f/2,a/2+a/2*.1,f/2,n,.8),{x:a/2+a/2*.1,y:-f/2},{x:-a/2-a/2*.1,y:-f/2}],d=-a/2+a/2*.1,x=-f/2-g*.4,w=[{x:d+a-l,y:(x+c)*1.4},{x:d+a,y:x+c-g},{x:d+a,y:(x+c)*.9},...yt(d+a,(x+c)*1.3,d+a-l,(x+c)*1.5,-c*.03,.5)],b=Z(m),S=u.path(b,y),M=Z(w),D=u.path(M,lt(st({},y),{fillStyle:"solid"})),$=e.insert(()=>D,":first-child");return $.insert(()=>S,":first-child"),$.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",p),s&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",s),$.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(i.x-(i.left??0))},${-c/2+(t.padding??0)-n/2-(i.y-(i.top??0))})`),H(t,$),t.intersect=function(P){return A.polygon(t,m,P)},e})}v(qs,"taggedWaveEdgedRectangle");function Xs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=Math.max(i.width+t.padding,t?.width||0),a=Math.max(i.height+t.padding,t?.height||0),c=-h/2,n=-a/2,l=e.insert("rect",":first-child");return l.attr("class","text").attr("style",s).attr("rx",0).attr("ry",0).attr("x",c).attr("y",n).attr("width",h).attr("height",a),H(t,l),t.intersect=function(g){return A.rect(t,g)},e})}v(Xs,"text");var Aa=v((o,t,r,s,e,i)=>`M${o},${t}
    a${e},${i} 0,0,1 0,${-s}
    l${r},0
    a${e},${i} 0,0,1 0,${s}
    M${r},${-s}
    a${e},${i} 0,0,0 0,${s}
    l${-r},0`,"createCylinderPathD"),La=v((o,t,r,s,e,i)=>[`M${o},${t}`,`M${o+r},${t}`,`a${e},${i} 0,0,0 0,${-s}`,`l${-r},0`,`a${e},${i} 0,0,0 0,${s}`,`l${r},0`].join(" "),"createOuterCylinderPathD"),Ta=v((o,t,r,s,e,i)=>[`M${o+r/2},${-s/2}`,`a${e},${i} 0,0,0 0,${s}`].join(" "),"createInnerCylinderPathD");function Ys(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h,halfPadding:a}=yield X(o,t,G(t)),c=t.look==="neo"?a*2:a,n=i.height+c,l=n/2,g=l/(2.5+n/50),f=i.width+g+c,{cssStyles:p}=t,u;if(t.look==="handDrawn"){let y=k.svg(e),m=La(0,0,f,n,g,l),d=Ta(0,0,f,n,g,l),x=y.path(m,L(t,{})),w=y.path(d,L(t,{fill:"none"}));u=e.insert(()=>w,":first-child"),u=e.insert(()=>x,":first-child"),u.attr("class","basic label-container"),p&&u.attr("style",p)}else{let y=Aa(0,0,f,n,g,l);u=e.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",rt(p)).attr("style",s),u.attr("class","basic label-container"),p&&u.selectAll("path").attr("style",p),s&&u.selectAll("path").attr("style",s)}return u.attr("label-offset-x",g),u.attr("transform",`translate(${-f/2}, ${n/2} )`),h.attr("transform",`translate(${-(i.width/2)-g-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),H(t,u),t.intersect=function(y){let m=A.rect(t,y),d=m.y-(t.y??0);if(l!=0&&(Math.abs(d)<(t.height??0)/2||Math.abs(d)==(t.height??0)/2&&Math.abs(m.x-(t.x??0))>(t.width??0)/2-g)){let x=g*g*(1-d*d/(l*l));x!=0&&(x=Math.sqrt(Math.abs(x))),x=g-x,y.x-(t.x??0)>0&&(x=-x),m.x+=x}return m},e})}v(Ys,"tiltedCylinder");function Vs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=i.width+t.padding,a=i.height+t.padding,c=[{x:-3*a/6,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:0,y:-a}],n,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=k.svg(e),f=L(t,{}),p=Z(c),u=g.path(p,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&n.attr("style",l)}else n=mt(e,h,a,c);return s&&n.attr("style",s),t.width=h,t.height=a,H(t,n),t.intersect=function(g){return A.polygon(t,c,g)},e})}v(Vs,"trapezoid");function Zs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=60,a=20,c=Math.max(h,i.width+(t.padding??0)*2,t?.width??0),n=Math.max(a,i.height+(t.padding??0)*2,t?.height??0),{cssStyles:l}=t,g=k.svg(e),f=L(t,{});t.look!=="handDrawn"&&(f.roughness=0,f.fillStyle="solid");let p=[{x:-c/2*.8,y:-n/2},{x:c/2*.8,y:-n/2},{x:c/2,y:-n/2*.6},{x:c/2,y:n/2},{x:-c/2,y:n/2},{x:-c/2,y:-n/2*.6}],u=Z(p),y=g.path(u,f),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),l&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",l),s&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",s),H(t,m),t.intersect=function(d){return A.polygon(t,p,d)},e})}v(Zs,"trapezoidalPentagon");function Qs(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=tt(U().flowchart?.htmlLabels),c=i.width+(t.padding??0),n=c+i.height,l=c+i.height,g=[{x:0,y:0},{x:l,y:0},{x:l/2,y:-n}],{cssStyles:f}=t,p=k.svg(e),u=L(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=Z(g),m=p.path(y,u),d=e.insert(()=>m,":first-child").attr("transform",`translate(${-n/2}, ${n/2})`);return f&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",f),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),t.width=c,t.height=n,H(t,d),h.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${n/2-(i.height+(t.padding??0)/(a?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(x){return Q.info("Triangle intersect",t,g,x),A.polygon(t,g,x)},e})}v(Qs,"triangle");function Js(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),c=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=c/8,l=c+n,{cssStyles:g}=t,p=70-a,u=p>0?p/2:0,y=k.svg(e),m=L(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let d=[{x:-a/2-u,y:l/2},...yt(-a/2-u,l/2,a/2+u,l/2,n,.8),{x:a/2+u,y:-l/2},{x:-a/2-u,y:-l/2}],x=Z(d),w=y.path(x,m),b=e.insert(()=>w,":first-child");return b.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",g),s&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",s),b.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(i.x-(i.left??0))},${-c/2+(t.padding??0)-n-(i.y-(i.top??0))})`),H(t,b),t.intersect=function(S){return A.polygon(t,d,S)},e})}v(Js,"waveEdgedRectangle");function Ks(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(o,t,G(t)),h=100,a=50,c=Math.max(i.width+(t.padding??0)*2,t?.width??0),n=Math.max(i.height+(t.padding??0)*2,t?.height??0),l=c/n,g=c,f=n;g>f*l?f=g/l:g=f*l,g=Math.max(g,h),f=Math.max(f,a);let p=Math.min(f*.2,f/4),u=f+p*2,{cssStyles:y}=t,m=k.svg(e),d=L(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let x=[{x:-g/2,y:u/2},...yt(-g/2,u/2,g/2,u/2,p,1),{x:g/2,y:-u/2},...yt(g/2,-u/2,-g/2,-u/2,p,-1)],w=Z(x),b=m.path(w,d),S=e.insert(()=>b,":first-child");return S.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",y),s&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",s),H(t,S),t.intersect=function(M){return A.polygon(t,x,M)},e})}v(Ks,"waveRectangle");function Us(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(o,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),c=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=5,l=-a/2,g=-c/2,{cssStyles:f}=t,p=k.svg(e),u=L(t,{}),y=[{x:l-n,y:g-n},{x:l-n,y:g+c},{x:l+a,y:g+c},{x:l+a,y:g-n}],m=`M${l-n},${g-n} L${l+a},${g-n} L${l+a},${g+c} L${l-n},${g+c} L${l-n},${g-n}
                M${l-n},${g} L${l+a},${g}
                M${l},${g-n} L${l},${g+c}`;t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=p.path(m,u),x=e.insert(()=>d,":first-child");return x.attr("transform",`translate(${n/2}, ${n/2})`),x.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",s),h.attr("transform",`translate(${-(i.width/2)+n/2-(i.x-(i.left??0))}, ${-(i.height/2)+n/2-(i.y-(i.top??0))})`),H(t,x),t.intersect=function(w){return A.polygon(t,y,w)},e})}v(Us,"windowPane");function we(o,t){return N(this,null,function*(){let r=t;if(r.alias&&(t.label=r.alias),t.look==="handDrawn"){let{themeVariables:Y}=wt(),{background:J}=Y,at=lt(st({},t),{id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${J}`]});yield we(o,at)}let s=wt();t.useHtmlLabels=s.htmlLabels;let e=s.er?.diagramPadding??10,i=s.er?.entityPadding??6,{cssStyles:h}=t,{labelStyles:a,nodeStyles:c}=T(t);if(r.attributes.length===0&&t.label){let Y={rx:0,ry:0,labelPaddingX:e,labelPaddingY:e*1.5,classes:""};Pt(t.label,s)+Y.labelPaddingX*2<s.er.minEntityWidth&&(t.width=s.er.minEntityWidth);let J=yield Xt(o,t,Y);if(!tt(s.htmlLabels)){let at=J.select("text"),nt=at.node()?.getBBox();at.attr("transform",`translate(${-nt.width/2}, 0)`)}return J}s.htmlLabels||(e*=1.25,i*=1.25);let n=G(t);n||(n="node default");let l=o.insert("g").attr("class",n).attr("id",t.domId||t.id),g=yield vt(l,t.label??"",s,0,0,["name"],a);g.height+=i;let f=0,p=[],u=[],y=0,m=0,d=0,x=0,w=!0,b=!0;for(let Y of r.attributes){let J=yield vt(l,Y.type,s,0,f,["attribute-type"],a);y=Math.max(y,J.width+e);let at=yield vt(l,Y.name,s,0,f,["attribute-name"],a);m=Math.max(m,at.width+e);let nt=yield vt(l,Y.keys.join(),s,0,f,["attribute-keys"],a);d=Math.max(d,nt.width+e);let xt=yield vt(l,Y.comment,s,0,f,["attribute-comment"],a);x=Math.max(x,xt.width+e);let pt=Math.max(J.height,at.height,nt.height,xt.height)+i;u.push({yOffset:f,rowHeight:pt}),f+=pt}let S=4;d<=e&&(w=!1,d=0,S--),x<=e&&(b=!1,x=0,S--);let M=l.node().getBBox();if(g.width+e*2-(y+m+d+x)>0){let Y=g.width+e*2-(y+m+d+x);y+=Y/S,m+=Y/S,d>0&&(d+=Y/S),x>0&&(x+=Y/S)}let D=y+m+d+x,$=k.svg(l),P=L(t,{});t.look!=="handDrawn"&&(P.roughness=0,P.fillStyle="solid");let C=0;u.length>0&&(C=u.reduce((Y,J)=>Y+(J?.rowHeight??0),0));let O=Math.max(M.width+e*2,t?.width||0,D),V=Math.max((C??0)+g.height,t?.height||0),E=-O/2,B=-V/2;l.selectAll("g:not(:first-child)").each((Y,J,at)=>{let nt=K(at[J]),xt=nt.attr("transform"),pt=0,Se=0;if(xt){let Vt=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(xt);Vt&&(pt=parseFloat(Vt[1]),Se=parseFloat(Vt[2]),nt.attr("class").includes("attribute-name")?pt+=y:nt.attr("class").includes("attribute-keys")?pt+=y+m:nt.attr("class").includes("attribute-comment")&&(pt+=y+m+d))}nt.attr("transform",`translate(${E+e/2+pt}, ${Se+B+g.height+i/2})`)}),l.select(".name").attr("transform","translate("+-g.width/2+", "+(B+i/2)+")");let I=$.rectangle(E,B,O,V,P),R=l.insert(()=>I,":first-child").attr("style",h.join("")),{themeVariables:q}=wt(),{rowEven:z,rowOdd:W,nodeBorder:F}=q;p.push(0);for(let[Y,J]of u.entries()){let nt=(Y+1)%2===0&&J.yOffset!==0,xt=$.rectangle(E,g.height+B+J?.yOffset,O,J?.rowHeight,lt(st({},P),{fill:nt?z:W,stroke:F}));l.insert(()=>xt,"g.label").attr("style",h.join("")).attr("class",`row-rect-${nt?"even":"odd"}`)}let _=$.line(E,g.height+B,O+E,g.height+B,P);l.insert(()=>_).attr("class","divider"),_=$.line(y+E,g.height+B,y+E,V+B,P),l.insert(()=>_).attr("class","divider"),w&&(_=$.line(y+m+E,g.height+B,y+m+E,V+B,P),l.insert(()=>_).attr("class","divider")),b&&(_=$.line(y+m+d+E,g.height+B,y+m+d+E,V+B,P),l.insert(()=>_).attr("class","divider"));for(let Y of p)_=$.line(E,g.height+B+Y,O+E,g.height+B+Y,P),l.insert(()=>_).attr("class","divider");if(H(t,R),c&&t.look!=="handDrawn"){let J=c.split(";")?.filter(at=>at.includes("stroke"))?.map(at=>`${at}`).join("; ");l.selectAll("path").attr("style",J??""),l.selectAll(".row-rect-even path").attr("style",c)}return t.intersect=function(Y){return A.rect(t,Y)},l})}v(we,"erBox");function vt(a,c,n){return N(this,arguments,function*(o,t,r,s=0,e=0,i=[],h=""){let l=o.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${s}, ${e})`).attr("style",h);t!==Zt(t)&&(t=Zt(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));let g=l.node().appendChild(yield ft(l,t,{width:Pt(t,r)+100,style:h,useHtmlLabels:r.htmlLabels},r));if(t.includes("&lt;")||t.includes("&gt;")){let p=g.children[0];for(p.textContent=p.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");p.childNodes[0];)p=p.childNodes[0],p.textContent=p.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let f=g.getBBox();if(tt(r.htmlLabels)){let p=g.children[0];p.style.textAlign="start";let u=K(g);f=p.getBoundingClientRect(),u.attr("width",f.width),u.attr("height",f.height)}return f})}v(vt,"addText");function ta(i,h,a,c){return N(this,arguments,function*(o,t,r,s,e=r.class.padding??12){let n=s?0:3,l=o.insert("g").attr("class",G(t)).attr("id",t.domId||t.id),g=null,f=null,p=null,u=null,y=0,m=0,d=0;if(g=l.insert("g").attr("class","annotation-group text"),t.annotations.length>0){let M=t.annotations[0];yield Tt(g,{text:`\xAB${M}\xBB`},0),y=g.node().getBBox().height}f=l.insert("g").attr("class","label-group text"),yield Tt(f,t,0,["font-weight: bolder"]);let x=f.node().getBBox();m=x.height,p=l.insert("g").attr("class","members-group text");let w=0;for(let M of t.members){let D=yield Tt(p,M,w,[M.parseClassifier()]);w+=D+n}d=p.node().getBBox().height,d<=0&&(d=e/2),u=l.insert("g").attr("class","methods-group text");let b=0;for(let M of t.methods){let D=yield Tt(u,M,b,[M.parseClassifier()]);b+=D+n}let S=l.node().getBBox();if(g!==null){let M=g.node().getBBox();g.attr("transform",`translate(${-M.width/2})`)}return f.attr("transform",`translate(${-x.width/2}, ${y})`),S=l.node().getBBox(),p.attr("transform",`translate(0, ${y+m+e*2})`),S=l.node().getBBox(),u.attr("transform",`translate(0, ${y+m+(d?d+e*4:e*2)})`),S=l.node().getBBox(),{shapeSvg:l,bbox:S}})}v(ta,"textHelper");function Tt(e,i,h){return N(this,arguments,function*(o,t,r,s=[]){let a=o.insert("g").attr("class","label").attr("style",s.join("; ")),c=wt(),n="useHtmlLabels"in t?t.useHtmlLabels:tt(c.htmlLabels)??!0,l="";"text"in t?l=t.text:l=t.label,!n&&l.startsWith("\\")&&(l=l.substring(1)),Qt(l)&&(n=!0);let g=yield ft(a,Jt(St(l)),{width:Pt(l,c)+50,classes:"markdown-node-label",useHtmlLabels:n},c),f,p=1;if(n){let u=g.children[0],y=K(g);p=u.innerHTML.split("<br>").length,u.innerHTML.includes("</math>")&&(p+=u.innerHTML.split("<mrow>").length-1);let m=u.getElementsByTagName("img");if(m){let d=l.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...m].map(x=>new Promise(w=>{function b(){if(x.style.display="flex",x.style.flexDirection="column",d){let S=c.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,D=parseInt(S,10)*5+"px";x.style.minWidth=D,x.style.maxWidth=D}else x.style.width="100%";w(x)}v(b,"setupImage"),setTimeout(()=>{x.complete&&b()}),x.addEventListener("error",b),x.addEventListener("load",b)})))}f=u.getBoundingClientRect(),y.attr("width",f.width),y.attr("height",f.height)}else{s.includes("font-weight: bolder")&&K(g).selectAll("tspan").attr("font-weight",""),p=g.children.length;let u=g.children[0];(g.textContent===""||g.textContent.includes("&gt"))&&(u.textContent=l[0]+l.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),l[1]===" "&&(u.textContent=u.textContent[0]+" "+u.textContent.substring(1))),u.textContent==="undefined"&&(u.textContent=""),f=g.getBBox()}return a.attr("transform","translate(0,"+(-f.height/(2*p)+r)+")"),f.height})}v(Tt,"addText");function ea(o,t){return N(this,null,function*(){let r=U(),s=r.class.padding??12,e=s,i=t.useHtmlLabels??tt(r.htmlLabels)??!0,h=t;h.annotations=h.annotations??[],h.members=h.members??[],h.methods=h.methods??[];let{shapeSvg:a,bbox:c}=yield ta(o,t,r,i,e),{labelStyles:n,nodeStyles:l}=T(t);t.labelStyle=n,t.cssStyles=h.styles||"";let g=h.styles?.join(";")||l||"";t.cssStyles||(t.cssStyles=g.replaceAll("!important","").split(";"));let f=h.members.length===0&&h.methods.length===0&&!r.class?.hideEmptyMembersBox,p=k.svg(a),u=L(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=c.width,m=c.height;h.members.length===0&&h.methods.length===0?m+=e:h.members.length>0&&h.methods.length===0&&(m+=e*2);let d=-y/2,x=-m/2,w=p.rectangle(d-s,x-s-(f?s:h.members.length===0&&h.methods.length===0?-s/2:0),y+2*s,m+2*s+(f?s*2:h.members.length===0&&h.methods.length===0?-s:0),u),b=a.insert(()=>w,":first-child");b.attr("class","basic label-container");let S=b.node().getBBox();a.selectAll(".text").each((P,C,O)=>{let V=K(O[C]),E=V.attr("transform"),B=0;if(E){let z=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(E);z&&(B=parseFloat(z[2]))}let I=B+x+s-(f?s:h.members.length===0&&h.methods.length===0?-s/2:0);i||(I-=4);let R=d;(V.attr("class").includes("label-group")||V.attr("class").includes("annotation-group"))&&(R=-V.node()?.getBBox().width/2||0,a.selectAll("text").each(function(q,z,W){window.getComputedStyle(W[z]).textAnchor==="middle"&&(R=0)})),V.attr("transform",`translate(${R}, ${I})`)});let M=a.select(".annotation-group").node().getBBox().height-(f?s/2:0)||0,D=a.select(".label-group").node().getBBox().height-(f?s/2:0)||0,$=a.select(".members-group").node().getBBox().height-(f?s/2:0)||0;if(h.members.length>0||h.methods.length>0||f){let P=p.line(S.x,M+D+x+s,S.x+S.width,M+D+x+s,u);a.insert(()=>P).attr("class","divider").attr("style",g)}if(f||h.members.length>0||h.methods.length>0){let P=p.line(S.x,M+D+$+x+e*2+s,S.x+S.width,M+D+$+x+s+e*2,u);a.insert(()=>P).attr("class","divider").attr("style",g)}if(h.look!=="handDrawn"&&a.selectAll("path").attr("style",g),b.select(":nth-child(2)").attr("style",g),a.selectAll(".divider").select("path").attr("style",g),t.labelStyle?a.selectAll("span").attr("style",t.labelStyle):a.selectAll("span").attr("style",g),!i){let P=RegExp(/color\s*:\s*([^;]*)/),C=P.exec(g);if(C){let O=C[0].replace("color","fill");a.selectAll("tspan").attr("style",O)}else if(n){let O=P.exec(n);if(O){let V=O[0].replace("color","fill");a.selectAll("tspan").attr("style",V)}}}return H(t,b),t.intersect=function(P){return A.rect(t,P)},a})}v(ea,"classBox");function sa(o,t){return N(this,null,function*(){let{labelStyles:r,nodeStyles:s}=T(t);t.labelStyle=r;let e=t,i=t,h=20,a=20,c="verifyMethod"in t,n=G(t),l=o.insert("g").attr("class",n).attr("id",t.domId??t.id),g;c?g=yield ot(l,`&lt;&lt;${e.type}&gt;&gt;`,0,t.labelStyle):g=yield ot(l,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let f=g,p=yield ot(l,e.name,f,t.labelStyle+"; font-weight: bold;");if(f+=p+a,c){let M=yield ot(l,`${e.requirementId?`ID: ${e.requirementId}`:""}`,f,t.labelStyle);f+=M;let D=yield ot(l,`${e.text?`Text: ${e.text}`:""}`,f,t.labelStyle);f+=D;let $=yield ot(l,`${e.risk?`Risk: ${e.risk}`:""}`,f,t.labelStyle);f+=$,yield ot(l,`${e.verifyMethod?`Verification: ${e.verifyMethod}`:""}`,f,t.labelStyle)}else{let M=yield ot(l,`${i.type?`Type: ${i.type}`:""}`,f,t.labelStyle);f+=M,yield ot(l,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,f,t.labelStyle)}let u=(l.node()?.getBBox().width??200)+h,y=(l.node()?.getBBox().height??200)+h,m=-u/2,d=-y/2,x=k.svg(l),w=L(t,{});t.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");let b=x.rectangle(m,d,u,y,w),S=l.insert(()=>b,":first-child");if(S.attr("class","basic label-container").attr("style",s),l.selectAll(".label").each((M,D,$)=>{let P=K($[D]),C=P.attr("transform"),O=0,V=0;if(C){let R=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(C);R&&(O=parseFloat(R[1]),V=parseFloat(R[2]))}let E=V-y/2,B=m+h/2;(D===0||D===1)&&(B=O),P.attr("transform",`translate(${B}, ${E+h})`)}),f>g+p+a){let M=x.line(m,d+g+p+a,m+u,d+g+p+a,w);l.insert(()=>M).attr("style",s)}return H(t,S),t.intersect=function(M){return A.rect(t,M)},l})}v(sa,"requirementBox");function ot(o,t,r,s=""){return N(this,null,function*(){if(t==="")return 0;let e=o.insert("g").attr("class","label").attr("style",s),i=U(),h=i.htmlLabels??!0,a=yield ft(e,Jt(St(t)),{width:Pt(t,i)+50,classes:"markdown-node-label",useHtmlLabels:h,style:s},i),c;if(h){let n=a.children[0],l=K(a);c=n.getBoundingClientRect(),l.attr("width",c.width),l.attr("height",c.height)}else{let n=a.children[0];for(let l of n.children)l.textContent=l.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),s&&l.setAttribute("style",s);c=a.getBBox(),c.height+=6}return e.attr("transform",`translate(${-c.width/2},${-c.height/2+r})`),c.height})}v(ot,"addText");var Wa=v(o=>{switch(o){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");function aa(s,e,i){return N(this,arguments,function*(o,t,{config:r}){let{labelStyles:h,nodeStyles:a}=T(t);t.labelStyle=h||"";let c=10,n=t.width;t.width=(t.width??200)-10;let{shapeSvg:l,bbox:g,label:f}=yield X(o,t,G(t)),p=t.padding||10,u="",y;"ticket"in t&&t.ticket&&r?.kanban?.ticketBaseUrl&&(u=r?.kanban?.ticketBaseUrl.replace("#TICKET#",t.ticket),y=l.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",u).attr("target","_blank"));let m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1},d,x;y?{label:d,bbox:x}=yield de(y,"ticket"in t&&t.ticket||"",m):{label:d,bbox:x}=yield de(l,"ticket"in t&&t.ticket||"",m);let{label:w,bbox:b}=yield de(l,"assigned"in t&&t.assigned||"",m);t.width=n;let S=10,M=t?.width||0,D=Math.max(x.height,b.height)/2,$=Math.max(g.height+S*2,t?.height||0)+D,P=-M/2,C=-$/2;f.attr("transform","translate("+(p-M/2)+", "+(-D-g.height/2)+")"),d.attr("transform","translate("+(p-M/2)+", "+(-D+g.height/2)+")"),w.attr("transform","translate("+(p+M/2-b.width-2*c)+", "+(-D+g.height/2)+")");let O,{rx:V,ry:E}=t,{cssStyles:B}=t;if(t.look==="handDrawn"){let I=k.svg(l),R=L(t,{}),q=V||E?I.path(dt(P,C,M,$,V||0),R):I.rectangle(P,C,M,$,R);O=l.insert(()=>q,":first-child"),O.attr("class","basic label-container").attr("style",B||null)}else{O=l.insert("rect",":first-child"),O.attr("class","basic label-container __APA__").attr("style",a).attr("rx",V??5).attr("ry",E??5).attr("x",P).attr("y",C).attr("width",M).attr("height",$);let I="priority"in t&&t.priority;if(I){let R=l.append("line"),q=P+2,z=C+Math.floor((V??0)/2),W=C+$-Math.floor((V??0)/2);R.attr("x1",q).attr("y1",z).attr("x2",q).attr("y2",W).attr("stroke-width","4").attr("stroke",Wa(I))}}return H(t,O),t.height=$,t.intersect=function(I){return A.rect(t,I)},l})}v(aa,"kanbanItem");var Ha=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:Es},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Ws},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Os},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Gs},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:cs},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:es},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:As},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:ys},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:$s},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:vs},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Vs},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:Ms},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:hs},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:Xs},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:Ue},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Hs},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:js},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:zs},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:fs},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:ds},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:rs},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:is},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:ns},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Ds},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:Js},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:us},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:Ys},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:Ps},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:ls},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:os},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:Qs},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:Us},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:gs},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:Zs},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:ps},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Is},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Rs},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Cs},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:Ke},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:as},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:qs},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Fs},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:Ks},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Ls},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Bs}],Ia=v(()=>{let t=[...Object.entries({state:_s,choice:ts,note:Ns,rectWithTitle:Ts,labelRect:ks,iconSquare:ws,iconCircle:xs,icon:ms,iconRounded:bs,imageSquare:Ss,anchor:Je,kanbanItem:aa,classBox:ea,erBox:we,requirementBox:sa}),...Ha.flatMap(r=>[r.shortName,..."aliases"in r?r.aliases:[],..."internalAliases"in r?r.internalAliases:[]].map(e=>[e,r.handler]))];return Object.fromEntries(t)},"generateShapeMap"),ra=Ia();function Ea(o){return o in ra}v(Ea,"isValidShape");var Yt=new Map;function Oa(o,t,r){return N(this,null,function*(){let s,e;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");let i=t.shape?ra[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let h;r.config.securityLevel==="sandbox"?h="_top":t.linkTarget&&(h=t.linkTarget||"_blank"),s=o.insert("svg:a").attr("xlink:href",t.link).attr("target",h??null),e=yield i(s,t,r)}else e=yield i(o,t,r),s=e;return t.tooltip&&e.attr("title",t.tooltip),Yt.set(t.id,s),t.haveCallback&&s.attr("class",s.attr("class")+" clickable"),s})}v(Oa,"insertNode");var li=v((o,t)=>{Yt.set(t.id,o)},"setNodeElem"),ci=v(()=>{Yt.clear()},"clear"),oi=v(o=>{let t=Yt.get(o.id);Q.trace("Transforming node",o.diff,o,"translate("+(o.x-o.width/2-5)+", "+o.width/2+")");let r=8,s=o.diff||0;return o.clusterNode?t.attr("transform","translate("+(o.x+s-o.width/2)+", "+(o.y-o.height/2-r)+")"):t.attr("transform","translate("+o.x+", "+o.y+")"),s},"positionNode");export{k as a,X as b,H as c,me as d,Ja as e,Ka as f,Ea as g,Oa as h,li as i,ci as j,oi as k};
